{"episode_reward_max": -568.2766157646248, "episode_reward_min": -735.684274168699, "episode_reward_mean": -628.5140744096444, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 53.911285096905466, "mean_processing_ms": 6.220496920338076, "mean_inference_ms": 1.2741664853424919}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5888, "num_steps_sampled": 6000, "sample_time_ms": 185854.907, "load_time_ms": 153.679, "grad_time_ms": 2399.194, "update_time_ms": 976.874, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 10182.7021484375, "policy_loss": -0.007052233908325434, "vf_loss": 10182.7109375, "vf_explained_var": 0.0001583099365234375, "kl": 0.0054011158645153046, "entropy": 12.81817626953125, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 6000, "episodes_total": 30, "training_iteration": 1, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_20-30-11", "timestamp": 1606230011, "time_this_iter_s": 189.48921513557434, "time_total_s": 189.48921513557434, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 189.48921513557434, "timesteps_since_restore": 6000, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 29.274169741697413, "ram_util_percent": 34.70479704797048}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -542.5274024060024, "episode_reward_min": -735.684274168699, "episode_reward_mean": -622.9846161842462, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 55.0167215560018, "mean_processing_ms": 6.247452237547745, "mean_inference_ms": 1.2776461161371637}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11776, "num_steps_sampled": 12000, "sample_time_ms": 193257.172, "load_time_ms": 82.974, "grad_time_ms": 1839.072, "update_time_ms": 492.243, "learner": {"default_policy": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 9698.8544921875, "policy_loss": -0.00825420580804348, "vf_loss": 9698.861328125, "vf_explained_var": 4.273653030395508e-05, "kl": 0.0066380747593939304, "entropy": 12.84683609008789, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 12000, "episodes_total": 60, "training_iteration": 2, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_20-33-33", "timestamp": 1606230213, "time_this_iter_s": 201.966570854187, "time_total_s": 391.45578598976135, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 391.45578598976135, "timesteps_since_restore": 12000, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 29.37152777777778, "ram_util_percent": 35.33298611111111}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -542.5274024060024, "episode_reward_min": -735.684274168699, "episode_reward_mean": -630.6679296096937, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 55.82629142076338, "mean_processing_ms": 6.264353972793874, "mean_inference_ms": 1.2807212039205749}, "off_policy_estimator": {}, "info": {"num_steps_trained": 17664, "num_steps_sampled": 18000, "sample_time_ms": 196634.917, "load_time_ms": 59.007, "grad_time_ms": 1651.255, "update_time_ms": 330.982, "learner": {"default_policy": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 10653.876953125, "policy_loss": -0.009673328138887882, "vf_loss": 10653.8876953125, "vf_explained_var": 1.6774820323917083e-05, "kl": 0.007262215483933687, "entropy": 12.729700088500977, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 18000, "episodes_total": 90, "training_iteration": 3, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_20-36-58", "timestamp": 1606230418, "time_this_iter_s": 204.6932888031006, "time_total_s": 596.1490747928619, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 596.1490747928619, "timesteps_since_restore": 18000, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 29.597945205479448, "ram_util_percent": 35.316095890410956}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -542.5274024060024, "episode_reward_min": -735.684274168699, "episode_reward_mean": -632.1831392731123, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 56.88070084669553, "mean_processing_ms": 6.28410256797481, "mean_inference_ms": 1.2825038618432005}, "off_policy_estimator": {}, "info": {"num_steps_trained": 23552, "num_steps_sampled": 24000, "sample_time_ms": 198433.814, "load_time_ms": 47.022, "grad_time_ms": 1561.193, "update_time_ms": 250.269, "learner": {"default_policy": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 10154.560546875, "policy_loss": -0.017223168164491653, "vf_loss": 10154.578125, "vf_explained_var": 8.480704309477005e-06, "kl": 0.011937074363231659, "entropy": 12.594023704528809, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 24000, "episodes_total": 120, "training_iteration": 4, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_20-40-23", "timestamp": 1606230623, "time_this_iter_s": 205.14860939979553, "time_total_s": 801.2976841926575, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 801.2976841926575, "timesteps_since_restore": 24000, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 29.447440273037543, "ram_util_percent": 35.3235494880546}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -544.7315815701205, "episode_reward_min": -727.7647492543877, "episode_reward_mean": -637.3315531554445, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 57.77596235831049, "mean_processing_ms": 6.301129597082824, "mean_inference_ms": 1.2871510581636463}, "off_policy_estimator": {}, "info": {"num_steps_trained": 29440, "num_steps_sampled": 30000, "sample_time_ms": 199481.385, "load_time_ms": 39.847, "grad_time_ms": 1504.892, "update_time_ms": 201.491, "learner": {"default_policy": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 10372.53125, "policy_loss": -0.014764546416699886, "vf_loss": 10372.5478515625, "vf_explained_var": 4.70228815174778e-06, "kl": 0.009302682243287563, "entropy": 12.58789348602295, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 30000, "episodes_total": 150, "training_iteration": 5, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_20-43-48", "timestamp": 1606230828, "time_this_iter_s": 204.97659730911255, "time_total_s": 1006.27428150177, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1006.27428150177, "timesteps_since_restore": 30000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.333561643835623, "ram_util_percent": 35.327397260273976}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -544.7315815701205, "episode_reward_min": -727.7647492543877, "episode_reward_mean": -633.2029392715459, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 58.193168292357285, "mean_processing_ms": 6.3084629911506935, "mean_inference_ms": 1.2892750443732925}, "off_policy_estimator": {}, "info": {"num_steps_trained": 35328, "num_steps_sampled": 36000, "sample_time_ms": 200071.203, "load_time_ms": 35.046, "grad_time_ms": 1465.912, "update_time_ms": 169.33, "learner": {"default_policy": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 9875.6728515625, "policy_loss": -0.014340328983962536, "vf_loss": 9875.6865234375, "vf_explained_var": 3.1253566703526303e-06, "kl": 0.010931598953902721, "entropy": 12.5103759765625, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 36000, "episodes_total": 180, "training_iteration": 6, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_20-47-13", "timestamp": 1606231033, "time_this_iter_s": 204.31924271583557, "time_total_s": 1210.5935242176056, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1210.5935242176056, "timesteps_since_restore": 36000, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 29.310958904109587, "ram_util_percent": 35.38184931506849}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -555.3046137840703, "episode_reward_min": -728.5386903538509, "episode_reward_mean": -634.1882861504713, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 58.45304641801782, "mean_processing_ms": 6.313599395926901, "mean_inference_ms": 1.2905105537100285}, "off_policy_estimator": {}, "info": {"num_steps_trained": 41216, "num_steps_sampled": 42000, "sample_time_ms": 200756.381, "load_time_ms": 31.689, "grad_time_ms": 1436.768, "update_time_ms": 146.051, "learner": {"default_policy": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 10231.8818359375, "policy_loss": -0.008005611598491669, "vf_loss": 10231.8916015625, "vf_explained_var": 1.9565873117244337e-06, "kl": 0.008473453111946583, "entropy": 12.572351455688477, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 42000, "episodes_total": 210, "training_iteration": 7, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_20-50-39", "timestamp": 1606231239, "time_this_iter_s": 206.15582537651062, "time_total_s": 1416.7493495941162, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1416.7493495941162, "timesteps_since_restore": 42000, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 29.296938775510203, "ram_util_percent": 35.41156462585034}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -536.4028030183463, "episode_reward_min": -741.4253856914669, "episode_reward_mean": -632.0726419677205, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 58.6314166663278, "mean_processing_ms": 6.316957774286075, "mean_inference_ms": 1.2912015061826434}, "off_policy_estimator": {}, "info": {"num_steps_trained": 47104, "num_steps_sampled": 48000, "sample_time_ms": 200818.302, "load_time_ms": 29.123, "grad_time_ms": 1415.714, "update_time_ms": 128.719, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 10009.5927734375, "policy_loss": -0.01062087807804346, "vf_loss": 10009.603515625, "vf_explained_var": 1.313893676524458e-06, "kl": 0.00810485053807497, "entropy": 12.608660697937012, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 48000, "episodes_total": 240, "training_iteration": 8, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_20-54-01", "timestamp": 1606231441, "time_this_iter_s": 202.54622054100037, "time_total_s": 1619.2955701351166, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1619.2955701351166, "timesteps_since_restore": 48000, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 29.63114186851211, "ram_util_percent": 35.424221453287196}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -536.4028030183463, "episode_reward_min": -741.4253856914669, "episode_reward_mean": -631.5345499408462, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 58.760002922294916, "mean_processing_ms": 6.318878947413125, "mean_inference_ms": 1.2916621565822601}, "off_policy_estimator": {}, "info": {"num_steps_trained": 52992, "num_steps_sampled": 54000, "sample_time_ms": 200996.848, "load_time_ms": 27.418, "grad_time_ms": 1399.046, "update_time_ms": 115.147, "learner": {"default_policy": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 10021.2314453125, "policy_loss": -0.011477615684270859, "vf_loss": 10021.2412109375, "vf_explained_var": 9.264634854844189e-07, "kl": 0.008859192952513695, "entropy": 12.564864158630371, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 54000, "episodes_total": 270, "training_iteration": 9, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_20-57-25", "timestamp": 1606231645, "time_this_iter_s": 203.71946358680725, "time_total_s": 1823.0150337219238, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1823.0150337219238, "timesteps_since_restore": 54000, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 29.42275862068965, "ram_util_percent": 35.44137931034483}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -532.7327857249836, "episode_reward_min": -741.4253856914669, "episode_reward_mean": -627.3142137928482, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 58.83337874860533, "mean_processing_ms": 6.32038671246458, "mean_inference_ms": 1.2917387874745938}, "off_policy_estimator": {}, "info": {"num_steps_trained": 58880, "num_steps_sampled": 60000, "sample_time_ms": 200911.151, "load_time_ms": 25.785, "grad_time_ms": 1386.065, "update_time_ms": 104.444, "learner": {"default_policy": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 9497.48828125, "policy_loss": -0.010956489481031895, "vf_loss": 9497.4990234375, "vf_explained_var": 6.673128609691048e-07, "kl": 0.009338258765637875, "entropy": 12.63770580291748, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 60000, "episodes_total": 300, "training_iteration": 10, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_21-00-46", "timestamp": 1606231846, "time_this_iter_s": 201.4360315799713, "time_total_s": 2024.4510653018951, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2024.4510653018951, "timesteps_since_restore": 60000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 29.636805555555554, "ram_util_percent": 35.567708333333336}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -532.7327857249836, "episode_reward_min": -726.4528980900583, "episode_reward_mean": -619.7287249650235, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 58.84620376688651, "mean_processing_ms": 6.3216819194270535, "mean_inference_ms": 1.2913205930013103}, "off_policy_estimator": {}, "info": {"num_steps_trained": 64768, "num_steps_sampled": 66000, "sample_time_ms": 202148.69, "load_time_ms": 11.543, "grad_time_ms": 1272.502, "update_time_ms": 7.49, "learner": {"default_policy": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 9440.7939453125, "policy_loss": -0.012937082909047604, "vf_loss": 9440.806640625, "vf_explained_var": 4.89794672375865e-07, "kl": 0.011866917833685875, "entropy": 12.550858497619629, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 66000, "episodes_total": 330, "training_iteration": 11, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_21-04-06", "timestamp": 1606232046, "time_this_iter_s": 199.5227873325348, "time_total_s": 2223.97385263443, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2223.97385263443, "timesteps_since_restore": 66000, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 29.56760563380282, "ram_util_percent": 35.558098591549296}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -532.7327857249836, "episode_reward_min": -726.4528980900583, "episode_reward_mean": -618.9608542081809, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 58.83689548550872, "mean_processing_ms": 6.322595578517483, "mean_inference_ms": 1.2908396924295835}, "off_policy_estimator": {}, "info": {"num_steps_trained": 70656, "num_steps_sampled": 72000, "sample_time_ms": 202109.314, "load_time_ms": 11.428, "grad_time_ms": 1271.141, "update_time_ms": 7.569, "learner": {"default_policy": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 9491.3896484375, "policy_loss": -0.011323573999106884, "vf_loss": 9491.3994140625, "vf_explained_var": 3.5762786865234375e-07, "kl": 0.010621044784784317, "entropy": 12.429232597351074, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 72000, "episodes_total": 360, "training_iteration": 12, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_21-07-28", "timestamp": 1606232248, "time_this_iter_s": 201.56019830703735, "time_total_s": 2425.5340509414673, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2425.5340509414673, "timesteps_since_restore": 72000, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 29.454166666666666, "ram_util_percent": 35.53993055555556}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -532.7327857249836, "episode_reward_min": -705.5102523257601, "episode_reward_mean": -619.3051232769309, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 58.837882844849844, "mean_processing_ms": 6.323827908539629, "mean_inference_ms": 1.2905518116888697}, "off_policy_estimator": {}, "info": {"num_steps_trained": 76544, "num_steps_sampled": 78000, "sample_time_ms": 202205.628, "load_time_ms": 11.437, "grad_time_ms": 1270.961, "update_time_ms": 7.652, "learner": {"default_policy": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 9826.6025390625, "policy_loss": -0.009595214389264584, "vf_loss": 9826.6103515625, "vf_explained_var": 2.448973361879325e-07, "kl": 0.008918728679418564, "entropy": 12.437435150146484, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 78000, "episodes_total": 390, "training_iteration": 13, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_21-10-53", "timestamp": 1606232453, "time_this_iter_s": 205.6553144454956, "time_total_s": 2631.189365386963, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2631.189365386963, "timesteps_since_restore": 78000, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 29.39351535836177, "ram_util_percent": 35.582593856655286}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -537.4877213738471, "episode_reward_min": -704.8325295498082, "episode_reward_mean": -620.9317989714733, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 58.928936367745116, "mean_processing_ms": 6.3250397070784, "mean_inference_ms": 1.2918957764158083}, "off_policy_estimator": {}, "info": {"num_steps_trained": 82432, "num_steps_sampled": 84000, "sample_time_ms": 203040.801, "load_time_ms": 11.804, "grad_time_ms": 1269.646, "update_time_ms": 7.468, "learner": {"default_policy": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 9635.1484375, "policy_loss": -0.013400746509432793, "vf_loss": 9635.162109375, "vf_explained_var": 1.943629683864856e-07, "kl": 0.014059829525649548, "entropy": 12.51581859588623, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 84000, "episodes_total": 420, "training_iteration": 14, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_21-14-27", "timestamp": 1606232667, "time_this_iter_s": 213.4888415336609, "time_total_s": 2844.678206920624, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2844.678206920624, "timesteps_since_restore": 84000, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 33.56524590163935, "ram_util_percent": 39.92065573770491}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -530.5941159927361, "episode_reward_min": -710.514441940825, "episode_reward_mean": -622.5748022790492, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.0505770224727, "mean_processing_ms": 6.326797170439827, "mean_inference_ms": 1.2937044341643427}, "off_policy_estimator": {}, "info": {"num_steps_trained": 88320, "num_steps_sampled": 90000, "sample_time_ms": 203073.742, "load_time_ms": 11.879, "grad_time_ms": 1269.117, "update_time_ms": 7.66, "learner": {"default_policy": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 9374.2841796875, "policy_loss": -0.012563449330627918, "vf_loss": 9374.2978515625, "vf_explained_var": 1.4382860058503866e-07, "kl": 0.008871066384017467, "entropy": 12.499929428100586, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 90000, "episodes_total": 450, "training_iteration": 15, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_21-17-52", "timestamp": 1606232872, "time_this_iter_s": 205.304584980011, "time_total_s": 3049.9827919006348, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3049.9827919006348, "timesteps_since_restore": 90000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 30.95085324232082, "ram_util_percent": 43.140955631399315}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -530.5941159927361, "episode_reward_min": -715.807832125013, "episode_reward_mean": -618.5023265776815, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.18009920728521, "mean_processing_ms": 6.328920636315174, "mean_inference_ms": 1.295778773398873}, "off_policy_estimator": {}, "info": {"num_steps_trained": 94208, "num_steps_sampled": 96000, "sample_time_ms": 203280.64, "load_time_ms": 11.924, "grad_time_ms": 1268.828, "update_time_ms": 7.458, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 9129.3388671875, "policy_loss": -0.01666402630507946, "vf_loss": 9129.353515625, "vf_explained_var": 8.551970864800751e-08, "kl": 0.012563662603497505, "entropy": 12.473516464233398, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 96000, "episodes_total": 480, "training_iteration": 16, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_21-21-19", "timestamp": 1606233079, "time_this_iter_s": 206.38341999053955, "time_total_s": 3256.3662118911743, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3256.3662118911743, "timesteps_since_restore": 96000, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 30.947278911564627, "ram_util_percent": 43.18673469387755}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -530.5941159927361, "episode_reward_min": -718.2718810401218, "episode_reward_mean": -620.3360113583032, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.2672918292644, "mean_processing_ms": 6.330435872742698, "mean_inference_ms": 1.2970747394447455}, "off_policy_estimator": {}, "info": {"num_steps_trained": 100096, "num_steps_sampled": 102000, "sample_time_ms": 203310.522, "load_time_ms": 11.951, "grad_time_ms": 1272.146, "update_time_ms": 7.575, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 9694.0908203125, "policy_loss": -0.012212520465254784, "vf_loss": 9694.1015625, "vf_explained_var": 7.904094445621013e-08, "kl": 0.010541831143200397, "entropy": 12.416069984436035, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 102000, "episodes_total": 510, "training_iteration": 17, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_21-24-45", "timestamp": 1606233285, "time_this_iter_s": 206.48843908309937, "time_total_s": 3462.8546509742737, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3462.8546509742737, "timesteps_since_restore": 102000, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 30.289491525423735, "ram_util_percent": 43.20983050847458}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -541.0283667000414, "episode_reward_min": -718.2718810401218, "episode_reward_mean": -614.4959170590187, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.31792064510413, "mean_processing_ms": 6.331440494327218, "mean_inference_ms": 1.297954490134309}, "off_policy_estimator": {}, "info": {"num_steps_trained": 105984, "num_steps_sampled": 108000, "sample_time_ms": 203483.74, "load_time_ms": 11.942, "grad_time_ms": 1272.599, "update_time_ms": 7.47, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 9046.7177734375, "policy_loss": -0.013409936800599098, "vf_loss": 9046.7314453125, "vf_explained_var": 6.6083408967188e-08, "kl": 0.011434120126068592, "entropy": 12.50278091430664, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 108000, "episodes_total": 540, "training_iteration": 18, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_21-28-09", "timestamp": 1606233489, "time_this_iter_s": 204.28151082992554, "time_total_s": 3667.136161804199, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3667.136161804199, "timesteps_since_restore": 108000, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 30.40652920962199, "ram_util_percent": 43.19140893470791}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -541.0283667000414, "episode_reward_min": -718.2718810401218, "episode_reward_mean": -611.3286906142206, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.34464741796724, "mean_processing_ms": 6.3320153672667745, "mean_inference_ms": 1.2985666568324044}, "off_policy_estimator": {}, "info": {"num_steps_trained": 111872, "num_steps_sampled": 114000, "sample_time_ms": 203353.39, "load_time_ms": 11.687, "grad_time_ms": 1273.917, "update_time_ms": 7.516, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 8670.5908203125, "policy_loss": -0.011100935749709606, "vf_loss": 8670.6005859375, "vf_explained_var": 5.701313909867167e-08, "kl": 0.011318765580654144, "entropy": 12.421002388000488, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 114000, "episodes_total": 570, "training_iteration": 19, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_21-31-32", "timestamp": 1606233692, "time_this_iter_s": 202.42652535438538, "time_total_s": 3869.5626871585846, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3869.5626871585846, "timesteps_since_restore": 114000, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 30.16920415224914, "ram_util_percent": 43.202076124567476}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -548.066534966508, "episode_reward_min": -718.2718810401218, "episode_reward_mean": -606.5691666294639, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.35580899942164, "mean_processing_ms": 6.332591642739694, "mean_inference_ms": 1.2991207855508717}, "off_policy_estimator": {}, "info": {"num_steps_trained": 117760, "num_steps_sampled": 120000, "sample_time_ms": 203740.493, "load_time_ms": 11.963, "grad_time_ms": 1274.095, "update_time_ms": 7.533, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 8950.994140625, "policy_loss": -0.011048814281821251, "vf_loss": 8951.005859375, "vf_explained_var": 5.442163342195272e-08, "kl": 0.007631680462509394, "entropy": 12.404510498046875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 120000, "episodes_total": 600, "training_iteration": 20, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_21-34-57", "timestamp": 1606233897, "time_this_iter_s": 205.3119831085205, "time_total_s": 4074.874670267105, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4074.874670267105, "timesteps_since_restore": 120000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 30.197269624573376, "ram_util_percent": 43.27440273037543}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -522.1288949951443, "episode_reward_min": -693.9173290737411, "episode_reward_mean": -601.9335084634395, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.35313108623145, "mean_processing_ms": 6.333377234698009, "mean_inference_ms": 1.299571379050492}, "off_policy_estimator": {}, "info": {"num_steps_trained": 123648, "num_steps_sampled": 126000, "sample_time_ms": 204088.81, "load_time_ms": 11.968, "grad_time_ms": 1274.866, "update_time_ms": 7.747, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 8565.8017578125, "policy_loss": -0.016197755932807922, "vf_loss": 8565.818359375, "vf_explained_var": 1.2957531048130022e-08, "kl": 0.01303709764033556, "entropy": 12.2572603225708, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 126000, "episodes_total": 630, "training_iteration": 21, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_21-38-20", "timestamp": 1606234100, "time_this_iter_s": 203.01328468322754, "time_total_s": 4277.887954950333, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4277.887954950333, "timesteps_since_restore": 126000, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 30.412758620689658, "ram_util_percent": 43.43551724137931}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -515.7367696093222, "episode_reward_min": -677.3659260490434, "episode_reward_mean": -600.9948554391839, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.36166509815076, "mean_processing_ms": 6.33416550291503, "mean_inference_ms": 1.300075652900776}, "off_policy_estimator": {}, "info": {"num_steps_trained": 129536, "num_steps_sampled": 132000, "sample_time_ms": 204457.891, "load_time_ms": 12.014, "grad_time_ms": 1275.268, "update_time_ms": 7.571, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 8647.5595703125, "policy_loss": -0.014364652335643768, "vf_loss": 8647.57421875, "vf_explained_var": 1.5549037613027394e-08, "kl": 0.011851870454847813, "entropy": 12.334733963012695, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 132000, "episodes_total": 660, "training_iteration": 22, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_21-41-45", "timestamp": 1606234305, "time_this_iter_s": 205.25244641304016, "time_total_s": 4483.140401363373, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4483.140401363373, "timesteps_since_restore": 132000, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 30.77602739726027, "ram_util_percent": 44.36472602739726}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -515.7367696093222, "episode_reward_min": -705.2992204710215, "episode_reward_mean": -600.992234141676, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.38770420843951, "mean_processing_ms": 6.335171152136739, "mean_inference_ms": 1.300709426753068}, "off_policy_estimator": {}, "info": {"num_steps_trained": 135424, "num_steps_sampled": 138000, "sample_time_ms": 204516.983, "load_time_ms": 12.003, "grad_time_ms": 1277.185, "update_time_ms": 7.598, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 8639.00390625, "policy_loss": -0.01575852744281292, "vf_loss": 8639.0185546875, "vf_explained_var": 3.498533374113322e-08, "kl": 0.014074021019041538, "entropy": 12.320974349975586, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 138000, "episodes_total": 690, "training_iteration": 23, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_21-45-12", "timestamp": 1606234512, "time_this_iter_s": 206.26568818092346, "time_total_s": 4689.406089544296, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4689.406089544296, "timesteps_since_restore": 138000, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 31.24576271186441, "ram_util_percent": 44.11796610169491}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -515.7367696093222, "episode_reward_min": -705.2992204710215, "episode_reward_mean": -600.1029526693719, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.42577924953926, "mean_processing_ms": 6.336131117074317, "mean_inference_ms": 1.3014114434509514}, "off_policy_estimator": {}, "info": {"num_steps_trained": 141312, "num_steps_sampled": 144000, "sample_time_ms": 203909.693, "load_time_ms": 11.666, "grad_time_ms": 1279.322, "update_time_ms": 7.641, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 8657.208984375, "policy_loss": -0.014810857363045216, "vf_loss": 8657.2236328125, "vf_explained_var": 2.073205074282214e-08, "kl": 0.010382946580648422, "entropy": 12.267056465148926, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 144000, "episodes_total": 720, "training_iteration": 24, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_21-48-39", "timestamp": 1606234719, "time_this_iter_s": 207.43436789512634, "time_total_s": 4896.840457439423, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4896.840457439423, "timesteps_since_restore": 144000, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 30.843918918918916, "ram_util_percent": 43.83378378378378}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -528.825561592947, "episode_reward_min": -705.2992204710215, "episode_reward_mean": -602.0410143757085, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.47608599007495, "mean_processing_ms": 6.337259539220149, "mean_inference_ms": 1.302123354023944}, "off_policy_estimator": {}, "info": {"num_steps_trained": 147200, "num_steps_sampled": 150000, "sample_time_ms": 204155.618, "load_time_ms": 11.625, "grad_time_ms": 1299.221, "update_time_ms": 7.896, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 8709.6875, "policy_loss": -0.010880252346396446, "vf_loss": 8709.6982421875, "vf_explained_var": 0.0, "kl": 0.012560788542032242, "entropy": 12.14975643157959, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 150000, "episodes_total": 750, "training_iteration": 25, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_21-52-08", "timestamp": 1606234928, "time_this_iter_s": 207.96364855766296, "time_total_s": 5104.804105997086, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5104.804105997086, "timesteps_since_restore": 150000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 30.884175084175084, "ram_util_percent": 43.82659932659933}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -514.6004517512, "episode_reward_min": -704.9918269215262, "episode_reward_mean": -600.5489031291585, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.515695116212335, "mean_processing_ms": 6.33817832844517, "mean_inference_ms": 1.3026450519251285}, "off_policy_estimator": {}, "info": {"num_steps_trained": 153088, "num_steps_sampled": 156000, "sample_time_ms": 204091.655, "load_time_ms": 11.577, "grad_time_ms": 1299.524, "update_time_ms": 7.898, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 8430.4033203125, "policy_loss": -0.015321985818445683, "vf_loss": 8430.4189453125, "vf_explained_var": 1.036602537141107e-08, "kl": 0.013572185300290585, "entropy": 12.1473970413208, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 156000, "episodes_total": 780, "training_iteration": 26, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_21-55-33", "timestamp": 1606235133, "time_this_iter_s": 205.74595880508423, "time_total_s": 5310.55006480217, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5310.55006480217, "timesteps_since_restore": 156000, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 30.151877133105803, "ram_util_percent": 43.96860068259385}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -514.6004517512, "episode_reward_min": -704.9918269215262, "episode_reward_mean": -602.380075708097, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.543245449398256, "mean_processing_ms": 6.338817657573367, "mean_inference_ms": 1.302973708108156}, "off_policy_estimator": {}, "info": {"num_steps_trained": 158976, "num_steps_sampled": 162000, "sample_time_ms": 203887.127, "load_time_ms": 11.492, "grad_time_ms": 1297.858, "update_time_ms": 7.774, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 8787.443359375, "policy_loss": -0.011329509317874908, "vf_loss": 8787.4541015625, "vf_explained_var": 6.478765524065011e-09, "kl": 0.010326455347239971, "entropy": 12.130266189575195, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 162000, "episodes_total": 810, "training_iteration": 27, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_21-58-58", "timestamp": 1606235338, "time_this_iter_s": 204.42437410354614, "time_total_s": 5514.974438905716, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5514.974438905716, "timesteps_since_restore": 162000, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 30.112671232876718, "ram_util_percent": 43.83767123287671}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -514.6004517512, "episode_reward_min": -704.9918269215262, "episode_reward_mean": -601.7649418166011, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.5612291115436, "mean_processing_ms": 6.33943201298481, "mean_inference_ms": 1.3032763224072346}, "off_policy_estimator": {}, "info": {"num_steps_trained": 164864, "num_steps_sampled": 168000, "sample_time_ms": 204114.344, "load_time_ms": 11.497, "grad_time_ms": 1299.313, "update_time_ms": 7.808, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 8604.9423828125, "policy_loss": -0.011159214191138744, "vf_loss": 8604.9541015625, "vf_explained_var": 1.2957531714263837e-09, "kl": 0.011440224945545197, "entropy": 12.052024841308594, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 168000, "episodes_total": 840, "training_iteration": 28, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_22-02-24", "timestamp": 1606235544, "time_this_iter_s": 206.5693643093109, "time_total_s": 5721.543803215027, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5721.543803215027, "timesteps_since_restore": 168000, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 30.832881355932205, "ram_util_percent": 43.99796610169491}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -502.46215267472815, "episode_reward_min": -704.9918269215262, "episode_reward_mean": -599.3865839266368, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.613898569809116, "mean_processing_ms": 6.340492032530976, "mean_inference_ms": 1.304098866960256}, "off_policy_estimator": {}, "info": {"num_steps_trained": 170752, "num_steps_sampled": 174000, "sample_time_ms": 205427.47, "load_time_ms": 12.485, "grad_time_ms": 1313.73, "update_time_ms": 7.932, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 8183.59423828125, "policy_loss": -0.01859656535089016, "vf_loss": 8183.61279296875, "vf_explained_var": -5.183012685705535e-09, "kl": 0.013676329515874386, "entropy": 12.04216194152832, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 174000, "episodes_total": 870, "training_iteration": 29, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_22-06-00", "timestamp": 1606235760, "time_this_iter_s": 215.71373176574707, "time_total_s": 5937.257534980774, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5937.257534980774, "timesteps_since_restore": 174000, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 35.71172638436482, "ram_util_percent": 46.76058631921824}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -502.46215267472815, "episode_reward_min": -682.7476964276053, "episode_reward_mean": -598.8116101572249, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.72354671272249, "mean_processing_ms": 6.342388379453273, "mean_inference_ms": 1.3058758786763371}, "off_policy_estimator": {}, "info": {"num_steps_trained": 176640, "num_steps_sampled": 180000, "sample_time_ms": 207196.674, "load_time_ms": 12.96, "grad_time_ms": 1325.681, "update_time_ms": 7.822, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 8448.3359375, "policy_loss": -0.014769905246794224, "vf_loss": 8448.3515625, "vf_explained_var": -1.8140543289746347e-08, "kl": 0.01244744285941124, "entropy": 11.964978218078613, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 180000, "episodes_total": 900, "training_iteration": 30, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_22-09-43", "timestamp": 1606235983, "time_this_iter_s": 223.12752413749695, "time_total_s": 6160.385059118271, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6160.385059118271, "timesteps_since_restore": 180000, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 38.042006269592484, "ram_util_percent": 52.540752351097176}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -502.46215267472815, "episode_reward_min": -655.0230174035464, "episode_reward_mean": -597.5305036719966, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.86828871500213, "mean_processing_ms": 6.344954535513597, "mean_inference_ms": 1.3082128905734338}, "off_policy_estimator": {}, "info": {"num_steps_trained": 182528, "num_steps_sampled": 186000, "sample_time_ms": 208701.38, "load_time_ms": 13.648, "grad_time_ms": 1325.74, "update_time_ms": 7.603, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 8474.3251953125, "policy_loss": -0.017659956589341164, "vf_loss": 8474.3427734375, "vf_explained_var": -5.183012685705535e-09, "kl": 0.013126535341143608, "entropy": 11.876962661743164, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 186000, "episodes_total": 930, "training_iteration": 31, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_22-13-21", "timestamp": 1606236201, "time_this_iter_s": 218.0656397342682, "time_total_s": 6378.450698852539, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6378.450698852539, "timesteps_since_restore": 186000, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 35.83697749196142, "ram_util_percent": 53.26012861736335}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -499.42293967592565, "episode_reward_min": -700.3253317451745, "episode_reward_mean": -595.6217494874813, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.98168026154632, "mean_processing_ms": 6.347026361489144, "mean_inference_ms": 1.310018272859685}, "off_policy_estimator": {}, "info": {"num_steps_trained": 188416, "num_steps_sampled": 192000, "sample_time_ms": 208866.552, "load_time_ms": 13.895, "grad_time_ms": 1334.365, "update_time_ms": 7.574, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 8190.4482421875, "policy_loss": -0.017094595357775688, "vf_loss": 8190.46533203125, "vf_explained_var": 1.2957531714263837e-09, "kl": 0.016371099278330803, "entropy": 11.87225341796875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 192000, "episodes_total": 960, "training_iteration": 32, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_22-16-48", "timestamp": 1606236408, "time_this_iter_s": 206.99241995811462, "time_total_s": 6585.443118810654, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6585.443118810654, "timesteps_since_restore": 192000, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 30.421694915254243, "ram_util_percent": 52.46474576271186}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -499.42293967592565, "episode_reward_min": -700.3253317451745, "episode_reward_mean": -590.3651321772702, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.081138030211314, "mean_processing_ms": 6.349109347738597, "mean_inference_ms": 1.311665591490042}, "off_policy_estimator": {}, "info": {"num_steps_trained": 194304, "num_steps_sampled": 198000, "sample_time_ms": 210333.229, "load_time_ms": 14.718, "grad_time_ms": 1360.958, "update_time_ms": 7.314, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 7913.28076171875, "policy_loss": -0.010863256640732288, "vf_loss": 7913.29150390625, "vf_explained_var": 3.887259403256849e-09, "kl": 0.009942036122083664, "entropy": 11.7567720413208, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 198000, "episodes_total": 990, "training_iteration": 33, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_22-20-30", "timestamp": 1606236630, "time_this_iter_s": 221.20687055587769, "time_total_s": 6806.649989366531, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6806.649989366531, "timesteps_since_restore": 198000, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 36.23544303797468, "ram_util_percent": 53.89651898734178}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -499.42293967592565, "episode_reward_min": -700.3253317451745, "episode_reward_mean": -583.2895392317777, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.16440660653279, "mean_processing_ms": 6.351256460392426, "mean_inference_ms": 1.313164659077789}, "off_policy_estimator": {}, "info": {"num_steps_trained": 200192, "num_steps_sampled": 204000, "sample_time_ms": 211294.624, "load_time_ms": 15.254, "grad_time_ms": 1362.567, "update_time_ms": 7.499, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 7415.1689453125, "policy_loss": -0.017033401876688004, "vf_loss": 7415.18701171875, "vf_explained_var": -1.2957531714263837e-09, "kl": 0.015399118885397911, "entropy": 11.604397773742676, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 204000, "episodes_total": 1020, "training_iteration": 34, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_22-24-07", "timestamp": 1606236847, "time_this_iter_s": 217.07163453102112, "time_total_s": 7023.7216238975525, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7023.7216238975525, "timesteps_since_restore": 204000, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 35.43462783171521, "ram_util_percent": 54.95631067961165}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -513.8257654839655, "episode_reward_min": -671.2312545812334, "episode_reward_mean": -580.0655562880933, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.24540845597326, "mean_processing_ms": 6.352954194523076, "mean_inference_ms": 1.3146487372422533}, "off_policy_estimator": {}, "info": {"num_steps_trained": 206080, "num_steps_sampled": 210000, "sample_time_ms": 211525.595, "load_time_ms": 15.461, "grad_time_ms": 1348.339, "update_time_ms": 7.351, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 7901.6044921875, "policy_loss": -0.017943112179636955, "vf_loss": 7901.6220703125, "vf_explained_var": -9.070271644873173e-09, "kl": 0.014041661284863949, "entropy": 11.528178215026855, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 210000, "episodes_total": 1050, "training_iteration": 35, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_22-27-37", "timestamp": 1606237057, "time_this_iter_s": 210.13586258888245, "time_total_s": 7233.857486486435, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7233.857486486435, "timesteps_since_restore": 210000, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 31.95933333333333, "ram_util_percent": 55.132333333333335}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -463.64656509590884, "episode_reward_min": -671.2312545812334, "episode_reward_mean": -576.5890556764427, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.30612920633901, "mean_processing_ms": 6.354119223392596, "mean_inference_ms": 1.315894875744055}, "off_policy_estimator": {}, "info": {"num_steps_trained": 211968, "num_steps_sampled": 216000, "sample_time_ms": 211751.461, "load_time_ms": 16.585, "grad_time_ms": 1350.716, "update_time_ms": 7.702, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 7458.57177734375, "policy_loss": -0.015392313711345196, "vf_loss": 7458.5869140625, "vf_explained_var": -1.2957531714263837e-09, "kl": 0.009751442819833755, "entropy": 11.593871116638184, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 216000, "episodes_total": 1080, "training_iteration": 36, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_22-31-05", "timestamp": 1606237265, "time_this_iter_s": 208.04463863372803, "time_total_s": 7441.902125120163, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7441.902125120163, "timesteps_since_restore": 216000, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 33.418181818181814, "ram_util_percent": 55.364646464646476}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -463.64656509590884, "episode_reward_min": -682.7111998657183, "episode_reward_mean": -578.4403459213885, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.3451963048479, "mean_processing_ms": 6.354611296770188, "mean_inference_ms": 1.3167096405819705}, "off_policy_estimator": {}, "info": {"num_steps_trained": 217856, "num_steps_sampled": 222000, "sample_time_ms": 212436.879, "load_time_ms": 17.108, "grad_time_ms": 1352.775, "update_time_ms": 7.694, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 7800.02978515625, "policy_loss": -0.014582515694200993, "vf_loss": 7800.0439453125, "vf_explained_var": 6.478765524065011e-09, "kl": 0.014277174137532711, "entropy": 11.689864158630371, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 222000, "episodes_total": 1110, "training_iteration": 37, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_22-34-36", "timestamp": 1606237476, "time_this_iter_s": 211.3041431903839, "time_total_s": 7653.206268310547, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7653.206268310547, "timesteps_since_restore": 222000, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 32.63986710963455, "ram_util_percent": 56.7890365448505}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -463.64656509590884, "episode_reward_min": -682.7111998657183, "episode_reward_mean": -581.5739104711791, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.38839115620392, "mean_processing_ms": 6.355029514717126, "mean_inference_ms": 1.317589373354023}, "off_policy_estimator": {}, "info": {"num_steps_trained": 223744, "num_steps_sampled": 228000, "sample_time_ms": 213396.956, "load_time_ms": 17.286, "grad_time_ms": 1354.691, "update_time_ms": 7.667, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 8057.05859375, "policy_loss": -0.013984533958137035, "vf_loss": 8057.07275390625, "vf_explained_var": -1.2957531714263837e-09, "kl": 0.012536946684122086, "entropy": 11.566193580627441, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 228000, "episodes_total": 1140, "training_iteration": 38, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_22-38-13", "timestamp": 1606237693, "time_this_iter_s": 216.1909055709839, "time_total_s": 7869.397173881531, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7869.397173881531, "timesteps_since_restore": 228000, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 33.74595469255664, "ram_util_percent": 56.949190938511336}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -512.1593669917471, "episode_reward_min": -682.7111998657183, "episode_reward_mean": -582.4084059060057, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.44571351756391, "mean_processing_ms": 6.356093354836516, "mean_inference_ms": 1.3187836822619594}, "off_policy_estimator": {}, "info": {"num_steps_trained": 229632, "num_steps_sampled": 234000, "sample_time_ms": 213397.285, "load_time_ms": 16.484, "grad_time_ms": 1356.754, "update_time_ms": 7.652, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 7611.86572265625, "policy_loss": -0.019300995394587517, "vf_loss": 7611.88330078125, "vf_explained_var": -1.1661778209770546e-08, "kl": 0.015535526908934116, "entropy": 11.690452575683594, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 234000, "episodes_total": 1170, "training_iteration": 39, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_22-41-48", "timestamp": 1606237908, "time_this_iter_s": 215.72942090034485, "time_total_s": 8085.126594781876, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8085.126594781876, "timesteps_since_restore": 234000, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 33.92142857142857, "ram_util_percent": 55.710389610389605}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -508.6092852797593, "episode_reward_min": -656.5864093467702, "episode_reward_mean": -581.0449966465173, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.51899287087272, "mean_processing_ms": 6.3578045404007, "mean_inference_ms": 1.3205462611077425}, "off_policy_estimator": {}, "info": {"num_steps_trained": 235520, "num_steps_sampled": 240000, "sample_time_ms": 212945.503, "load_time_ms": 16.445, "grad_time_ms": 1349.702, "update_time_ms": 7.791, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 7565.1494140625, "policy_loss": -0.014558841474354267, "vf_loss": 7565.1650390625, "vf_explained_var": -1.2957531714263837e-09, "kl": 0.012400167994201183, "entropy": 11.805176734924316, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 240000, "episodes_total": 1200, "training_iteration": 40, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_22-45-27", "timestamp": 1606238127, "time_this_iter_s": 218.54003620147705, "time_total_s": 8303.666630983353, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8303.666630983353, "timesteps_since_restore": 240000, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 33.90418006430868, "ram_util_percent": 56.218006430868165}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -465.09982863572776, "episode_reward_min": -663.9621602051812, "episode_reward_mean": -579.51961962855, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.572986758492426, "mean_processing_ms": 6.359349398664319, "mean_inference_ms": 1.321946462964315}, "off_policy_estimator": {}, "info": {"num_steps_trained": 241408, "num_steps_sampled": 246000, "sample_time_ms": 211869.994, "load_time_ms": 15.744, "grad_time_ms": 1352.094, "update_time_ms": 7.697, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 7629.28173828125, "policy_loss": -0.015191489830613136, "vf_loss": 7629.29736328125, "vf_explained_var": -7.774518806513697e-09, "kl": 0.01185661181807518, "entropy": 11.76148509979248, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 246000, "episodes_total": 1230, "training_iteration": 41, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_22-48-54", "timestamp": 1606238334, "time_this_iter_s": 207.32868337631226, "time_total_s": 8510.995314359665, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8510.995314359665, "timesteps_since_restore": 246000, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 31.08175675675676, "ram_util_percent": 54.46756756756756}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -465.09982863572776, "episode_reward_min": -666.0080037245208, "episode_reward_mean": -581.5695484041871, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.60276015594282, "mean_processing_ms": 6.36034431169247, "mean_inference_ms": 1.3228253929806717}, "off_policy_estimator": {}, "info": {"num_steps_trained": 247296, "num_steps_sampled": 252000, "sample_time_ms": 211954.54, "load_time_ms": 15.598, "grad_time_ms": 1345.46, "update_time_ms": 7.847, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 8133.7841796875, "policy_loss": -0.015222430229187012, "vf_loss": 8133.798828125, "vf_explained_var": -3.887259403256849e-09, "kl": 0.011462533846497536, "entropy": 11.803321838378906, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 252000, "episodes_total": 1260, "training_iteration": 42, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_22-52-22", "timestamp": 1606238542, "time_this_iter_s": 207.7713611125946, "time_total_s": 8718.76667547226, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8718.76667547226, "timesteps_since_restore": 252000, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 30.708417508417508, "ram_util_percent": 54.345454545454544}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -465.09982863572776, "episode_reward_min": -669.7807268045641, "episode_reward_mean": -585.8395311302814, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.60133822440013, "mean_processing_ms": 6.360344439688033, "mean_inference_ms": 1.3228884929385394}, "off_policy_estimator": {}, "info": {"num_steps_trained": 253184, "num_steps_sampled": 258000, "sample_time_ms": 210168.238, "load_time_ms": 15.11, "grad_time_ms": 1320.126, "update_time_ms": 7.775, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 7812.861328125, "policy_loss": -0.023179566487669945, "vf_loss": 7812.88427734375, "vf_explained_var": 2.5915063428527674e-09, "kl": 0.02054297924041748, "entropy": 11.838517189025879, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 258000, "episodes_total": 1290, "training_iteration": 43, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_22-55-45", "timestamp": 1606238745, "time_this_iter_s": 203.08219957351685, "time_total_s": 8921.848875045776, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8921.848875045776, "timesteps_since_restore": 258000, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 30.132525951557092, "ram_util_percent": 54.404152249134945}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -514.8393715199513, "episode_reward_min": -669.7807268045641, "episode_reward_mean": -591.7996193488518, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.592754892549195, "mean_processing_ms": 6.359981329841746, "mean_inference_ms": 1.3224772603490422}, "off_policy_estimator": {}, "info": {"num_steps_trained": 259072, "num_steps_sampled": 264000, "sample_time_ms": 209142.24, "load_time_ms": 14.844, "grad_time_ms": 1316.866, "update_time_ms": 7.545, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 8020.064453125, "policy_loss": -0.01714322157204151, "vf_loss": 8020.080078125, "vf_explained_var": -2.8506569549335836e-08, "kl": 0.015923447906970978, "entropy": 11.796562194824219, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 264000, "episodes_total": 1320, "training_iteration": 44, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_22-59-12", "timestamp": 1606238952, "time_this_iter_s": 206.77505230903625, "time_total_s": 9128.623927354813, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9128.623927354813, "timesteps_since_restore": 264000, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 30.20745762711864, "ram_util_percent": 54.547457627118646}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -511.18328587127843, "episode_reward_min": -701.7874604551268, "episode_reward_mean": -590.4325347595153, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.58357304140166, "mean_processing_ms": 6.35950169465352, "mean_inference_ms": 1.3219589981801718}, "off_policy_estimator": {}, "info": {"num_steps_trained": 264960, "num_steps_sampled": 270000, "sample_time_ms": 208741.636, "load_time_ms": 14.599, "grad_time_ms": 1339.553, "update_time_ms": 7.226, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 7941.4658203125, "policy_loss": -0.01861293986439705, "vf_loss": 7941.48486328125, "vf_explained_var": 7.774518806513697e-09, "kl": 0.010029683820903301, "entropy": 11.827938079833984, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 270000, "episodes_total": 1350, "training_iteration": 45, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_23-02-38", "timestamp": 1606239158, "time_this_iter_s": 206.3475136756897, "time_total_s": 9334.971441030502, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9334.971441030502, "timesteps_since_restore": 270000, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 30.235254237288135, "ram_util_percent": 54.62881355932203}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -486.26121149571435, "episode_reward_min": -701.7874604551268, "episode_reward_mean": -584.5401519271659, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.56810926885793, "mean_processing_ms": 6.359197848325729, "mean_inference_ms": 1.3214637795882893}, "off_policy_estimator": {}, "info": {"num_steps_trained": 270848, "num_steps_sampled": 276000, "sample_time_ms": 208169.563, "load_time_ms": 13.691, "grad_time_ms": 1338.299, "update_time_ms": 6.962, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 7168.03759765625, "policy_loss": -0.017531519755721092, "vf_loss": 7168.05419921875, "vf_explained_var": -6.478765524065011e-09, "kl": 0.014497962780296803, "entropy": 11.793853759765625, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 276000, "episodes_total": 1380, "training_iteration": 46, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_23-06-01", "timestamp": 1606239361, "time_this_iter_s": 202.2985155582428, "time_total_s": 9537.269956588745, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9537.269956588745, "timesteps_since_restore": 276000, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 30.00173611111111, "ram_util_percent": 54.71875}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -486.26121149571435, "episode_reward_min": -701.7874604551268, "episode_reward_mean": -576.7172502590838, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.54638224182006, "mean_processing_ms": 6.358928764797604, "mean_inference_ms": 1.3209870367487335}, "off_policy_estimator": {}, "info": {"num_steps_trained": 276736, "num_steps_sampled": 282000, "sample_time_ms": 207202.368, "load_time_ms": 13.445, "grad_time_ms": 1336.146, "update_time_ms": 7.049, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 7237.9462890625, "policy_loss": -0.018031617626547813, "vf_loss": 7237.96337890625, "vf_explained_var": 1.2957531714263837e-09, "kl": 0.014195424504578114, "entropy": 11.646995544433594, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 282000, "episodes_total": 1410, "training_iteration": 47, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_23-09-22", "timestamp": 1606239562, "time_this_iter_s": 201.6095519065857, "time_total_s": 9738.87950849533, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9738.87950849533, "timesteps_since_restore": 282000, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 30.15972222222222, "ram_util_percent": 54.91111111111111}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -480.90873623466945, "episode_reward_min": -701.7874604551268, "episode_reward_mean": -574.4867303897171, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.51957326234639, "mean_processing_ms": 6.3586686198489835, "mean_inference_ms": 1.3205212116867804}, "off_policy_estimator": {}, "info": {"num_steps_trained": 282624, "num_steps_sampled": 288000, "sample_time_ms": 206037.022, "load_time_ms": 13.284, "grad_time_ms": 1333.163, "update_time_ms": 7.212, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 7612.70703125, "policy_loss": -0.01419917494058609, "vf_loss": 7612.720703125, "vf_explained_var": -5.183012685705535e-09, "kl": 0.010074043646454811, "entropy": 11.808777809143066, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 288000, "episodes_total": 1440, "training_iteration": 48, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_23-12-47", "timestamp": 1606239767, "time_this_iter_s": 204.50728011131287, "time_total_s": 9943.386788606644, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9943.386788606644, "timesteps_since_restore": 288000, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 30.081506849315065, "ram_util_percent": 54.90479452054794}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -480.90873623466945, "episode_reward_min": -673.009520218546, "episode_reward_mean": -578.2985750848534, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.50028901728785, "mean_processing_ms": 6.35842434588996, "mean_inference_ms": 1.3200727606469653}, "off_policy_estimator": {}, "info": {"num_steps_trained": 288512, "num_steps_sampled": 294000, "sample_time_ms": 204998.704, "load_time_ms": 13.094, "grad_time_ms": 1316.204, "update_time_ms": 7.058, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 7537.63232421875, "policy_loss": -0.02173641510307789, "vf_loss": 7537.6533203125, "vf_explained_var": 6.478765524065011e-09, "kl": 0.014007641933858395, "entropy": 11.761198997497559, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 294000, "episodes_total": 1470, "training_iteration": 49, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_23-16-12", "timestamp": 1606239972, "time_this_iter_s": 205.1739432811737, "time_total_s": 10148.560731887817, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10148.560731887817, "timesteps_since_restore": 294000, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 30.38321917808219, "ram_util_percent": 55.00650684931507}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -480.90873623466945, "episode_reward_min": -673.009520218546, "episode_reward_mean": -575.0990332088498, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.4838348336341, "mean_processing_ms": 6.358151577213875, "mean_inference_ms": 1.3196284608717308}, "off_policy_estimator": {}, "info": {"num_steps_trained": 294400, "num_steps_sampled": 300000, "sample_time_ms": 203535.797, "load_time_ms": 12.656, "grad_time_ms": 1310.764, "update_time_ms": 6.798, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 7088.919921875, "policy_loss": -0.020526235923171043, "vf_loss": 7088.94091796875, "vf_explained_var": -1.4253284774667918e-08, "kl": 0.017304593697190285, "entropy": 11.706892013549805, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 300000, "episodes_total": 1500, "training_iteration": 50, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_23-19-36", "timestamp": 1606240176, "time_this_iter_s": 203.85076808929443, "time_total_s": 10352.411499977112, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10352.411499977112, "timesteps_since_restore": 300000, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 29.961512027491413, "ram_util_percent": 55.01821305841924}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -480.90873623466945, "episode_reward_min": -680.8061283815551, "episode_reward_mean": -570.5129282654399, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.46809512658012, "mean_processing_ms": 6.357861514183082, "mean_inference_ms": 1.3191943968684499}, "off_policy_estimator": {}, "info": {"num_steps_trained": 300288, "num_steps_sampled": 306000, "sample_time_ms": 203314.794, "load_time_ms": 12.662, "grad_time_ms": 1308.313, "update_time_ms": 6.824, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 7082.3798828125, "policy_loss": -0.014648915268480778, "vf_loss": 7082.39453125, "vf_explained_var": -1.8140543289746347e-08, "kl": 0.012634205631911755, "entropy": 11.626921653747559, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 306000, "episodes_total": 1530, "training_iteration": 51, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_23-23-01", "timestamp": 1606240381, "time_this_iter_s": 205.09508299827576, "time_total_s": 10557.506582975388, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10557.506582975388, "timesteps_since_restore": 306000, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 30.07235494880546, "ram_util_percent": 55.15119453924915}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -487.0047999396759, "episode_reward_min": -680.8061283815551, "episode_reward_mean": -563.1474364293199, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.4502181283925, "mean_processing_ms": 6.357555258291813, "mean_inference_ms": 1.3188399632504555}, "off_policy_estimator": {}, "info": {"num_steps_trained": 306176, "num_steps_sampled": 312000, "sample_time_ms": 202943.354, "load_time_ms": 12.519, "grad_time_ms": 1308.142, "update_time_ms": 6.641, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6691.4658203125, "policy_loss": -0.014967603608965874, "vf_loss": 6691.4814453125, "vf_explained_var": -1.2957531048130022e-08, "kl": 0.01250159740447998, "entropy": 11.64644718170166, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 312000, "episodes_total": 1560, "training_iteration": 52, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_23-26-25", "timestamp": 1606240585, "time_this_iter_s": 204.05176424980164, "time_total_s": 10761.55834722519, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10761.55834722519, "timesteps_since_restore": 312000, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 30.54364261168385, "ram_util_percent": 55.24982817869416}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -471.815354698211, "episode_reward_min": -680.8061283815551, "episode_reward_mean": -555.8639732714594, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.43083068511291, "mean_processing_ms": 6.357753443258323, "mean_inference_ms": 1.3185125997440652}, "off_policy_estimator": {}, "info": {"num_steps_trained": 312064, "num_steps_sampled": 318000, "sample_time_ms": 203158.141, "load_time_ms": 12.227, "grad_time_ms": 1304.317, "update_time_ms": 6.799, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6583.75927734375, "policy_loss": -0.01858305186033249, "vf_loss": 6583.7783203125, "vf_explained_var": 3.887259403256849e-09, "kl": 0.01702452264726162, "entropy": 11.647454261779785, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 318000, "episodes_total": 1590, "training_iteration": 53, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_23-29-50", "timestamp": 1606240790, "time_this_iter_s": 205.19052720069885, "time_total_s": 10966.748874425888, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10966.748874425888, "timesteps_since_restore": 318000, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 29.881569965870305, "ram_util_percent": 55.444368600682594}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -471.815354698211, "episode_reward_min": -653.5374920464722, "episode_reward_mean": -555.171715847118, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.41293264385598, "mean_processing_ms": 6.358039843610377, "mean_inference_ms": 1.3182112864658178}, "off_policy_estimator": {}, "info": {"num_steps_trained": 317952, "num_steps_sampled": 324000, "sample_time_ms": 202799.304, "load_time_ms": 12.199, "grad_time_ms": 1302.589, "update_time_ms": 6.909, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6871.3544921875, "policy_loss": -0.018132222816348076, "vf_loss": 6871.373046875, "vf_explained_var": 2.5915063428527674e-09, "kl": 0.012505361810326576, "entropy": 11.656232833862305, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 324000, "episodes_total": 1620, "training_iteration": 54, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_23-33-14", "timestamp": 1606240994, "time_this_iter_s": 203.16953706741333, "time_total_s": 11169.918411493301, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11169.918411493301, "timesteps_since_restore": 324000, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 30.093425605536332, "ram_util_percent": 55.522491349480966}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -471.815354698211, "episode_reward_min": -653.5374920464722, "episode_reward_mean": -558.0065412554208, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.39617750265681, "mean_processing_ms": 6.358382194889242, "mean_inference_ms": 1.3178898759740492}, "off_policy_estimator": {}, "info": {"num_steps_trained": 323840, "num_steps_sampled": 330000, "sample_time_ms": 202616.498, "load_time_ms": 12.176, "grad_time_ms": 1298.918, "update_time_ms": 6.977, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6947.84765625, "policy_loss": -0.012459466233849525, "vf_loss": 6947.85986328125, "vf_explained_var": 1.4253284774667918e-08, "kl": 0.012883144430816174, "entropy": 11.640024185180664, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 330000, "episodes_total": 1650, "training_iteration": 55, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_23-36-38", "timestamp": 1606241198, "time_this_iter_s": 204.48301887512207, "time_total_s": 11374.401430368423, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11374.401430368423, "timesteps_since_restore": 330000, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 30.199315068493153, "ram_util_percent": 55.59109589041097}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -471.815354698211, "episode_reward_min": -653.5374920464722, "episode_reward_mean": -559.879451668988, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.39020834903394, "mean_processing_ms": 6.358679061789727, "mean_inference_ms": 1.317767985760437}, "off_policy_estimator": {}, "info": {"num_steps_trained": 329728, "num_steps_sampled": 336000, "sample_time_ms": 203388.145, "load_time_ms": 11.981, "grad_time_ms": 1326.952, "update_time_ms": 7.172, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6726.267578125, "policy_loss": -0.016605563461780548, "vf_loss": 6726.28466796875, "vf_explained_var": 2.4619309257900568e-08, "kl": 0.012758738361299038, "entropy": 11.680159568786621, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 336000, "episodes_total": 1680, "training_iteration": 56, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_23-40-08", "timestamp": 1606241408, "time_this_iter_s": 210.29655361175537, "time_total_s": 11584.697983980179, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11584.697983980179, "timesteps_since_restore": 336000, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 32.26800000000001, "ram_util_percent": 55.84399999999999}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -487.52565971737573, "episode_reward_min": -643.658465536505, "episode_reward_mean": -558.807412959534, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.39801419968669, "mean_processing_ms": 6.358774932044218, "mean_inference_ms": 1.3179491347286396}, "off_policy_estimator": {}, "info": {"num_steps_trained": 335616, "num_steps_sampled": 342000, "sample_time_ms": 204432.682, "load_time_ms": 11.778, "grad_time_ms": 1328.405, "update_time_ms": 7.275, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6650.9638671875, "policy_loss": -0.012427854351699352, "vf_loss": 6650.97705078125, "vf_explained_var": 6.478765524065011e-09, "kl": 0.012495026923716068, "entropy": 11.597147941589355, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 342000, "episodes_total": 1710, "training_iteration": 57, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_23-43-40", "timestamp": 1606241620, "time_this_iter_s": 212.0686662197113, "time_total_s": 11796.76665019989, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11796.76665019989, "timesteps_since_restore": 342000, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 33.08085808580858, "ram_util_percent": 56.05577557755776}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -497.7540321227317, "episode_reward_min": -639.542946515509, "episode_reward_mean": -555.4707075660391, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.41533263563981, "mean_processing_ms": 6.359074237700123, "mean_inference_ms": 1.3183217640150635}, "off_policy_estimator": {}, "info": {"num_steps_trained": 341504, "num_steps_sampled": 348000, "sample_time_ms": 204939.773, "load_time_ms": 11.768, "grad_time_ms": 1328.415, "update_time_ms": 7.275, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6593.80517578125, "policy_loss": -0.016546234488487244, "vf_loss": 6593.8212890625, "vf_explained_var": -2.073205074282214e-08, "kl": 0.014177044853568077, "entropy": 11.57987117767334, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 348000, "episodes_total": 1740, "training_iteration": 58, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_23-47-10", "timestamp": 1606241830, "time_this_iter_s": 209.57905650138855, "time_total_s": 12006.345706701279, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12006.345706701279, "timesteps_since_restore": 348000, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 32.062541806020064, "ram_util_percent": 56.20066889632107}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -474.75688789789837, "episode_reward_min": -683.2597341731941, "episode_reward_mean": -554.1215725866582, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.42817996883714, "mean_processing_ms": 6.3593357121196785, "mean_inference_ms": 1.318605365230637}, "off_policy_estimator": {}, "info": {"num_steps_trained": 347392, "num_steps_sampled": 354000, "sample_time_ms": 204950.625, "load_time_ms": 11.773, "grad_time_ms": 1329.104, "update_time_ms": 7.248, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6639.08447265625, "policy_loss": -0.021502191200852394, "vf_loss": 6639.10400390625, "vf_explained_var": -1.8140543289746347e-08, "kl": 0.015900371596217155, "entropy": 11.531425476074219, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 354000, "episodes_total": 1770, "training_iteration": 59, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_23-50-35", "timestamp": 1606242035, "time_this_iter_s": 205.2888205051422, "time_total_s": 12211.63452720642, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12211.63452720642, "timesteps_since_restore": 354000, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 30.224914675767923, "ram_util_percent": 56.18361774744028}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -474.75688789789837, "episode_reward_min": -683.2597341731941, "episode_reward_mean": -552.4045527927921, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.43071752907694, "mean_processing_ms": 6.359413738447097, "mean_inference_ms": 1.3186936905228532}, "off_policy_estimator": {}, "info": {"num_steps_trained": 353280, "num_steps_sampled": 360000, "sample_time_ms": 204980.919, "load_time_ms": 11.52, "grad_time_ms": 1331.342, "update_time_ms": 7.423, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6513.13232421875, "policy_loss": -0.010443128645420074, "vf_loss": 6513.142578125, "vf_explained_var": -9.070271644873173e-09, "kl": 0.013835995458066463, "entropy": 11.567375183105469, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 360000, "episodes_total": 1800, "training_iteration": 60, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_23-54-00", "timestamp": 1606242240, "time_this_iter_s": 204.17367553710938, "time_total_s": 12415.80820274353, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12415.80820274353, "timesteps_since_restore": 360000, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 30.4893470790378, "ram_util_percent": 55.57422680412371}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -474.75688789789837, "episode_reward_min": -683.2597341731941, "episode_reward_mean": -550.2986991605517, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.42291624368804, "mean_processing_ms": 6.3592975234224465, "mean_inference_ms": 1.3186139966851496}, "off_policy_estimator": {}, "info": {"num_steps_trained": 359168, "num_steps_sampled": 366000, "sample_time_ms": 204909.704, "load_time_ms": 11.513, "grad_time_ms": 1330.52, "update_time_ms": 7.596, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6381.64208984375, "policy_loss": -0.01779704913496971, "vf_loss": 6381.65966796875, "vf_explained_var": -1.1661778209770546e-08, "kl": 0.015671681612730026, "entropy": 11.501014709472656, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 366000, "episodes_total": 1830, "training_iteration": 61, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-24_23-57-24", "timestamp": 1606242444, "time_this_iter_s": 204.37352180480957, "time_total_s": 12620.18172454834, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12620.18172454834, "timesteps_since_restore": 366000, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 30.342955326460483, "ram_util_percent": 55.52027491408935}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -475.45306920280694, "episode_reward_min": -627.3236551825523, "episode_reward_mean": -549.6394909323437, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.410460669402674, "mean_processing_ms": 6.35909802369016, "mean_inference_ms": 1.3184699520088818}, "off_policy_estimator": {}, "info": {"num_steps_trained": 365056, "num_steps_sampled": 372000, "sample_time_ms": 204861.362, "load_time_ms": 11.491, "grad_time_ms": 1330.943, "update_time_ms": 7.588, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6464.57958984375, "policy_loss": -0.020691175013780594, "vf_loss": 6464.6005859375, "vf_explained_var": -3.887259403256849e-09, "kl": 0.013311508111655712, "entropy": 11.405938148498535, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 372000, "episodes_total": 1860, "training_iteration": 62, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_00-00-48", "timestamp": 1606242648, "time_this_iter_s": 203.57309103012085, "time_total_s": 12823.75481557846, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12823.75481557846, "timesteps_since_restore": 372000, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 30.422680412371133, "ram_util_percent": 55.61512027491409}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -475.45306920280694, "episode_reward_min": -630.4879105888957, "episode_reward_mean": -551.2643824982305, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.401100847982725, "mean_processing_ms": 6.35894651742713, "mean_inference_ms": 1.3183492184741288}, "off_policy_estimator": {}, "info": {"num_steps_trained": 370944, "num_steps_sampled": 378000, "sample_time_ms": 205044.258, "load_time_ms": 11.449, "grad_time_ms": 1331.256, "update_time_ms": 7.463, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6606.58984375, "policy_loss": -0.01731155626475811, "vf_loss": 6606.6064453125, "vf_explained_var": -1.9436297904462663e-08, "kl": 0.013182411901652813, "entropy": 11.39433479309082, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 378000, "episodes_total": 1890, "training_iteration": 63, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_00-04-15", "timestamp": 1606242855, "time_this_iter_s": 207.02253341674805, "time_total_s": 13030.777348995209, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13030.777348995209, "timesteps_since_restore": 378000, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 30.52440677966102, "ram_util_percent": 55.72338983050848}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -475.8149662458512, "episode_reward_min": -648.9265696924955, "episode_reward_mean": -553.9806128660931, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.39408497049184, "mean_processing_ms": 6.358831888740934, "mean_inference_ms": 1.318189159184845}, "off_policy_estimator": {}, "info": {"num_steps_trained": 376832, "num_steps_sampled": 384000, "sample_time_ms": 205236.959, "load_time_ms": 11.209, "grad_time_ms": 1333.083, "update_time_ms": 7.302, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6548.640625, "policy_loss": -0.01689758710563183, "vf_loss": 6548.65625, "vf_explained_var": -1.4253284774667918e-08, "kl": 0.013948439620435238, "entropy": 11.176621437072754, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 384000, "episodes_total": 1920, "training_iteration": 64, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_00-07-40", "timestamp": 1606243060, "time_this_iter_s": 205.1115210056305, "time_total_s": 13235.88887000084, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13235.88887000084, "timesteps_since_restore": 384000, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 30.3443686006826, "ram_util_percent": 55.76211604095563}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -474.0863106240844, "episode_reward_min": -648.9265696924955, "episode_reward_mean": -552.0091899833627, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.390958493311516, "mean_processing_ms": 6.358733633359525, "mean_inference_ms": 1.3180444048953819}, "off_policy_estimator": {}, "info": {"num_steps_trained": 382720, "num_steps_sampled": 390000, "sample_time_ms": 205656.361, "load_time_ms": 14.092, "grad_time_ms": 1330.205, "update_time_ms": 7.218, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6467.07080078125, "policy_loss": -0.019933218136429787, "vf_loss": 6467.09033203125, "vf_explained_var": -1.2957531714263837e-09, "kl": 0.0153165552765131, "entropy": 11.299703598022461, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 390000, "episodes_total": 1950, "training_iteration": 65, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_00-11-09", "timestamp": 1606243269, "time_this_iter_s": 208.6756386756897, "time_total_s": 13444.564508676529, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13444.564508676529, "timesteps_since_restore": 390000, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 30.46912751677852, "ram_util_percent": 55.752684563758386}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -474.0863106240844, "episode_reward_min": -648.9265696924955, "episode_reward_mean": -550.1158835584607, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.386840862067366, "mean_processing_ms": 6.358512203610539, "mean_inference_ms": 1.3178926256370105}, "off_policy_estimator": {}, "info": {"num_steps_trained": 388608, "num_steps_sampled": 396000, "sample_time_ms": 205018.252, "load_time_ms": 14.212, "grad_time_ms": 1301.028, "update_time_ms": 6.957, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6185.21875, "policy_loss": -0.02193099819123745, "vf_loss": 6185.24169921875, "vf_explained_var": -9.070271644873173e-09, "kl": 0.016679605469107628, "entropy": 11.206343650817871, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 396000, "episodes_total": 1980, "training_iteration": 66, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_00-14-32", "timestamp": 1606243472, "time_this_iter_s": 203.6206760406494, "time_total_s": 13648.185184717178, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13648.185184717178, "timesteps_since_restore": 396000, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 30.268275862068965, "ram_util_percent": 55.83896551724138}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -462.4337911486347, "episode_reward_min": -648.9265696924955, "episode_reward_mean": -545.4198788013439, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.37775973714747, "mean_processing_ms": 6.358236493780925, "mean_inference_ms": 1.317731536420308}, "off_policy_estimator": {}, "info": {"num_steps_trained": 394496, "num_steps_sampled": 402000, "sample_time_ms": 204150.029, "load_time_ms": 14.772, "grad_time_ms": 1299.898, "update_time_ms": 6.78, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6048.7607421875, "policy_loss": -0.02213420905172825, "vf_loss": 6048.783203125, "vf_explained_var": 7.774518806513697e-09, "kl": 0.014791703782975674, "entropy": 11.084454536437988, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 402000, "episodes_total": 2010, "training_iteration": 67, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_00-17-56", "timestamp": 1606243676, "time_this_iter_s": 203.37939620018005, "time_total_s": 13851.564580917358, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13851.564580917358, "timesteps_since_restore": 402000, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 30.25827586206897, "ram_util_percent": 55.723103448275864}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -462.4337911486347, "episode_reward_min": -635.4044934295607, "episode_reward_mean": -542.5577778564794, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.36941157772182, "mean_processing_ms": 6.358036936642009, "mean_inference_ms": 1.3175874366479465}, "off_policy_estimator": {}, "info": {"num_steps_trained": 400384, "num_steps_sampled": 408000, "sample_time_ms": 203707.498, "load_time_ms": 14.89, "grad_time_ms": 1299.028, "update_time_ms": 6.76, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6047.2783203125, "policy_loss": -0.023764226585626602, "vf_loss": 6047.30224609375, "vf_explained_var": -2.721081671097636e-08, "kl": 0.015669455751776695, "entropy": 11.047079086303711, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 408000, "episodes_total": 2040, "training_iteration": 68, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_00-21-21", "timestamp": 1606243881, "time_this_iter_s": 205.14508938789368, "time_total_s": 14056.709670305252, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14056.709670305252, "timesteps_since_restore": 408000, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 30.4296928327645, "ram_util_percent": 55.844368600682586}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -462.4337911486347, "episode_reward_min": -635.4044934295607, "episode_reward_mean": -538.6796304983583, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.3591410595259, "mean_processing_ms": 6.357907597582371, "mean_inference_ms": 1.3174474693749172}, "off_policy_estimator": {}, "info": {"num_steps_trained": 406272, "num_steps_sampled": 414000, "sample_time_ms": 203557.371, "load_time_ms": 16.359, "grad_time_ms": 1297.889, "update_time_ms": 6.997, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6007.21875, "policy_loss": -0.019617464393377304, "vf_loss": 6007.23828125, "vf_explained_var": -1.684479045138687e-08, "kl": 0.01389872096478939, "entropy": 11.111144065856934, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 414000, "episodes_total": 2070, "training_iteration": 69, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_00-24-45", "timestamp": 1606244085, "time_this_iter_s": 203.79214596748352, "time_total_s": 14260.501816272736, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14260.501816272736, "timesteps_since_restore": 414000, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 30.415807560137456, "ram_util_percent": 55.90240549828178}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -462.4337911486347, "episode_reward_min": -650.0225518332527, "episode_reward_mean": -538.7694356151965, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.34997650782296, "mean_processing_ms": 6.357925191385869, "mean_inference_ms": 1.3173168153381098}, "off_policy_estimator": {}, "info": {"num_steps_trained": 412160, "num_steps_sampled": 420000, "sample_time_ms": 203666.773, "load_time_ms": 16.331, "grad_time_ms": 1297.35, "update_time_ms": 6.94, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6171.11083984375, "policy_loss": -0.015793917700648308, "vf_loss": 6171.126953125, "vf_explained_var": -1.684479045138687e-08, "kl": 0.013413259759545326, "entropy": 11.224822998046875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 420000, "episodes_total": 2100, "training_iteration": 70, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_00-28-10", "timestamp": 1606244290, "time_this_iter_s": 205.26207447052002, "time_total_s": 14465.763890743256, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14465.763890743256, "timesteps_since_restore": 420000, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 30.14452054794521, "ram_util_percent": 55.98390410958905}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -471.08372799319113, "episode_reward_min": -650.0225518332527, "episode_reward_mean": -541.4374105081274, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.31691751046188, "mean_processing_ms": 6.357485242536538, "mean_inference_ms": 1.316672884463264}, "off_policy_estimator": {}, "info": {"num_steps_trained": 418048, "num_steps_sampled": 426000, "sample_time_ms": 201852.264, "load_time_ms": 15.991, "grad_time_ms": 1232.063, "update_time_ms": 6.786, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5977.5732421875, "policy_loss": -0.018042167648673058, "vf_loss": 5977.59033203125, "vf_explained_var": 1.1661778209770546e-08, "kl": 0.018588174134492874, "entropy": 11.207154273986816, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 426000, "episodes_total": 2130, "training_iteration": 71, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_00-31-15", "timestamp": 1606244475, "time_this_iter_s": 185.5671625137329, "time_total_s": 14651.331053256989, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14651.331053256989, "timesteps_since_restore": 426000, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 30.373207547169812, "ram_util_percent": 56.03283018867925}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -471.08372799319113, "episode_reward_min": -650.0225518332527, "episode_reward_mean": -536.8282993002924, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.21710190354139, "mean_processing_ms": 6.355818499211211, "mean_inference_ms": 1.3147783266261046}, "off_policy_estimator": {}, "info": {"num_steps_trained": 423936, "num_steps_sampled": 432000, "sample_time_ms": 196950.885, "load_time_ms": 15.995, "grad_time_ms": 1231.395, "update_time_ms": 6.487, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5791.18896484375, "policy_loss": -0.014633318409323692, "vf_loss": 5791.20361328125, "vf_explained_var": -4.794286567744166e-08, "kl": 0.01198381558060646, "entropy": 10.929734230041504, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 432000, "episodes_total": 2160, "training_iteration": 72, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_00-33-50", "timestamp": 1606244630, "time_this_iter_s": 154.5490734577179, "time_total_s": 14805.880126714706, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14805.880126714706, "timesteps_since_restore": 432000, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 28.91809954751131, "ram_util_percent": 56.0343891402715}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -464.6442053378482, "episode_reward_min": -625.0295764193568, "episode_reward_mean": -533.5317757988884, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.048931399584056, "mean_processing_ms": 6.352889134139064, "mean_inference_ms": 1.3115785053522844}, "off_policy_estimator": {}, "info": {"num_steps_trained": 429824, "num_steps_sampled": 438000, "sample_time_ms": 191294.927, "load_time_ms": 16.034, "grad_time_ms": 1233.574, "update_time_ms": 6.491, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5723.17919921875, "policy_loss": -0.018050162121653557, "vf_loss": 5723.19775390625, "vf_explained_var": 5.183012685705535e-09, "kl": 0.018560731783509254, "entropy": 10.866154670715332, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 438000, "episodes_total": 2190, "training_iteration": 73, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_00-36-21", "timestamp": 1606244781, "time_this_iter_s": 150.48365473747253, "time_total_s": 14956.363781452179, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14956.363781452179, "timesteps_since_restore": 438000, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 28.77803738317757, "ram_util_percent": 55.61915887850469}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -440.48300608544156, "episode_reward_min": -625.0295764193568, "episode_reward_mean": -527.25996111518, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.829708117716265, "mean_processing_ms": 6.348930990139247, "mean_inference_ms": 1.3074528257809217}, "off_policy_estimator": {}, "info": {"num_steps_trained": 435712, "num_steps_sampled": 444000, "sample_time_ms": 185990.853, "load_time_ms": 15.685, "grad_time_ms": 1168.163, "update_time_ms": 6.521, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5468.5322265625, "policy_loss": -0.013933919370174408, "vf_loss": 5468.54638671875, "vf_explained_var": -3.887259403256849e-09, "kl": 0.013450919650495052, "entropy": 10.928199768066406, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 444000, "episodes_total": 2220, "training_iteration": 74, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_00-38-52", "timestamp": 1606244932, "time_this_iter_s": 151.40897798538208, "time_total_s": 15107.772759437561, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 15107.772759437561, "timesteps_since_restore": 444000, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 28.699537037037036, "ram_util_percent": 55.708796296296306}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -440.48300608544156, "episode_reward_min": -634.751481202517, "episode_reward_mean": -526.7926036363825, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.60210294171267, "mean_processing_ms": 6.344687721205526, "mean_inference_ms": 1.3031294962576214}, "off_policy_estimator": {}, "info": {"num_steps_trained": 441600, "num_steps_sampled": 450000, "sample_time_ms": 180542.782, "load_time_ms": 12.466, "grad_time_ms": 1082.876, "update_time_ms": 6.259, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5810.7119140625, "policy_loss": -0.018141958862543106, "vf_loss": 5810.73046875, "vf_explained_var": 2.5915063428527674e-09, "kl": 0.014925604686141014, "entropy": 10.827191352844238, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 450000, "episodes_total": 2250, "training_iteration": 75, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_00-41-25", "timestamp": 1606245085, "time_this_iter_s": 153.3037588596344, "time_total_s": 15261.076518297195, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 15261.076518297195, "timesteps_since_restore": 450000, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 29.706849315068492, "ram_util_percent": 55.6744292237443}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -436.7112916221909, "episode_reward_min": -634.751481202517, "episode_reward_mean": -528.1337889468672, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.38229471103891, "mean_processing_ms": 6.340489347440662, "mean_inference_ms": 1.2989941609169424}, "off_policy_estimator": {}, "info": {"num_steps_trained": 447488, "num_steps_sampled": 456000, "sample_time_ms": 175551.579, "load_time_ms": 12.323, "grad_time_ms": 1025.578, "update_time_ms": 5.912, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5752.5029296875, "policy_loss": -0.020738590508699417, "vf_loss": 5752.52392578125, "vf_explained_var": -5.183012685705535e-09, "kl": 0.018258266150951385, "entropy": 10.678190231323242, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 456000, "episodes_total": 2280, "training_iteration": 76, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_00-43-58", "timestamp": 1606245238, "time_this_iter_s": 153.1274607181549, "time_total_s": 15414.20397901535, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 15414.20397901535, "timesteps_since_restore": 456000, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 28.848401826484018, "ram_util_percent": 55.78721461187214}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -436.7112916221909, "episode_reward_min": -646.0292490161696, "episode_reward_mean": -531.2642060269304, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.170066084428456, "mean_processing_ms": 6.336445375425995, "mean_inference_ms": 1.2949649680492894}, "off_policy_estimator": {}, "info": {"num_steps_trained": 453376, "num_steps_sampled": 462000, "sample_time_ms": 170386.432, "load_time_ms": 11.351, "grad_time_ms": 959.236, "update_time_ms": 5.581, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5865.45263671875, "policy_loss": -0.01614871807396412, "vf_loss": 5865.46826171875, "vf_explained_var": -1.5549037613027394e-08, "kl": 0.01511699240654707, "entropy": 10.870134353637695, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 462000, "episodes_total": 2310, "training_iteration": 77, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_00-46-30", "timestamp": 1606245390, "time_this_iter_s": 151.04724526405334, "time_total_s": 15565.251224279404, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 15565.251224279404, "timesteps_since_restore": 462000, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 28.519069767441863, "ram_util_percent": 55.88976744186046}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -436.7112916221909, "episode_reward_min": -646.0292490161696, "episode_reward_mean": -529.0212759453711, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 58.96086270855753, "mean_processing_ms": 6.332619050080123, "mean_inference_ms": 1.290994732899774}, "off_policy_estimator": {}, "info": {"num_steps_trained": 459264, "num_steps_sampled": 468000, "sample_time_ms": 165057.272, "load_time_ms": 11.535, "grad_time_ms": 893.45, "update_time_ms": 5.161, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5363.72314453125, "policy_loss": -0.022821094840765, "vf_loss": 5363.74609375, "vf_explained_var": 2.5915063428527674e-09, "kl": 0.017743105068802834, "entropy": 11.05595874786377, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 468000, "episodes_total": 2340, "training_iteration": 78, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_00-49-01", "timestamp": 1606245541, "time_this_iter_s": 151.18974423408508, "time_total_s": 15716.440968513489, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 15716.440968513489, "timesteps_since_restore": 468000, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 28.787037037037038, "ram_util_percent": 55.89629629629629}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -436.7112916221909, "episode_reward_min": -646.0292490161696, "episode_reward_mean": -527.5392785750674, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 58.755105382788976, "mean_processing_ms": 6.328822985158963, "mean_inference_ms": 1.2870004076692576}, "off_policy_estimator": {}, "info": {"num_steps_trained": 465152, "num_steps_sampled": 474000, "sample_time_ms": 159903.52, "load_time_ms": 10.945, "grad_time_ms": 828.805, "update_time_ms": 4.631, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5776.63671875, "policy_loss": -0.016079019755125046, "vf_loss": 5776.65234375, "vf_explained_var": 7.774518806513697e-09, "kl": 0.012224548496305943, "entropy": 10.848102569580078, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 474000, "episodes_total": 2370, "training_iteration": 79, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_00-51-32", "timestamp": 1606245692, "time_this_iter_s": 151.59361624717712, "time_total_s": 15868.034584760666, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 15868.034584760666, "timesteps_since_restore": 474000, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 28.77731481481481, "ram_util_percent": 55.96481481481482}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -464.2991241801991, "episode_reward_min": -646.0292490161696, "episode_reward_mean": -524.447048800758, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 58.55538806579521, "mean_processing_ms": 6.324919101338193, "mean_inference_ms": 1.2831166508552707}, "off_policy_estimator": {}, "info": {"num_steps_trained": 471040, "num_steps_sampled": 480000, "sample_time_ms": 154623.511, "load_time_ms": 11.18, "grad_time_ms": 828.23, "update_time_ms": 4.204, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5409.76904296875, "policy_loss": -0.015695828944444656, "vf_loss": 5409.78466796875, "vf_explained_var": 1.036602537141107e-08, "kl": 0.016414396464824677, "entropy": 10.826468467712402, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 480000, "episodes_total": 2400, "training_iteration": 80, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_00-54-05", "timestamp": 1606245845, "time_this_iter_s": 152.45174717903137, "time_total_s": 16020.486331939697, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16020.486331939697, "timesteps_since_restore": 480000, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 28.627188940092168, "ram_util_percent": 55.994470046082945}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -444.0437650086133, "episode_reward_min": -586.2410666175463, "episode_reward_mean": -528.1116414809537, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 58.36196760571281, "mean_processing_ms": 6.321091725414818, "mean_inference_ms": 1.279302273543618}, "off_policy_estimator": {}, "info": {"num_steps_trained": 476928, "num_steps_sampled": 486000, "sample_time_ms": 151234.835, "load_time_ms": 11.17, "grad_time_ms": 830.249, "update_time_ms": 3.945, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5801.28076171875, "policy_loss": -0.019867463037371635, "vf_loss": 5801.30029296875, "vf_explained_var": -6.478765524065011e-09, "kl": 0.014858859591186047, "entropy": 10.855977058410645, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 486000, "episodes_total": 2430, "training_iteration": 81, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_00-56-37", "timestamp": 1606245997, "time_this_iter_s": 151.6977961063385, "time_total_s": 16172.184128046036, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16172.184128046036, "timesteps_since_restore": 486000, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 28.868202764976957, "ram_util_percent": 55.98294930875576}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -444.0437650086133, "episode_reward_min": -627.6677757339035, "episode_reward_mean": -528.0739439031086, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 58.175442395456514, "mean_processing_ms": 6.317314972340173, "mean_inference_ms": 1.2756448311434492}, "off_policy_estimator": {}, "info": {"num_steps_trained": 482816, "num_steps_sampled": 492000, "sample_time_ms": 151368.819, "load_time_ms": 11.148, "grad_time_ms": 782.842, "update_time_ms": 3.945, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5692.54296875, "policy_loss": -0.016982080414891243, "vf_loss": 5692.5595703125, "vf_explained_var": 6.478765524065011e-09, "kl": 0.017623621970415115, "entropy": 10.923949241638184, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 492000, "episodes_total": 2460, "training_iteration": 82, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_00-59-12", "timestamp": 1606246152, "time_this_iter_s": 155.4111933708191, "time_total_s": 16327.595321416855, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16327.595321416855, "timesteps_since_restore": 492000, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 28.515315315315313, "ram_util_percent": 56.09369369369369}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -444.0437650086133, "episode_reward_min": -627.6677757339035, "episode_reward_mean": -532.4011896453658, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 57.99542596881302, "mean_processing_ms": 6.313718594859202, "mean_inference_ms": 1.2721667374684444}, "off_policy_estimator": {}, "info": {"num_steps_trained": 488704, "num_steps_sampled": 498000, "sample_time_ms": 151601.649, "load_time_ms": 14.768, "grad_time_ms": 715.401, "update_time_ms": 3.61, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5767.5126953125, "policy_loss": -0.01684424839913845, "vf_loss": 5767.529296875, "vf_explained_var": 0.0, "kl": 0.01864658296108246, "entropy": 11.166747093200684, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 498000, "episodes_total": 2490, "training_iteration": 83, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-01-44", "timestamp": 1606246304, "time_this_iter_s": 152.1669478416443, "time_total_s": 16479.7622692585, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16479.7622692585, "timesteps_since_restore": 498000, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 29.072811059907835, "ram_util_percent": 56.10000000000002}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -444.0437650086133, "episode_reward_min": -627.6677757339035, "episode_reward_mean": -531.6286087832874, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 57.82453649425952, "mean_processing_ms": 6.310346597929029, "mean_inference_ms": 1.2689131159695406}, "off_policy_estimator": {}, "info": {"num_steps_trained": 494592, "num_steps_sampled": 504000, "sample_time_ms": 152084.728, "load_time_ms": 14.8, "grad_time_ms": 713.746, "update_time_ms": 3.321, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5688.94384765625, "policy_loss": -0.017227156087756157, "vf_loss": 5688.9609375, "vf_explained_var": -1.2957531048130022e-08, "kl": 0.017398227006196976, "entropy": 10.966206550598145, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 504000, "episodes_total": 2520, "training_iteration": 84, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-04-20", "timestamp": 1606246460, "time_this_iter_s": 156.22067523002625, "time_total_s": 16635.982944488525, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16635.982944488525, "timesteps_since_restore": 504000, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 29.683856502242154, "ram_util_percent": 56.22690582959641}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -466.1264788986489, "episode_reward_min": -627.6677757339035, "episode_reward_mean": -536.3905335383581, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 57.663082485171465, "mean_processing_ms": 6.307313763570482, "mean_inference_ms": 1.2659336471500497}, "off_policy_estimator": {}, "info": {"num_steps_trained": 500480, "num_steps_sampled": 510000, "sample_time_ms": 152625.202, "load_time_ms": 15.475, "grad_time_ms": 779.532, "update_time_ms": 3.403, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5832.17724609375, "policy_loss": -0.015653017908334732, "vf_loss": 5832.1923828125, "vf_explained_var": -7.774518806513697e-09, "kl": 0.017142830416560173, "entropy": 11.126199722290039, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 510000, "episodes_total": 2550, "training_iteration": 85, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-07-00", "timestamp": 1606246620, "time_this_iter_s": 159.37471532821655, "time_total_s": 16795.357659816742, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16795.357659816742, "timesteps_since_restore": 510000, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 30.378414096916302, "ram_util_percent": 56.56431718061673}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -466.1264788986489, "episode_reward_min": -612.7503668709215, "episode_reward_mean": -535.8669638351994, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 57.50628435685289, "mean_processing_ms": 6.3043397843680395, "mean_inference_ms": 1.2629897254977793}, "off_policy_estimator": {}, "info": {"num_steps_trained": 506368, "num_steps_sampled": 516000, "sample_time_ms": 152681.167, "load_time_ms": 15.271, "grad_time_ms": 771.003, "update_time_ms": 3.388, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5668.9169921875, "policy_loss": -0.014949590899050236, "vf_loss": 5668.931640625, "vf_explained_var": -7.774518806513697e-09, "kl": 0.015201765112578869, "entropy": 11.01131534576416, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 516000, "episodes_total": 2580, "training_iteration": 86, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-09-33", "timestamp": 1606246773, "time_this_iter_s": 153.59984493255615, "time_total_s": 16948.957504749298, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16948.957504749298, "timesteps_since_restore": 516000, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 29.797260273972604, "ram_util_percent": 56.22922374429224}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -466.1264788986489, "episode_reward_min": -610.1979282689114, "episode_reward_mean": -535.922264156771, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 57.35464582874933, "mean_processing_ms": 6.301500787045668, "mean_inference_ms": 1.260174084008258}, "off_policy_estimator": {}, "info": {"num_steps_trained": 512256, "num_steps_sampled": 522000, "sample_time_ms": 153313.5, "load_time_ms": 15.654, "grad_time_ms": 828.814, "update_time_ms": 3.496, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5676.0712890625, "policy_loss": -0.021086350083351135, "vf_loss": 5676.09228515625, "vf_explained_var": 1.2957531714263837e-09, "kl": 0.023759473115205765, "entropy": 11.143538475036621, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 522000, "episodes_total": 2610, "training_iteration": 87, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-12-11", "timestamp": 1606246931, "time_this_iter_s": 157.95466566085815, "time_total_s": 17106.912170410156, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 17106.912170410156, "timesteps_since_restore": 522000, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 29.627111111111113, "ram_util_percent": 56.161777777777786}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -474.7616741409449, "episode_reward_min": -629.4218438561943, "episode_reward_mean": -537.019448049585, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 57.206483675989475, "mean_processing_ms": 6.298592590560205, "mean_inference_ms": 1.2572940762901685}, "off_policy_estimator": {}, "info": {"num_steps_trained": 518144, "num_steps_sampled": 528000, "sample_time_ms": 153859.923, "load_time_ms": 15.39, "grad_time_ms": 897.283, "update_time_ms": 3.557, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5805.58349609375, "policy_loss": -0.01919957809150219, "vf_loss": 5805.60400390625, "vf_explained_var": -1.684479045138687e-08, "kl": 0.015276028774678707, "entropy": 11.119063377380371, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 528000, "episodes_total": 2640, "training_iteration": 88, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-14-49", "timestamp": 1606247089, "time_this_iter_s": 157.34098052978516, "time_total_s": 17264.25315093994, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 17264.25315093994, "timesteps_since_restore": 528000, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 29.75511111111111, "ram_util_percent": 56.543111111111116}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -478.3159499674571, "episode_reward_min": -629.4218438561943, "episode_reward_mean": -538.1499917426104, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 57.062521191083526, "mean_processing_ms": 6.295721890492559, "mean_inference_ms": 1.254486440990576}, "off_policy_estimator": {}, "info": {"num_steps_trained": 524032, "num_steps_sampled": 534000, "sample_time_ms": 154373.655, "load_time_ms": 14.477, "grad_time_ms": 965.496, "update_time_ms": 3.983, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5936.2880859375, "policy_loss": -0.015943070873618126, "vf_loss": 5936.30517578125, "vf_explained_var": 2.5915063428527674e-09, "kl": 0.014741907827556133, "entropy": 11.161626815795898, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 534000, "episodes_total": 2670, "training_iteration": 89, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-17-26", "timestamp": 1606247246, "time_this_iter_s": 157.4121561050415, "time_total_s": 17421.665307044983, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 17421.665307044983, "timesteps_since_restore": 534000, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 29.661777777777775, "ram_util_percent": 56.84133333333334}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -456.91713123811263, "episode_reward_min": -635.3742675709765, "episode_reward_mean": -539.8156193714856, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 56.922455681750016, "mean_processing_ms": 6.292939033008065, "mean_inference_ms": 1.2516927158659648}, "off_policy_estimator": {}, "info": {"num_steps_trained": 529920, "num_steps_sampled": 540000, "sample_time_ms": 154887.704, "load_time_ms": 13.906, "grad_time_ms": 899.896, "update_time_ms": 4.454, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5729.1298828125, "policy_loss": -0.016180677339434624, "vf_loss": 5729.14599609375, "vf_explained_var": -1.036602537141107e-08, "kl": 0.01798391528427601, "entropy": 11.010235786437988, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 540000, "episodes_total": 2700, "training_iteration": 90, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-20-03", "timestamp": 1606247403, "time_this_iter_s": 156.93407440185547, "time_total_s": 17578.59938144684, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 17578.59938144684, "timesteps_since_restore": 540000, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 29.134529147982065, "ram_util_percent": 56.90896860986546}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -456.91713123811263, "episode_reward_min": -635.3742675709765, "episode_reward_mean": -545.355640535113, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 56.7855354079109, "mean_processing_ms": 6.2901711633811, "mean_inference_ms": 1.2489414753620534}, "off_policy_estimator": {}, "info": {"num_steps_trained": 535808, "num_steps_sampled": 546000, "sample_time_ms": 155527.278, "load_time_ms": 14.286, "grad_time_ms": 960.18, "update_time_ms": 4.336, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6140.12841796875, "policy_loss": -0.018561318516731262, "vf_loss": 6140.14697265625, "vf_explained_var": -2.5915063428527674e-09, "kl": 0.016008460894227028, "entropy": 11.0053071975708, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 546000, "episodes_total": 2730, "training_iteration": 91, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-22-42", "timestamp": 1606247562, "time_this_iter_s": 158.69894289970398, "time_total_s": 17737.298324346542, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 17737.298324346542, "timesteps_since_restore": 546000, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 28.890748898678417, "ram_util_percent": 57.02819383259912}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -441.1737609016434, "episode_reward_min": -635.3742675709765, "episode_reward_mean": -542.5326474503307, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 56.648728901356144, "mean_processing_ms": 6.287549100018982, "mean_inference_ms": 1.2462305059568604}, "off_policy_estimator": {}, "info": {"num_steps_trained": 541696, "num_steps_sampled": 552000, "sample_time_ms": 155419.74, "load_time_ms": 13.968, "grad_time_ms": 940.618, "update_time_ms": 4.341, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5751.2998046875, "policy_loss": -0.015361051075160503, "vf_loss": 5751.3154296875, "vf_explained_var": -1.1661778209770546e-08, "kl": 0.01913815550506115, "entropy": 10.924230575561523, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 552000, "episodes_total": 2760, "training_iteration": 92, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-25-16", "timestamp": 1606247716, "time_this_iter_s": 154.13675355911255, "time_total_s": 17891.435077905655, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 17891.435077905655, "timesteps_since_restore": 552000, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 28.744999999999997, "ram_util_percent": 57.05227272727273}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -441.1737609016434, "episode_reward_min": -641.1366013020021, "episode_reward_mean": -537.1642058556502, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 56.5124265240986, "mean_processing_ms": 6.285023619237465, "mean_inference_ms": 1.2435959636865115}, "off_policy_estimator": {}, "info": {"num_steps_trained": 547584, "num_steps_sampled": 558000, "sample_time_ms": 155630.985, "load_time_ms": 10.319, "grad_time_ms": 948.353, "update_time_ms": 4.418, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5478.07421875, "policy_loss": -0.018237486481666565, "vf_loss": 5478.09228515625, "vf_explained_var": -3.887259403256849e-09, "kl": 0.01729344204068184, "entropy": 11.021232604980469, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 558000, "episodes_total": 2790, "training_iteration": 93, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-27-50", "timestamp": 1606247870, "time_this_iter_s": 154.3214704990387, "time_total_s": 18045.756548404694, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 18045.756548404694, "timesteps_since_restore": 558000, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 28.79090909090909, "ram_util_percent": 57.154545454545456}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -431.8802721560124, "episode_reward_min": -641.1366013020021, "episode_reward_mean": -535.3403225337012, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 56.379571477851634, "mean_processing_ms": 6.282597583875177, "mean_inference_ms": 1.2410195937236017}, "off_policy_estimator": {}, "info": {"num_steps_trained": 553472, "num_steps_sampled": 564000, "sample_time_ms": 155637.891, "load_time_ms": 10.27, "grad_time_ms": 948.314, "update_time_ms": 4.414, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5581.73291015625, "policy_loss": -0.01495797373354435, "vf_loss": 5581.748046875, "vf_explained_var": -9.070271644873173e-09, "kl": 0.019909001886844635, "entropy": 11.090786933898926, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 564000, "episodes_total": 2820, "training_iteration": 94, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-30-27", "timestamp": 1606248027, "time_this_iter_s": 156.28879642486572, "time_total_s": 18202.04534482956, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 18202.04534482956, "timesteps_since_restore": 564000, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 28.690134529147976, "ram_util_percent": 57.36053811659191}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -431.8802721560124, "episode_reward_min": -641.1366013020021, "episode_reward_mean": -533.8028015886186, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 56.2546530922516, "mean_processing_ms": 6.281290536355711, "mean_inference_ms": 1.2386275501941177}, "off_policy_estimator": {}, "info": {"num_steps_trained": 559360, "num_steps_sampled": 570000, "sample_time_ms": 155907.094, "load_time_ms": 10.129, "grad_time_ms": 924.199, "update_time_ms": 4.378, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5696.3017578125, "policy_loss": -0.018669066950678825, "vf_loss": 5696.32080078125, "vf_explained_var": 5.183012685705535e-09, "kl": 0.014288211241364479, "entropy": 10.963918685913086, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 570000, "episodes_total": 2850, "training_iteration": 95, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-33-08", "timestamp": 1606248188, "time_this_iter_s": 161.82681918144226, "time_total_s": 18363.872164011, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 18363.872164011, "timesteps_since_restore": 570000, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 31.25844155844156, "ram_util_percent": 57.52727272727273}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -431.8802721560124, "episode_reward_min": -623.9440152159141, "episode_reward_mean": -534.1074417910409, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 56.133448279853745, "mean_processing_ms": 6.2798562151734085, "mean_inference_ms": 1.2362534799545843}, "off_policy_estimator": {}, "info": {"num_steps_trained": 565248, "num_steps_sampled": 576000, "sample_time_ms": 156110.297, "load_time_ms": 10.003, "grad_time_ms": 923.166, "update_time_ms": 4.66, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5569.36279296875, "policy_loss": -0.013118076138198376, "vf_loss": 5569.37548828125, "vf_explained_var": -1.2957531714263837e-09, "kl": 0.016814757138490677, "entropy": 10.756241798400879, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 576000, "episodes_total": 2880, "training_iteration": 96, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-35-44", "timestamp": 1606248344, "time_this_iter_s": 155.62362957000732, "time_total_s": 18519.49579358101, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 18519.49579358101, "timesteps_since_restore": 576000, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 28.701351351351356, "ram_util_percent": 57.62747747747749}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -431.8802721560124, "episode_reward_min": -623.9440152159141, "episode_reward_mean": -533.4927189900677, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 56.016765866190326, "mean_processing_ms": 6.278235427682171, "mean_inference_ms": 1.2339507827889464}, "off_policy_estimator": {}, "info": {"num_steps_trained": 571136, "num_steps_sampled": 582000, "sample_time_ms": 155948.209, "load_time_ms": 9.61, "grad_time_ms": 864.096, "update_time_ms": 4.552, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5458.2333984375, "policy_loss": -0.01750369369983673, "vf_loss": 5458.25048828125, "vf_explained_var": -1.1661778209770546e-08, "kl": 0.017316902056336403, "entropy": 11.045214653015137, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 582000, "episodes_total": 2910, "training_iteration": 97, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-38-20", "timestamp": 1606248500, "time_this_iter_s": 155.73680353164673, "time_total_s": 18675.232597112656, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 18675.232597112656, "timesteps_since_restore": 582000, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 28.895045045045045, "ram_util_percent": 57.74504504504503}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -457.3653047817522, "episode_reward_min": -623.9440152159141, "episode_reward_mean": -526.8522364546444, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 55.89614428939603, "mean_processing_ms": 6.275971188946155, "mean_inference_ms": 1.2315557250266338}, "off_policy_estimator": {}, "info": {"num_steps_trained": 577024, "num_steps_sampled": 588000, "sample_time_ms": 155576.764, "load_time_ms": 9.584, "grad_time_ms": 862.873, "update_time_ms": 4.417, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5152.21435546875, "policy_loss": -0.018641525879502296, "vf_loss": 5152.23291015625, "vf_explained_var": 7.774518806513697e-09, "kl": 0.01437691505998373, "entropy": 10.620049476623535, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 588000, "episodes_total": 2940, "training_iteration": 98, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-40-53", "timestamp": 1606248653, "time_this_iter_s": 153.6131308078766, "time_total_s": 18828.845727920532, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 18828.845727920532, "timesteps_since_restore": 588000, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 28.88264840182648, "ram_util_percent": 57.760273972602754}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -437.5819079590545, "episode_reward_min": -615.5731881049704, "episode_reward_mean": -524.355118580092, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 55.77565379053755, "mean_processing_ms": 6.2734537717970875, "mean_inference_ms": 1.2292270850209597}, "off_policy_estimator": {}, "info": {"num_steps_trained": 582912, "num_steps_sampled": 594000, "sample_time_ms": 155408.345, "load_time_ms": 9.266, "grad_time_ms": 818.941, "update_time_ms": 4.373, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5359.5107421875, "policy_loss": -0.02140912413597107, "vf_loss": 5359.53173828125, "vf_explained_var": -3.887259403256849e-09, "kl": 0.015309751965105534, "entropy": 10.924836158752441, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 594000, "episodes_total": 2970, "training_iteration": 99, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-43-29", "timestamp": 1606248809, "time_this_iter_s": 155.2846348285675, "time_total_s": 18984.1303627491, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 18984.1303627491, "timesteps_since_restore": 594000, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 28.818468468468467, "ram_util_percent": 57.88873873873874}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -437.5819079590545, "episode_reward_min": -617.7522353222331, "episode_reward_mean": -525.786808230833, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 55.65769806894498, "mean_processing_ms": 6.271184432734315, "mean_inference_ms": 1.2270542980910302}, "off_policy_estimator": {}, "info": {"num_steps_trained": 588800, "num_steps_sampled": 600000, "sample_time_ms": 155448.124, "load_time_ms": 9.597, "grad_time_ms": 884.835, "update_time_ms": 4.253, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5521.49365234375, "policy_loss": -0.018376395106315613, "vf_loss": 5521.5126953125, "vf_explained_var": -6.478765524065011e-09, "kl": 0.023247532546520233, "entropy": 10.822436332702637, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 600000, "episodes_total": 3000, "training_iteration": 100, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-46-07", "timestamp": 1606248967, "time_this_iter_s": 157.9963412284851, "time_total_s": 19142.126703977585, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19142.126703977585, "timesteps_since_restore": 600000, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 28.930666666666664, "ram_util_percent": 58.021777777777785}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -437.5819079590545, "episode_reward_min": -626.5174382063675, "episode_reward_mean": -527.9373364337911, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 55.542264067474996, "mean_processing_ms": 6.269043444505712, "mean_inference_ms": 1.2249678790223617}, "off_policy_estimator": {}, "info": {"num_steps_trained": 594688, "num_steps_sampled": 606000, "sample_time_ms": 155182.793, "load_time_ms": 9.554, "grad_time_ms": 836.591, "update_time_ms": 4.658, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5412.5830078125, "policy_loss": -0.015561932697892189, "vf_loss": 5412.599609375, "vf_explained_var": 1.1661778209770546e-08, "kl": 0.013228300958871841, "entropy": 10.744609832763672, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 606000, "episodes_total": 3030, "training_iteration": 101, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-48-42", "timestamp": 1606249122, "time_this_iter_s": 155.56830644607544, "time_total_s": 19297.69501042366, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19297.69501042366, "timesteps_since_restore": 606000, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 28.688288288288287, "ram_util_percent": 57.910810810810794}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -437.5819079590545, "episode_reward_min": -626.5174382063675, "episode_reward_mean": -529.9868802632684, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 55.43008139165111, "mean_processing_ms": 6.2669025597750725, "mean_inference_ms": 1.2228892742756967}, "off_policy_estimator": {}, "info": {"num_steps_trained": 600576, "num_steps_sampled": 612000, "sample_time_ms": 155309.436, "load_time_ms": 9.657, "grad_time_ms": 834.388, "update_time_ms": 4.656, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5582.8955078125, "policy_loss": -0.017626479268074036, "vf_loss": 5582.91357421875, "vf_explained_var": 2.5915063428527674e-09, "kl": 0.021155640482902527, "entropy": 10.709685325622559, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 612000, "episodes_total": 3060, "training_iteration": 102, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-51-18", "timestamp": 1606249278, "time_this_iter_s": 155.38257694244385, "time_total_s": 19453.077587366104, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19453.077587366104, "timesteps_since_restore": 612000, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 28.97837837837838, "ram_util_percent": 57.945945945945944}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -456.9686901335181, "episode_reward_min": -626.5174382063675, "episode_reward_mean": -531.443206074613, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 55.31809817561199, "mean_processing_ms": 6.264851005349825, "mean_inference_ms": 1.2207235329405846}, "off_policy_estimator": {}, "info": {"num_steps_trained": 606464, "num_steps_sampled": 618000, "sample_time_ms": 155251.779, "load_time_ms": 10.042, "grad_time_ms": 835.529, "update_time_ms": 4.674, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5348.0341796875, "policy_loss": -0.015917113050818443, "vf_loss": 5348.05029296875, "vf_explained_var": 0.0, "kl": 0.019293997436761856, "entropy": 10.660406112670898, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 618000, "episodes_total": 3090, "training_iteration": 103, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-53-52", "timestamp": 1606249432, "time_this_iter_s": 153.75992155075073, "time_total_s": 19606.837508916855, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19606.837508916855, "timesteps_since_restore": 618000, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 28.875799086757997, "ram_util_percent": 58.00136986301369}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -447.5520215695334, "episode_reward_min": -620.0462970398373, "episode_reward_mean": -528.7630491342394, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 55.20933038221979, "mean_processing_ms": 6.262906139624689, "mean_inference_ms": 1.2185983246607301}, "off_policy_estimator": {}, "info": {"num_steps_trained": 612352, "num_steps_sampled": 624000, "sample_time_ms": 155209.596, "load_time_ms": 10.099, "grad_time_ms": 833.339, "update_time_ms": 4.711, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5333.32421875, "policy_loss": -0.0186575036495924, "vf_loss": 5333.34375, "vf_explained_var": 0.0, "kl": 0.02016405016183853, "entropy": 10.74565601348877, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 624000, "episodes_total": 3120, "training_iteration": 104, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-56-27", "timestamp": 1606249587, "time_this_iter_s": 155.84632802009583, "time_total_s": 19762.68383693695, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19762.68383693695, "timesteps_since_restore": 624000, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 28.786486486486485, "ram_util_percent": 57.99099099099098}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -447.5520215695334, "episode_reward_min": -612.635675154807, "episode_reward_mean": -532.1201569992776, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 55.102959425890155, "mean_processing_ms": 6.261158153025088, "mean_inference_ms": 1.216524292395524}, "off_policy_estimator": {}, "info": {"num_steps_trained": 618240, "num_steps_sampled": 630000, "sample_time_ms": 154588.141, "load_time_ms": 9.583, "grad_time_ms": 787.694, "update_time_ms": 4.723, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5677.6005859375, "policy_loss": -0.017623554915189743, "vf_loss": 5677.61767578125, "vf_explained_var": 3.887259403256849e-09, "kl": 0.022409366443753242, "entropy": 10.474861145019531, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 630000, "episodes_total": 3150, "training_iteration": 105, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_01-59-03", "timestamp": 1606249743, "time_this_iter_s": 155.14731335639954, "time_total_s": 19917.83115029335, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19917.83115029335, "timesteps_since_restore": 630000, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 28.874774774774778, "ram_util_percent": 58.087387387387395}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -447.5520215695334, "episode_reward_min": -612.635675154807, "episode_reward_mean": -531.690376100036, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 54.99990330629601, "mean_processing_ms": 6.2593775205734055, "mean_inference_ms": 1.214542328087039}, "off_policy_estimator": {}, "info": {"num_steps_trained": 624128, "num_steps_sampled": 636000, "sample_time_ms": 154557.462, "load_time_ms": 9.788, "grad_time_ms": 803.116, "update_time_ms": 4.437, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5437.19287109375, "policy_loss": -0.017852788791060448, "vf_loss": 5437.2109375, "vf_explained_var": -1.036602537141107e-08, "kl": 0.01937166601419449, "entropy": 10.84655475616455, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 636000, "episodes_total": 3180, "training_iteration": 106, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-01-38", "timestamp": 1606249898, "time_this_iter_s": 155.46972012519836, "time_total_s": 20073.30087041855, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 20073.30087041855, "timesteps_since_restore": 636000, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 28.90990990990991, "ram_util_percent": 58.21486486486487}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -447.5520215695334, "episode_reward_min": -612.635675154807, "episode_reward_mean": -534.7761868695982, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 54.89910807252473, "mean_processing_ms": 6.257605262287647, "mean_inference_ms": 1.212598274541919}, "off_policy_estimator": {}, "info": {"num_steps_trained": 630016, "num_steps_sampled": 642000, "sample_time_ms": 154574.543, "load_time_ms": 10.178, "grad_time_ms": 871.021, "update_time_ms": 4.472, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5498.333984375, "policy_loss": -0.01380318496376276, "vf_loss": 5498.34716796875, "vf_explained_var": -6.478765524065011e-09, "kl": 0.015068402513861656, "entropy": 10.696913719177246, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 642000, "episodes_total": 3210, "training_iteration": 107, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-04-15", "timestamp": 1606250055, "time_this_iter_s": 156.59496903419495, "time_total_s": 20229.895839452744, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 20229.895839452744, "timesteps_since_restore": 642000, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 28.76143497757848, "ram_util_percent": 58.2188340807175}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -468.49823401151053, "episode_reward_min": -612.635675154807, "episode_reward_mean": -534.1873887803785, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 54.80048423901537, "mean_processing_ms": 6.255752612858273, "mean_inference_ms": 1.2107290491121234}, "off_policy_estimator": {}, "info": {"num_steps_trained": 635904, "num_steps_sampled": 648000, "sample_time_ms": 154920.753, "load_time_ms": 10.359, "grad_time_ms": 870.364, "update_time_ms": 4.865, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5455.2021484375, "policy_loss": -0.022985616698861122, "vf_loss": 5455.22509765625, "vf_explained_var": -6.478765524065011e-09, "kl": 0.01745724119246006, "entropy": 10.291293144226074, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 648000, "episodes_total": 3240, "training_iteration": 108, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-06-52", "timestamp": 1606250212, "time_this_iter_s": 157.0733289718628, "time_total_s": 20386.969168424606, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 20386.969168424606, "timesteps_since_restore": 648000, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 28.885267857142853, "ram_util_percent": 58.3111607142857}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -468.3062709571623, "episode_reward_min": -610.3111391655186, "episode_reward_mean": -532.6052608508566, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 54.70157085273482, "mean_processing_ms": 6.253953743858321, "mean_inference_ms": 1.2088417877334348}, "off_policy_estimator": {}, "info": {"num_steps_trained": 641792, "num_steps_sampled": 654000, "sample_time_ms": 154708.378, "load_time_ms": 10.35, "grad_time_ms": 844.758, "update_time_ms": 4.767, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5320.52734375, "policy_loss": -0.01934242621064186, "vf_loss": 5320.54833984375, "vf_explained_var": -1.4253284774667918e-08, "kl": 0.012769236229360104, "entropy": 10.765291213989258, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 654000, "episodes_total": 3270, "training_iteration": 109, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-09-25", "timestamp": 1606250365, "time_this_iter_s": 152.90018701553345, "time_total_s": 20539.86935544014, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 20539.86935544014, "timesteps_since_restore": 654000, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 28.775229357798164, "ram_util_percent": 58.42798165137614}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -462.3411950432746, "episode_reward_min": -601.0653991279544, "episode_reward_mean": -526.0580390379716, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 54.605571719016346, "mean_processing_ms": 6.252187974545768, "mean_inference_ms": 1.207013287256}, "off_policy_estimator": {}, "info": {"num_steps_trained": 647680, "num_steps_sampled": 660000, "sample_time_ms": 154741.411, "load_time_ms": 10.345, "grad_time_ms": 787.444, "update_time_ms": 4.512, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4949.6357421875, "policy_loss": -0.018138675019145012, "vf_loss": 4949.6533203125, "vf_explained_var": -2.073205074282214e-08, "kl": 0.020221618935465813, "entropy": 10.581563949584961, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 660000, "episodes_total": 3300, "training_iteration": 110, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-12-03", "timestamp": 1606250523, "time_this_iter_s": 157.74738073349, "time_total_s": 20697.61673617363, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 20697.61673617363, "timesteps_since_restore": 660000, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 28.626222222222225, "ram_util_percent": 58.4151111111111}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -462.3411950432746, "episode_reward_min": -612.6640169577782, "episode_reward_mean": -526.3413679049994, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 54.51234044927419, "mean_processing_ms": 6.25058856743349, "mean_inference_ms": 1.205211610957364}, "off_policy_estimator": {}, "info": {"num_steps_trained": 653568, "num_steps_sampled": 666000, "sample_time_ms": 155020.971, "load_time_ms": 10.35, "grad_time_ms": 822.094, "update_time_ms": 4.116, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5491.35791015625, "policy_loss": -0.022233305498957634, "vf_loss": 5491.38037109375, "vf_explained_var": -6.478765524065011e-09, "kl": 0.017407584935426712, "entropy": 10.51987361907959, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 666000, "episodes_total": 3330, "training_iteration": 111, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-14-41", "timestamp": 1606250681, "time_this_iter_s": 158.7057535648346, "time_total_s": 20856.322489738464, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 20856.322489738464, "timesteps_since_restore": 666000, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 28.782378854625552, "ram_util_percent": 58.60088105726873}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -462.3411950432746, "episode_reward_min": -612.6640169577782, "episode_reward_mean": -523.4897118034258, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 54.421177406936984, "mean_processing_ms": 6.248982646658536, "mean_inference_ms": 1.2034099094614228}, "off_policy_estimator": {}, "info": {"num_steps_trained": 659456, "num_steps_sampled": 672000, "sample_time_ms": 154916.842, "load_time_ms": 11.168, "grad_time_ms": 892.55, "update_time_ms": 4.102, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5125.81396484375, "policy_loss": -0.020660657435655594, "vf_loss": 5125.83447265625, "vf_explained_var": 3.887259403256849e-09, "kl": 0.02058279886841774, "entropy": 10.459210395812988, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 672000, "episodes_total": 3360, "training_iteration": 112, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-17-16", "timestamp": 1606250836, "time_this_iter_s": 155.0571677684784, "time_total_s": 21011.379657506943, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21011.379657506943, "timesteps_since_restore": 672000, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 29.011312217194572, "ram_util_percent": 58.62036199095024}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -426.19795418239636, "episode_reward_min": -612.6640169577782, "episode_reward_mean": -522.1143965458377, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 54.332285474121825, "mean_processing_ms": 6.2474068292525, "mean_inference_ms": 1.2016605800679223}, "off_policy_estimator": {}, "info": {"num_steps_trained": 665344, "num_steps_sampled": 678000, "sample_time_ms": 155109.065, "load_time_ms": 10.446, "grad_time_ms": 886.557, "update_time_ms": 4.314, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4860.86669921875, "policy_loss": -0.018799256533384323, "vf_loss": 4860.88525390625, "vf_explained_var": 1.1661778209770546e-08, "kl": 0.0166702251881361, "entropy": 10.164822578430176, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 678000, "episodes_total": 3390, "training_iteration": 113, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-19-52", "timestamp": 1606250992, "time_this_iter_s": 155.61691451072693, "time_total_s": 21166.99657201767, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21166.99657201767, "timesteps_since_restore": 678000, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 28.869819819819817, "ram_util_percent": 58.57882882882884}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -426.19795418239636, "episode_reward_min": -612.6640169577782, "episode_reward_mean": -517.0971445112715, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 54.243517613869756, "mean_processing_ms": 6.24570544600514, "mean_inference_ms": 1.1999005552956217}, "off_policy_estimator": {}, "info": {"num_steps_trained": 671232, "num_steps_sampled": 684000, "sample_time_ms": 154965.728, "load_time_ms": 10.703, "grad_time_ms": 956.049, "update_time_ms": 4.221, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4885.5205078125, "policy_loss": -0.016932770609855652, "vf_loss": 4885.53662109375, "vf_explained_var": -7.774518806513697e-09, "kl": 0.01695026457309723, "entropy": 9.937094688415527, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 684000, "episodes_total": 3420, "training_iteration": 114, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-22-27", "timestamp": 1606251147, "time_this_iter_s": 155.11286211013794, "time_total_s": 21322.109434127808, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21322.109434127808, "timesteps_since_restore": 684000, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 28.942533936651586, "ram_util_percent": 58.63303167420816}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -426.19795418239636, "episode_reward_min": -607.1269466875508, "episode_reward_mean": -514.0905289344006, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 54.156169824669966, "mean_processing_ms": 6.243917451935347, "mean_inference_ms": 1.1981780208843307}, "off_policy_estimator": {}, "info": {"num_steps_trained": 677120, "num_steps_sampled": 690000, "sample_time_ms": 154995.131, "load_time_ms": 11.049, "grad_time_ms": 1023.972, "update_time_ms": 4.425, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5084.986328125, "policy_loss": -0.019727706909179688, "vf_loss": 5085.00537109375, "vf_explained_var": 1.1661778209770546e-08, "kl": 0.022925112396478653, "entropy": 10.071332931518555, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 690000, "episodes_total": 3450, "training_iteration": 115, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-25-03", "timestamp": 1606251303, "time_this_iter_s": 156.129741191864, "time_total_s": 21478.23917531967, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21478.23917531967, "timesteps_since_restore": 690000, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 29.00896860986547, "ram_util_percent": 58.74618834080717}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -433.1111198004057, "episode_reward_min": -607.1269466875508, "episode_reward_mean": -517.5350938808482, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 54.071102384096555, "mean_processing_ms": 6.242223782262016, "mean_inference_ms": 1.1964696654831959}, "off_policy_estimator": {}, "info": {"num_steps_trained": 683008, "num_steps_sampled": 696000, "sample_time_ms": 154983.733, "load_time_ms": 10.843, "grad_time_ms": 1010.08, "update_time_ms": 4.773, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5191.17041015625, "policy_loss": -0.015445658937096596, "vf_loss": 5191.18505859375, "vf_explained_var": -2.5915063428527674e-09, "kl": 0.024141428992152214, "entropy": 9.998167991638184, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 696000, "episodes_total": 3480, "training_iteration": 116, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-27-39", "timestamp": 1606251459, "time_this_iter_s": 155.2178511619568, "time_total_s": 21633.45702648163, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21633.45702648163, "timesteps_since_restore": 696000, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 28.969819819819815, "ram_util_percent": 58.70765765765765}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -447.32257973447224, "episode_reward_min": -607.1269466875508, "episode_reward_mean": -515.0527056174426, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 53.98722430931244, "mean_processing_ms": 6.240546189943655, "mean_inference_ms": 1.1947949478550262}, "off_policy_estimator": {}, "info": {"num_steps_trained": 688896, "num_steps_sampled": 702000, "sample_time_ms": 154848.974, "load_time_ms": 10.456, "grad_time_ms": 942.431, "update_time_ms": 4.809, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4852.072265625, "policy_loss": -0.020357845351099968, "vf_loss": 4852.09228515625, "vf_explained_var": -5.183012685705535e-09, "kl": 0.022020209580659866, "entropy": 10.267545700073242, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 702000, "episodes_total": 3510, "training_iteration": 117, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-30-13", "timestamp": 1606251613, "time_this_iter_s": 154.56326818466187, "time_total_s": 21788.02029466629, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21788.02029466629, "timesteps_since_restore": 702000, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 28.91227272727273, "ram_util_percent": 58.87363636363635}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -447.76764912388455, "episode_reward_min": -607.1269466875508, "episode_reward_mean": -514.8735960239749, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 53.90451012168595, "mean_processing_ms": 6.2390227872538, "mean_inference_ms": 1.193180765158341}, "off_policy_estimator": {}, "info": {"num_steps_trained": 694784, "num_steps_sampled": 708000, "sample_time_ms": 154728.015, "load_time_ms": 9.919, "grad_time_ms": 875.967, "update_time_ms": 4.478, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4928.93408203125, "policy_loss": -0.022448653355240822, "vf_loss": 4928.95703125, "vf_explained_var": 1.2957531714263837e-09, "kl": 0.015144838020205498, "entropy": 10.173810005187988, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 708000, "episodes_total": 3540, "training_iteration": 118, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-32-48", "timestamp": 1606251768, "time_this_iter_s": 155.18704104423523, "time_total_s": 21943.207335710526, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21943.207335710526, "timesteps_since_restore": 708000, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 28.988687782805428, "ram_util_percent": 58.905429864253385}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -453.7235310444371, "episode_reward_min": -591.8092528659037, "episode_reward_mean": -510.71398542139053, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 53.823116380371594, "mean_processing_ms": 6.237529294788428, "mean_inference_ms": 1.1916022508638806}, "off_policy_estimator": {}, "info": {"num_steps_trained": 700672, "num_steps_sampled": 714000, "sample_time_ms": 155136.113, "load_time_ms": 10.25, "grad_time_ms": 915.957, "update_time_ms": 4.243, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4858.45703125, "policy_loss": -0.018215518444776535, "vf_loss": 4858.47607421875, "vf_explained_var": -3.887259403256849e-09, "kl": 0.021551968529820442, "entropy": 10.041584014892578, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 714000, "episodes_total": 3570, "training_iteration": 119, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-35-26", "timestamp": 1606251926, "time_this_iter_s": 157.38246726989746, "time_total_s": 22100.589802980423, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 22100.589802980423, "timesteps_since_restore": 714000, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 28.75022222222222, "ram_util_percent": 58.95822222222222}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -457.95652310399925, "episode_reward_min": -577.0424755123978, "episode_reward_mean": -510.0685446775687, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 53.74362292845681, "mean_processing_ms": 6.236160396072457, "mean_inference_ms": 1.1900750453084417}, "off_policy_estimator": {}, "info": {"num_steps_trained": 706560, "num_steps_sampled": 720000, "sample_time_ms": 155040.023, "load_time_ms": 9.928, "grad_time_ms": 905.045, "update_time_ms": 4.146, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4837.03271484375, "policy_loss": -0.020208943635225296, "vf_loss": 4837.052734375, "vf_explained_var": -2.5915063428527674e-09, "kl": 0.017763294279575348, "entropy": 9.930551528930664, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 720000, "episodes_total": 3600, "training_iteration": 120, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-38-02", "timestamp": 1606252082, "time_this_iter_s": 156.67286705970764, "time_total_s": 22257.26267004013, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 22257.26267004013, "timesteps_since_restore": 720000, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 28.716517857142858, "ram_util_percent": 59.05446428571429}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -457.95652310399925, "episode_reward_min": -585.6962881736565, "episode_reward_mean": -511.9053163575165, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 53.66532373957606, "mean_processing_ms": 6.234825578337922, "mean_inference_ms": 1.1885636097144185}, "off_policy_estimator": {}, "info": {"num_steps_trained": 712448, "num_steps_sampled": 726000, "sample_time_ms": 155022.38, "load_time_ms": 10.997, "grad_time_ms": 880.15, "update_time_ms": 4.144, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4962.40869140625, "policy_loss": -0.014666343107819557, "vf_loss": 4962.4228515625, "vf_explained_var": -5.183012685705535e-09, "kl": 0.01651597023010254, "entropy": 10.294087409973145, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 726000, "episodes_total": 3630, "training_iteration": 121, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-40-41", "timestamp": 1606252241, "time_this_iter_s": 158.29407453536987, "time_total_s": 22415.5567445755, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 22415.5567445755, "timesteps_since_restore": 726000, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 28.442666666666668, "ram_util_percent": 59.13600000000001}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -457.95652310399925, "episode_reward_min": -585.6962881736565, "episode_reward_mean": -512.7168304093433, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 53.587422352048264, "mean_processing_ms": 6.233515950329936, "mean_inference_ms": 1.187077379573663}, "off_policy_estimator": {}, "info": {"num_steps_trained": 718336, "num_steps_sampled": 732000, "sample_time_ms": 155244.597, "load_time_ms": 12.692, "grad_time_ms": 810.688, "update_time_ms": 4.513, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5030.08349609375, "policy_loss": -0.015353995375335217, "vf_loss": 5030.09912109375, "vf_explained_var": 5.183012685705535e-09, "kl": 0.015748152509331703, "entropy": 10.117878913879395, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 732000, "episodes_total": 3660, "training_iteration": 122, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-43-17", "timestamp": 1606252397, "time_this_iter_s": 156.60167050361633, "time_total_s": 22572.158415079117, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 22572.158415079117, "timesteps_since_restore": 732000, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 28.902232142857144, "ram_util_percent": 59.16071428571429}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -432.6898287182694, "episode_reward_min": -604.0062676078484, "episode_reward_mean": -516.2338524965571, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 53.50947833212176, "mean_processing_ms": 6.232265532587539, "mean_inference_ms": 1.1855824470548466}, "off_policy_estimator": {}, "info": {"num_steps_trained": 724224, "num_steps_sampled": 738000, "sample_time_ms": 155025.804, "load_time_ms": 13.549, "grad_time_ms": 874.742, "update_time_ms": 4.179, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4978.49365234375, "policy_loss": -0.018205691128969193, "vf_loss": 4978.51171875, "vf_explained_var": 0.0, "kl": 0.022229578346014023, "entropy": 10.311883926391602, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 738000, "episodes_total": 3690, "training_iteration": 123, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-45-51", "timestamp": 1606252551, "time_this_iter_s": 154.0789954662323, "time_total_s": 22726.23741054535, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 22726.23741054535, "timesteps_since_restore": 738000, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 29.005454545454544, "ram_util_percent": 59.18454545454546}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -432.6898287182694, "episode_reward_min": -612.6751001271057, "episode_reward_mean": -519.4757265184741, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 53.43366749365936, "mean_processing_ms": 6.230888601535018, "mean_inference_ms": 1.184140495948726}, "off_policy_estimator": {}, "info": {"num_steps_trained": 730112, "num_steps_sampled": 744000, "sample_time_ms": 155239.755, "load_time_ms": 13.878, "grad_time_ms": 873.581, "update_time_ms": 4.668, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5072.98095703125, "policy_loss": -0.023257704451680183, "vf_loss": 5073.00390625, "vf_explained_var": 1.2957531714263837e-09, "kl": 0.023666996508836746, "entropy": 10.757780075073242, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 744000, "episodes_total": 3720, "training_iteration": 124, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-48-29", "timestamp": 1606252709, "time_this_iter_s": 157.24999594688416, "time_total_s": 22883.487406492233, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 22883.487406492233, "timesteps_since_restore": 744000, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 28.909375, "ram_util_percent": 59.159375000000004}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -432.6898287182694, "episode_reward_min": -612.6751001271057, "episode_reward_mean": -516.104610666878, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 53.35859435108312, "mean_processing_ms": 6.229575754243609, "mean_inference_ms": 1.18275629743894}, "off_policy_estimator": {}, "info": {"num_steps_trained": 736000, "num_steps_sampled": 750000, "sample_time_ms": 155414.673, "load_time_ms": 14.108, "grad_time_ms": 805.004, "update_time_ms": 4.753, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4911.908203125, "policy_loss": -0.01656864397227764, "vf_loss": 4911.9248046875, "vf_explained_var": -2.5915063428527674e-09, "kl": 0.015478949062526226, "entropy": 10.369590759277344, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 750000, "episodes_total": 3750, "training_iteration": 125, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-51-06", "timestamp": 1606252866, "time_this_iter_s": 157.1928951740265, "time_total_s": 23040.68030166626, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23040.68030166626, "timesteps_since_restore": 750000, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 28.692857142857147, "ram_util_percent": 59.17767857142858}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -454.06628164218245, "episode_reward_min": -612.6751001271057, "episode_reward_mean": -520.4355712457962, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 53.28546755821668, "mean_processing_ms": 6.228494348784168, "mean_inference_ms": 1.1814158239347028}, "off_policy_estimator": {}, "info": {"num_steps_trained": 741888, "num_steps_sampled": 756000, "sample_time_ms": 155427.279, "load_time_ms": 14.749, "grad_time_ms": 872.224, "update_time_ms": 4.36, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5279.3740234375, "policy_loss": -0.019175315275788307, "vf_loss": 5279.3935546875, "vf_explained_var": -5.183012685705535e-09, "kl": 0.01670050248503685, "entropy": 10.159521102905273, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 756000, "episodes_total": 3780, "training_iteration": 126, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-53-42", "timestamp": 1606253022, "time_this_iter_s": 156.0229504108429, "time_total_s": 23196.703252077103, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23196.703252077103, "timesteps_since_restore": 756000, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 29.142600896860984, "ram_util_percent": 59.28206278026905}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -454.06628164218245, "episode_reward_min": -609.6431311376829, "episode_reward_mean": -518.151753676367, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 53.213771251349314, "mean_processing_ms": 6.227498375228013, "mean_inference_ms": 1.180054524333404}, "off_policy_estimator": {}, "info": {"num_steps_trained": 747776, "num_steps_sampled": 762000, "sample_time_ms": 155487.167, "load_time_ms": 15.677, "grad_time_ms": 940.251, "update_time_ms": 4.621, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4871.21484375, "policy_loss": -0.02234252355992794, "vf_loss": 4871.2373046875, "vf_explained_var": -6.478765524065011e-09, "kl": 0.024744132533669472, "entropy": 10.339582443237305, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 762000, "episodes_total": 3810, "training_iteration": 127, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-56-18", "timestamp": 1606253178, "time_this_iter_s": 155.85682916641235, "time_total_s": 23352.560081243515, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23352.560081243515, "timesteps_since_restore": 762000, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 28.90945945945946, "ram_util_percent": 59.29009009009008}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -457.6762848966899, "episode_reward_min": -609.6431311376829, "episode_reward_mean": -520.3660004140908, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 53.14412081175472, "mean_processing_ms": 6.226574576139374, "mean_inference_ms": 1.178665524244058}, "off_policy_estimator": {}, "info": {"num_steps_trained": 753664, "num_steps_sampled": 768000, "sample_time_ms": 155626.403, "load_time_ms": 15.79, "grad_time_ms": 941.074, "update_time_ms": 4.632, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5099.9765625, "policy_loss": -0.02324739284813404, "vf_loss": 5099.9990234375, "vf_explained_var": 1.2957531714263837e-09, "kl": 0.017503710463643074, "entropy": 10.403786659240723, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 768000, "episodes_total": 3840, "training_iteration": 128, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_02-58-55", "timestamp": 1606253335, "time_this_iter_s": 156.58906388282776, "time_total_s": 23509.149145126343, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23509.149145126343, "timesteps_since_restore": 768000, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 28.81517857142857, "ram_util_percent": 59.30848214285714}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -449.280021137314, "episode_reward_min": -592.835966896656, "episode_reward_mean": -518.08978570237, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 53.07496437450591, "mean_processing_ms": 6.225622676037299, "mean_inference_ms": 1.1773170418503083}, "off_policy_estimator": {}, "info": {"num_steps_trained": 759552, "num_steps_sampled": 774000, "sample_time_ms": 155491.772, "load_time_ms": 15.609, "grad_time_ms": 903.941, "update_time_ms": 4.518, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4923.41796875, "policy_loss": -0.02033829316496849, "vf_loss": 4923.4375, "vf_explained_var": 5.183012685705535e-09, "kl": 0.01834213174879551, "entropy": 10.693865776062012, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 774000, "episodes_total": 3870, "training_iteration": 129, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-01-30", "timestamp": 1606253490, "time_this_iter_s": 155.66189169883728, "time_total_s": 23664.81103682518, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23664.81103682518, "timesteps_since_restore": 774000, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 28.864864864864863, "ram_util_percent": 59.43828828828828}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -409.5627188646285, "episode_reward_min": -621.4321494928456, "episode_reward_mean": -517.1280513139308, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 53.0071339225896, "mean_processing_ms": 6.224650622824927, "mean_inference_ms": 1.1760172425915194}, "off_policy_estimator": {}, "info": {"num_steps_trained": 765440, "num_steps_sampled": 780000, "sample_time_ms": 155349.66, "load_time_ms": 16.263, "grad_time_ms": 904.908, "update_time_ms": 4.529, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4920.53076171875, "policy_loss": -0.02535760961472988, "vf_loss": 4920.556640625, "vf_explained_var": 1.2957531714263837e-09, "kl": 0.02436852641403675, "entropy": 10.451658248901367, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 780000, "episodes_total": 3900, "training_iteration": 130, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-04-06", "timestamp": 1606253646, "time_this_iter_s": 155.26856207847595, "time_total_s": 23820.079598903656, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23820.079598903656, "timesteps_since_restore": 780000, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 28.736199095022627, "ram_util_percent": 59.42488687782805}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -409.5627188646285, "episode_reward_min": -621.4321494928456, "episode_reward_mean": -513.6672991841798, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.93958534967956, "mean_processing_ms": 6.223569775709348, "mean_inference_ms": 1.1747459916384704}, "off_policy_estimator": {}, "info": {"num_steps_trained": 771328, "num_steps_sampled": 786000, "sample_time_ms": 155080.264, "load_time_ms": 15.569, "grad_time_ms": 895.965, "update_time_ms": 4.54, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4696.330078125, "policy_loss": -0.022901732474565506, "vf_loss": 4696.35302734375, "vf_explained_var": 1.2957531714263837e-09, "kl": 0.020413989201188087, "entropy": 10.261197090148926, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 786000, "episodes_total": 3930, "training_iteration": 131, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-06-41", "timestamp": 1606253801, "time_this_iter_s": 155.50088167190552, "time_total_s": 23975.58048057556, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23975.58048057556, "timesteps_since_restore": 786000, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 28.777477477477476, "ram_util_percent": 59.50495495495497}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -409.5627188646285, "episode_reward_min": -621.4321494928456, "episode_reward_mean": -511.1897633664501, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.87277124764296, "mean_processing_ms": 6.222221929245209, "mean_inference_ms": 1.1734631001599738}, "off_policy_estimator": {}, "info": {"num_steps_trained": 777216, "num_steps_sampled": 792000, "sample_time_ms": 154880.825, "load_time_ms": 13.087, "grad_time_ms": 897.337, "update_time_ms": 4.295, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4946.6044921875, "policy_loss": -0.015041258186101913, "vf_loss": 4946.6201171875, "vf_explained_var": 0.0, "kl": 0.01886582560837269, "entropy": 10.465596199035645, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 792000, "episodes_total": 3960, "training_iteration": 132, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-09-16", "timestamp": 1606253956, "time_this_iter_s": 154.5942838191986, "time_total_s": 24130.17476439476, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24130.17476439476, "timesteps_since_restore": 792000, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 29.006334841628963, "ram_util_percent": 59.5262443438914}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -456.8714089877747, "episode_reward_min": -601.53710043584, "episode_reward_mean": -509.9881827416497, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.80725869709846, "mean_processing_ms": 6.220921464017854, "mean_inference_ms": 1.1722225679444862}, "off_policy_estimator": {}, "info": {"num_steps_trained": 783104, "num_steps_sampled": 798000, "sample_time_ms": 155312.913, "load_time_ms": 12.993, "grad_time_ms": 845.639, "update_time_ms": 4.337, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4876.36767578125, "policy_loss": -0.02088296040892601, "vf_loss": 4876.38818359375, "vf_explained_var": -3.887259403256849e-09, "kl": 0.01803390309214592, "entropy": 10.217144966125488, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 798000, "episodes_total": 3990, "training_iteration": 133, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-11-54", "timestamp": 1606254114, "time_this_iter_s": 157.87923526763916, "time_total_s": 24288.0539996624, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24288.0539996624, "timesteps_since_restore": 798000, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 28.681333333333335, "ram_util_percent": 59.48177777777778}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -458.79925336974947, "episode_reward_min": -606.154883297935, "episode_reward_mean": -518.9912037571619, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.74475306955366, "mean_processing_ms": 6.219593875857836, "mean_inference_ms": 1.1710049552308603}, "off_policy_estimator": {}, "info": {"num_steps_trained": 788992, "num_steps_sampled": 804000, "sample_time_ms": 155435.323, "load_time_ms": 12.462, "grad_time_ms": 778.452, "update_time_ms": 3.905, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5270.59912109375, "policy_loss": -0.009509749710559845, "vf_loss": 5270.60888671875, "vf_explained_var": 6.478765524065011e-09, "kl": 0.01698281243443489, "entropy": 10.64898681640625, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 804000, "episodes_total": 4020, "training_iteration": 134, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-14-31", "timestamp": 1606254271, "time_this_iter_s": 157.78837823867798, "time_total_s": 24445.842377901077, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24445.842377901077, "timesteps_since_restore": 804000, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 28.902222222222218, "ram_util_percent": 59.62355555555556}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -438.6399486762994, "episode_reward_min": -606.154883297935, "episode_reward_mean": -518.4430878558873, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.683328343277346, "mean_processing_ms": 6.218402222588286, "mean_inference_ms": 1.169802858702192}, "off_policy_estimator": {}, "info": {"num_steps_trained": 794880, "num_steps_sampled": 810000, "sample_time_ms": 155216.475, "load_time_ms": 12.024, "grad_time_ms": 783.611, "update_time_ms": 3.501, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4990.666015625, "policy_loss": -0.015931515023112297, "vf_loss": 4990.68212890625, "vf_explained_var": 1.2957531714263837e-09, "kl": 0.02529495395720005, "entropy": 10.600759506225586, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 810000, "episodes_total": 4050, "training_iteration": 135, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-17-07", "timestamp": 1606254427, "time_this_iter_s": 155.0478162765503, "time_total_s": 24600.890194177628, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24600.890194177628, "timesteps_since_restore": 810000, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 28.9262443438914, "ram_util_percent": 59.704524886877834}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -438.6399486762994, "episode_reward_min": -606.154883297935, "episode_reward_mean": -523.8299699744124, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.62288862831043, "mean_processing_ms": 6.217314528887255, "mean_inference_ms": 1.1685928103477117}, "off_policy_estimator": {}, "info": {"num_steps_trained": 800768, "num_steps_sampled": 816000, "sample_time_ms": 155192.754, "load_time_ms": 11.999, "grad_time_ms": 727.239, "update_time_ms": 3.588, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5094.8388671875, "policy_loss": -0.022181900218129158, "vf_loss": 5094.86083984375, "vf_explained_var": -5.183012685705535e-09, "kl": 0.02342539280653, "entropy": 11.15389347076416, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 816000, "episodes_total": 4080, "training_iteration": 136, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-19-42", "timestamp": 1606254582, "time_this_iter_s": 155.21886324882507, "time_total_s": 24756.109057426453, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24756.109057426453, "timesteps_since_restore": 816000, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 28.9981981981982, "ram_util_percent": 59.70945945945946}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -438.6399486762994, "episode_reward_min": -606.154883297935, "episode_reward_mean": -524.1577428714436, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.56225656411803, "mean_processing_ms": 6.216141914977544, "mean_inference_ms": 1.1673747633050287}, "off_policy_estimator": {}, "info": {"num_steps_trained": 806656, "num_steps_sampled": 822000, "sample_time_ms": 155148.345, "load_time_ms": 11.705, "grad_time_ms": 727.512, "update_time_ms": 3.242, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5139.43017578125, "policy_loss": -0.023032769560813904, "vf_loss": 5139.45361328125, "vf_explained_var": -1.2957531048130022e-08, "kl": 0.02321554347872734, "entropy": 10.890828132629395, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 822000, "episodes_total": 4110, "training_iteration": 137, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-22-17", "timestamp": 1606254737, "time_this_iter_s": 155.4118857383728, "time_total_s": 24911.520943164825, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24911.520943164825, "timesteps_since_restore": 822000, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 29.063513513513517, "ram_util_percent": 59.809909909909905}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -438.6399486762994, "episode_reward_min": -607.0045673195269, "episode_reward_mean": -522.5257829269239, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.5023524894619, "mean_processing_ms": 6.215065410663029, "mean_inference_ms": 1.166193926507656}, "off_policy_estimator": {}, "info": {"num_steps_trained": 812544, "num_steps_sampled": 828000, "sample_time_ms": 155240.273, "load_time_ms": 11.755, "grad_time_ms": 728.134, "update_time_ms": 3.499, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4992.9482421875, "policy_loss": -0.025550764054059982, "vf_loss": 4992.9736328125, "vf_explained_var": -1.5549037613027394e-08, "kl": 0.02304825745522976, "entropy": 10.752041816711426, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 828000, "episodes_total": 4140, "training_iteration": 138, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-24-55", "timestamp": 1606254895, "time_this_iter_s": 157.51742577552795, "time_total_s": 25069.038368940353, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25069.038368940353, "timesteps_since_restore": 828000, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 28.533035714285713, "ram_util_percent": 59.88928571428571}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -458.54068176473197, "episode_reward_min": -607.0045673195269, "episode_reward_mean": -525.2761906372989, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.443865419682794, "mean_processing_ms": 6.214005683264784, "mean_inference_ms": 1.1650706926866412}, "off_policy_estimator": {}, "info": {"num_steps_trained": 818432, "num_steps_sampled": 834000, "sample_time_ms": 155250.855, "load_time_ms": 11.759, "grad_time_ms": 727.963, "update_time_ms": 3.531, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5275.98046875, "policy_loss": -0.019207334145903587, "vf_loss": 5275.99951171875, "vf_explained_var": -2.5915063428527674e-09, "kl": 0.02113797329366207, "entropy": 11.004197120666504, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 834000, "episodes_total": 4170, "training_iteration": 139, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-27-31", "timestamp": 1606255051, "time_this_iter_s": 155.76645255088806, "time_total_s": 25224.80482149124, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25224.80482149124, "timesteps_since_restore": 834000, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 29.10990990990991, "ram_util_percent": 59.868468468468464}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -458.54068176473197, "episode_reward_min": -607.0045673195269, "episode_reward_mean": -522.4010187569643, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.387049430912754, "mean_processing_ms": 6.212878521530112, "mean_inference_ms": 1.163968573597577}, "off_policy_estimator": {}, "info": {"num_steps_trained": 824320, "num_steps_sampled": 840000, "sample_time_ms": 155343.661, "load_time_ms": 11.244, "grad_time_ms": 779.293, "update_time_ms": 3.546, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5033.1513671875, "policy_loss": -0.022735154256224632, "vf_loss": 5033.17333984375, "vf_explained_var": -6.478765524065011e-09, "kl": 0.022914467379450798, "entropy": 10.911175727844238, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 840000, "episodes_total": 4200, "training_iteration": 140, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-30-07", "timestamp": 1606255207, "time_this_iter_s": 156.70917534828186, "time_total_s": 25381.513996839523, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25381.513996839523, "timesteps_since_restore": 840000, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 29.002232142857142, "ram_util_percent": 59.956696428571426}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -465.71427256359226, "episode_reward_min": -607.0045673195269, "episode_reward_mean": -523.5927380931628, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.33028019960463, "mean_processing_ms": 6.211726539225482, "mean_inference_ms": 1.1628697925731124}, "off_policy_estimator": {}, "info": {"num_steps_trained": 830208, "num_steps_sampled": 846000, "sample_time_ms": 155371.874, "load_time_ms": 11.174, "grad_time_ms": 832.188, "update_time_ms": 3.834, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4994.63134765625, "policy_loss": -0.01996917463839054, "vf_loss": 4994.6513671875, "vf_explained_var": -2.332355641954109e-08, "kl": 0.022426266223192215, "entropy": 11.42894458770752, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 846000, "episodes_total": 4230, "training_iteration": 141, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-32-44", "timestamp": 1606255364, "time_this_iter_s": 156.3181974887848, "time_total_s": 25537.832194328308, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25537.832194328308, "timesteps_since_restore": 846000, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 28.923766816143498, "ram_util_percent": 59.97982062780271}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -466.7259118700978, "episode_reward_min": -588.673076533306, "episode_reward_mean": -520.9969483160038, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.27267761393516, "mean_processing_ms": 6.210408364680314, "mean_inference_ms": 1.1617647253364114}, "off_policy_estimator": {}, "info": {"num_steps_trained": 836096, "num_steps_sampled": 852000, "sample_time_ms": 155341.473, "load_time_ms": 11.986, "grad_time_ms": 898.245, "update_time_ms": 4.056, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4943.71044921875, "policy_loss": -0.020679766312241554, "vf_loss": 4943.73095703125, "vf_explained_var": 5.183012685705535e-09, "kl": 0.0185414869338274, "entropy": 11.075263977050781, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 852000, "episodes_total": 4260, "training_iteration": 142, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-35-19", "timestamp": 1606255519, "time_this_iter_s": 154.96541666984558, "time_total_s": 25692.797610998154, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25692.797610998154, "timesteps_since_restore": 852000, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 28.866968325791856, "ram_util_percent": 59.88461538461538}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -466.7259118700978, "episode_reward_min": -588.673076533306, "episode_reward_mean": -521.9300667487123, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.21543996512057, "mean_processing_ms": 6.2090863987933185, "mean_inference_ms": 1.160643932432352}, "off_policy_estimator": {}, "info": {"num_steps_trained": 841984, "num_steps_sampled": 858000, "sample_time_ms": 155139.385, "load_time_ms": 11.838, "grad_time_ms": 950.13, "update_time_ms": 4.403, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5106.27978515625, "policy_loss": -0.01566028781235218, "vf_loss": 5106.2958984375, "vf_explained_var": -1.2957531714263837e-09, "kl": 0.026850661262869835, "entropy": 11.143438339233398, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 858000, "episodes_total": 4290, "training_iteration": 143, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-37-55", "timestamp": 1606255675, "time_this_iter_s": 156.3824965953827, "time_total_s": 25849.180107593536, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25849.180107593536, "timesteps_since_restore": 858000, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 28.77354260089686, "ram_util_percent": 59.99372197309418}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -470.56348159984157, "episode_reward_min": -588.673076533306, "episode_reward_mean": -523.4494539822452, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.15978061332772, "mean_processing_ms": 6.207926368344911, "mean_inference_ms": 1.1595704377553397}, "off_policy_estimator": {}, "info": {"num_steps_trained": 847872, "num_steps_sampled": 864000, "sample_time_ms": 155081.624, "load_time_ms": 13.362, "grad_time_ms": 950.496, "update_time_ms": 4.74, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5140.0966796875, "policy_loss": -0.020271804183721542, "vf_loss": 5140.11669921875, "vf_explained_var": 2.5915063428527674e-09, "kl": 0.02062542736530304, "entropy": 11.592901229858398, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 864000, "episodes_total": 4320, "training_iteration": 144, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-40-32", "timestamp": 1606255832, "time_this_iter_s": 157.23236346244812, "time_total_s": 26006.412471055984, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 26006.412471055984, "timesteps_since_restore": 864000, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 28.753777777777778, "ram_util_percent": 60.28088888888889}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -454.12895327822235, "episode_reward_min": -585.2070299382282, "episode_reward_mean": -520.5532158499107, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.10437089494454, "mean_processing_ms": 6.2069775526773086, "mean_inference_ms": 1.15856779721199}, "off_policy_estimator": {}, "info": {"num_steps_trained": 853760, "num_steps_sampled": 870000, "sample_time_ms": 155088.723, "load_time_ms": 13.268, "grad_time_ms": 945.818, "update_time_ms": 4.753, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4813.2001953125, "policy_loss": -0.02310461923480034, "vf_loss": 4813.2236328125, "vf_explained_var": 1.4253284774667918e-08, "kl": 0.02187277376651764, "entropy": 11.142807960510254, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 870000, "episodes_total": 4350, "training_iteration": 145, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-43-07", "timestamp": 1606255987, "time_this_iter_s": 155.07082986831665, "time_total_s": 26161.4833009243, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 26161.4833009243, "timesteps_since_restore": 870000, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 28.750678733031677, "ram_util_percent": 60.309502262443445}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -454.12895327822235, "episode_reward_min": -585.2070299382282, "episode_reward_mean": -520.9141448048454, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.05139399502767, "mean_processing_ms": 6.206182480157143, "mean_inference_ms": 1.1576296148780907}, "off_policy_estimator": {}, "info": {"num_steps_trained": 859648, "num_steps_sampled": 876000, "sample_time_ms": 155339.009, "load_time_ms": 12.726, "grad_time_ms": 934.63, "update_time_ms": 4.712, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5104.23828125, "policy_loss": -0.024903660640120506, "vf_loss": 5104.26318359375, "vf_explained_var": 1.2957531714263837e-09, "kl": 0.03484140336513519, "entropy": 10.887709617614746, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 876000, "episodes_total": 4380, "training_iteration": 146, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-45-45", "timestamp": 1606256145, "time_this_iter_s": 157.60347533226013, "time_total_s": 26319.08677625656, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 26319.08677625656, "timesteps_since_restore": 876000, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 29.066666666666666, "ram_util_percent": 60.420444444444435}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -454.12895327822235, "episode_reward_min": -602.7671935682766, "episode_reward_mean": -521.2017824264773, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.999546243766744, "mean_processing_ms": 6.205431976233731, "mean_inference_ms": 1.15671187513955}, "off_policy_estimator": {}, "info": {"num_steps_trained": 865536, "num_steps_sampled": 882000, "sample_time_ms": 155374.653, "load_time_ms": 12.714, "grad_time_ms": 933.267, "update_time_ms": 4.783, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5193.4228515625, "policy_loss": -0.016556963324546814, "vf_loss": 5193.439453125, "vf_explained_var": -1.9436297904462663e-08, "kl": 0.02144610323011875, "entropy": 11.376912117004395, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 882000, "episodes_total": 4410, "training_iteration": 147, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-48-21", "timestamp": 1606256301, "time_this_iter_s": 155.75405430793762, "time_total_s": 26474.8408305645, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 26474.8408305645, "timesteps_since_restore": 882000, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 28.76621621621622, "ram_util_percent": 60.4}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -462.3269211459569, "episode_reward_min": -602.7671935682766, "episode_reward_mean": -525.1277298969335, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.950037494300005, "mean_processing_ms": 6.204652953859761, "mean_inference_ms": 1.155746963389171}, "off_policy_estimator": {}, "info": {"num_steps_trained": 871424, "num_steps_sampled": 888000, "sample_time_ms": 155324.025, "load_time_ms": 12.578, "grad_time_ms": 933.699, "update_time_ms": 4.777, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5133.830078125, "policy_loss": -0.01785394363105297, "vf_loss": 5133.8486328125, "vf_explained_var": -1.2957531048130022e-08, "kl": 0.023573551326990128, "entropy": 10.874704360961914, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 888000, "episodes_total": 4440, "training_iteration": 148, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-50-58", "timestamp": 1606256458, "time_this_iter_s": 157.0138955116272, "time_total_s": 26631.854726076126, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 26631.854726076126, "timesteps_since_restore": 888000, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 28.924553571428568, "ram_util_percent": 60.43035714285713}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -444.8832505866364, "episode_reward_min": -602.7671935682766, "episode_reward_mean": -528.2589386087107, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.90102462570117, "mean_processing_ms": 6.203956057787241, "mean_inference_ms": 1.1547897176302218}, "off_policy_estimator": {}, "info": {"num_steps_trained": 877312, "num_steps_sampled": 894000, "sample_time_ms": 155418.727, "load_time_ms": 12.881, "grad_time_ms": 998.103, "update_time_ms": 4.762, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5218.478515625, "policy_loss": -0.019005727022886276, "vf_loss": 5218.4970703125, "vf_explained_var": 5.183012685705535e-09, "kl": 0.020092850551009178, "entropy": 11.401679039001465, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 894000, "episodes_total": 4470, "training_iteration": 149, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-53-35", "timestamp": 1606256615, "time_this_iter_s": 157.363849401474, "time_total_s": 26789.2185754776, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 26789.2185754776, "timesteps_since_restore": 894000, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 29.043999999999997, "ram_util_percent": 60.50933333333334}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -444.8832505866364, "episode_reward_min": -601.9569145349315, "episode_reward_mean": -529.8924743386293, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.85250619728868, "mean_processing_ms": 6.203070360826096, "mean_inference_ms": 1.1537624013678311}, "off_policy_estimator": {}, "info": {"num_steps_trained": 883200, "num_steps_sampled": 900000, "sample_time_ms": 155313.244, "load_time_ms": 13.191, "grad_time_ms": 1015.113, "update_time_ms": 5.206, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5231.40966796875, "policy_loss": -0.019320456311106682, "vf_loss": 5231.42919921875, "vf_explained_var": -3.887259403256849e-09, "kl": 0.03147047013044357, "entropy": 11.728389739990234, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 900000, "episodes_total": 4500, "training_iteration": 150, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-56-11", "timestamp": 1606256771, "time_this_iter_s": 155.8310992717743, "time_total_s": 26945.049674749374, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 26945.049674749374, "timesteps_since_restore": 900000, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 29.027927927927923, "ram_util_percent": 60.54234234234234}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -444.8832505866364, "episode_reward_min": -602.4634365826436, "episode_reward_mean": -529.3687228404797, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.80443899840729, "mean_processing_ms": 6.202160543634896, "mean_inference_ms": 1.152783350956515}, "off_policy_estimator": {}, "info": {"num_steps_trained": 889088, "num_steps_sampled": 906000, "sample_time_ms": 155393.482, "load_time_ms": 13.003, "grad_time_ms": 1014.62, "update_time_ms": 5.236, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5248.06689453125, "policy_loss": -0.017343565821647644, "vf_loss": 5248.08447265625, "vf_explained_var": -7.774518806513697e-09, "kl": 0.023481905460357666, "entropy": 11.613775253295898, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 906000, "episodes_total": 4530, "training_iteration": 151, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_03-58-48", "timestamp": 1606256928, "time_this_iter_s": 157.11304235458374, "time_total_s": 27102.162717103958, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 27102.162717103958, "timesteps_since_restore": 906000, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 29.13482142857143, "ram_util_percent": 60.63660714285715}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -444.8832505866364, "episode_reward_min": -602.4634365826436, "episode_reward_mean": -526.848503834417, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.75550103371503, "mean_processing_ms": 6.201199774764688, "mean_inference_ms": 1.1518303265692935}, "off_policy_estimator": {}, "info": {"num_steps_trained": 894976, "num_steps_sampled": 912000, "sample_time_ms": 155569.755, "load_time_ms": 12.202, "grad_time_ms": 947.249, "update_time_ms": 5.252, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5091.36572265625, "policy_loss": -0.017039118334650993, "vf_loss": 5091.3818359375, "vf_explained_var": -9.070271644873173e-09, "kl": 0.024982618167996407, "entropy": 11.419334411621094, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 912000, "episodes_total": 4560, "training_iteration": 152, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-01-24", "timestamp": 1606257084, "time_this_iter_s": 156.04184699058533, "time_total_s": 27258.204564094543, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 27258.204564094543, "timesteps_since_restore": 912000, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 28.87354260089686, "ram_util_percent": 60.74529147982063}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -457.2368377275218, "episode_reward_min": -612.3279781012528, "episode_reward_mean": -527.3013882805016, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.70755794792287, "mean_processing_ms": 6.200282599110812, "mean_inference_ms": 1.150910646776165}, "off_policy_estimator": {}, "info": {"num_steps_trained": 900864, "num_steps_sampled": 918000, "sample_time_ms": 155632.319, "load_time_ms": 12.192, "grad_time_ms": 947.522, "update_time_ms": 4.973, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5161.7158203125, "policy_loss": -0.02120121568441391, "vf_loss": 5161.73828125, "vf_explained_var": -3.887259403256849e-09, "kl": 0.015927651897072792, "entropy": 11.00946044921875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 918000, "episodes_total": 4590, "training_iteration": 153, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-04-01", "timestamp": 1606257241, "time_this_iter_s": 157.00784420967102, "time_total_s": 27415.212408304214, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 27415.212408304214, "timesteps_since_restore": 918000, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 29.021874999999998, "ram_util_percent": 60.761160714285715}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -457.2368377275218, "episode_reward_min": -612.3279781012528, "episode_reward_mean": -526.9678530400929, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.66098587590005, "mean_processing_ms": 6.199488960054944, "mean_inference_ms": 1.149996975598352}, "off_policy_estimator": {}, "info": {"num_steps_trained": 906752, "num_steps_sampled": 924000, "sample_time_ms": 155639.039, "load_time_ms": 11.222, "grad_time_ms": 982.091, "update_time_ms": 4.941, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5242.80419921875, "policy_loss": -0.024578221142292023, "vf_loss": 5242.82861328125, "vf_explained_var": 0.0, "kl": 0.025290699675679207, "entropy": 11.18137264251709, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 924000, "episodes_total": 4620, "training_iteration": 154, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-06-39", "timestamp": 1606257399, "time_this_iter_s": 157.63586854934692, "time_total_s": 27572.84827685356, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 27572.84827685356, "timesteps_since_restore": 924000, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 29.159555555555553, "ram_util_percent": 60.819111111111106}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -448.55031358214507, "episode_reward_min": -612.3279781012528, "episode_reward_mean": -524.772754650958, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.61551310809545, "mean_processing_ms": 6.198735619868418, "mean_inference_ms": 1.1490721372984334}, "off_policy_estimator": {}, "info": {"num_steps_trained": 912640, "num_steps_sampled": 930000, "sample_time_ms": 155890.415, "load_time_ms": 11.423, "grad_time_ms": 1014.158, "update_time_ms": 4.947, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4999.7158203125, "policy_loss": -0.022373948246240616, "vf_loss": 4999.7392578125, "vf_explained_var": -6.478765524065011e-09, "kl": 0.019971448928117752, "entropy": 10.863433837890625, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 930000, "episodes_total": 4650, "training_iteration": 155, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-09-17", "timestamp": 1606257557, "time_this_iter_s": 157.91132068634033, "time_total_s": 27730.7595975399, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 27730.7595975399, "timesteps_since_restore": 930000, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 28.716, "ram_util_percent": 60.99022222222222}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -448.55031358214507, "episode_reward_min": -612.3279781012528, "episode_reward_mean": -524.3508973356737, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.57125549794491, "mean_processing_ms": 6.197848489328315, "mean_inference_ms": 1.1481603897615218}, "off_policy_estimator": {}, "info": {"num_steps_trained": 918528, "num_steps_sampled": 936000, "sample_time_ms": 155688.544, "load_time_ms": 12.221, "grad_time_ms": 1013.173, "update_time_ms": 5.286, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5024.3037109375, "policy_loss": -0.02558697760105133, "vf_loss": 5024.32958984375, "vf_explained_var": -3.6281086579492694e-08, "kl": 0.025026816874742508, "entropy": 11.32699966430664, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 936000, "episodes_total": 4680, "training_iteration": 156, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-11-53", "timestamp": 1606257713, "time_this_iter_s": 155.58643579483032, "time_total_s": 27886.346033334732, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 27886.346033334732, "timesteps_since_restore": 936000, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 29.17387387387387, "ram_util_percent": 59.23963963963963}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -448.55031358214507, "episode_reward_min": -602.6263601681561, "episode_reward_mean": -518.3481619544903, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.525816308579586, "mean_processing_ms": 6.196959796613682, "mean_inference_ms": 1.1472674247870258}, "off_policy_estimator": {}, "info": {"num_steps_trained": 924416, "num_steps_sampled": 942000, "sample_time_ms": 155712.721, "load_time_ms": 11.905, "grad_time_ms": 945.359, "update_time_ms": 5.273, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4798.20361328125, "policy_loss": -0.0176811832934618, "vf_loss": 4798.2216796875, "vf_explained_var": -1.684479045138687e-08, "kl": 0.026137398555874825, "entropy": 10.851171493530273, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 942000, "episodes_total": 4710, "training_iteration": 157, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-14-28", "timestamp": 1606257868, "time_this_iter_s": 155.31106567382812, "time_total_s": 28041.65709900856, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 28041.65709900856, "timesteps_since_restore": 942000, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 29.10633484162896, "ram_util_percent": 58.34343891402714}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -463.64498557364874, "episode_reward_min": -602.6263601681561, "episode_reward_mean": -518.8604767383817, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.48081933906473, "mean_processing_ms": 6.196184050343323, "mean_inference_ms": 1.14639409292649}, "off_policy_estimator": {}, "info": {"num_steps_trained": 930304, "num_steps_sampled": 948000, "sample_time_ms": 155674.871, "load_time_ms": 12.401, "grad_time_ms": 1009.637, "update_time_ms": 4.993, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5026.9794921875, "policy_loss": -0.017330443486571312, "vf_loss": 5026.99609375, "vf_explained_var": -9.070271644873173e-09, "kl": 0.021953733637928963, "entropy": 11.334343910217285, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 948000, "episodes_total": 4740, "training_iteration": 158, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-17-05", "timestamp": 1606258025, "time_this_iter_s": 157.28406381607056, "time_total_s": 28198.94116282463, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 28198.94116282463, "timesteps_since_restore": 948000, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 28.83511111111111, "ram_util_percent": 58.312000000000005}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -463.64498557364874, "episode_reward_min": -601.3258781907654, "episode_reward_mean": -518.87863253675, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.43540840424951, "mean_processing_ms": 6.195533612853349, "mean_inference_ms": 1.145502917724626}, "off_policy_estimator": {}, "info": {"num_steps_trained": 936192, "num_steps_sampled": 954000, "sample_time_ms": 155529.427, "load_time_ms": 12.963, "grad_time_ms": 1009.702, "update_time_ms": 5.325, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5074.98291015625, "policy_loss": -0.018014168366789818, "vf_loss": 5075.00146484375, "vf_explained_var": -1.1661778209770546e-08, "kl": 0.021048124879598618, "entropy": 11.317791938781738, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 954000, "episodes_total": 4770, "training_iteration": 159, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-19-41", "timestamp": 1606258181, "time_this_iter_s": 155.91882038116455, "time_total_s": 28354.859983205795, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 28354.859983205795, "timesteps_since_restore": 954000, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 29.09189189189189, "ram_util_percent": 58.33783783783783}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -468.6675518707825, "episode_reward_min": -601.3258781907654, "episode_reward_mean": -522.833956969143, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.39084853728468, "mean_processing_ms": 6.194787235991653, "mean_inference_ms": 1.1446397956847825}, "off_policy_estimator": {}, "info": {"num_steps_trained": 942080, "num_steps_sampled": 960000, "sample_time_ms": 155789.669, "load_time_ms": 12.673, "grad_time_ms": 940.195, "update_time_ms": 5.386, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5126.72802734375, "policy_loss": -0.023847360163927078, "vf_loss": 5126.75146484375, "vf_explained_var": -2.5915063428527674e-09, "kl": 0.024539437144994736, "entropy": 11.3655366897583, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 960000, "episodes_total": 4800, "training_iteration": 160, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-22-19", "timestamp": 1606258339, "time_this_iter_s": 157.7326362133026, "time_total_s": 28512.592619419098, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 28512.592619419098, "timesteps_since_restore": 960000, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 28.727555555555554, "ram_util_percent": 58.44311111111111}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -468.6675518707825, "episode_reward_min": -601.3258781907654, "episode_reward_mean": -528.3271537415926, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.34797323925896, "mean_processing_ms": 6.1938876745048255, "mean_inference_ms": 1.1437631295699708}, "off_policy_estimator": {}, "info": {"num_steps_trained": 947968, "num_steps_sampled": 966000, "sample_time_ms": 155750.919, "load_time_ms": 12.867, "grad_time_ms": 940.106, "update_time_ms": 5.068, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5371.90576171875, "policy_loss": -0.022895600646734238, "vf_loss": 5371.9287109375, "vf_explained_var": -3.887259403256849e-09, "kl": 0.020096754655241966, "entropy": 11.84669017791748, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 966000, "episodes_total": 4830, "training_iteration": 161, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-24-56", "timestamp": 1606258496, "time_this_iter_s": 156.7248821258545, "time_total_s": 28669.317501544952, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 28669.317501544952, "timesteps_since_restore": 966000, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 29.207142857142856, "ram_util_percent": 58.487946428571426}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -467.77824198848197, "episode_reward_min": -595.3783006839263, "episode_reward_mean": -529.2462473150646, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.3056123363189, "mean_processing_ms": 6.192995889541703, "mean_inference_ms": 1.142918938693983}, "off_policy_estimator": {}, "info": {"num_steps_trained": 953856, "num_steps_sampled": 972000, "sample_time_ms": 155855.253, "load_time_ms": 13.122, "grad_time_ms": 939.416, "update_time_ms": 5.172, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5064.55517578125, "policy_loss": -0.024534914642572403, "vf_loss": 5064.57958984375, "vf_explained_var": -3.887259403256849e-09, "kl": 0.031157398596405983, "entropy": 11.763824462890625, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 972000, "episodes_total": 4860, "training_iteration": 162, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-27-33", "timestamp": 1606258653, "time_this_iter_s": 157.08233404159546, "time_total_s": 28826.399835586548, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 28826.399835586548, "timesteps_since_restore": 972000, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 28.720535714285713, "ram_util_percent": 58.536160714285714}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -467.77824198848197, "episode_reward_min": -595.8349185311831, "episode_reward_mean": -532.7112529809225, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.264614851967345, "mean_processing_ms": 6.1922395396914025, "mean_inference_ms": 1.1420982937566933}, "off_policy_estimator": {}, "info": {"num_steps_trained": 959744, "num_steps_sampled": 978000, "sample_time_ms": 156061.03, "load_time_ms": 13.128, "grad_time_ms": 938.824, "update_time_ms": 5.067, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5338.43505859375, "policy_loss": -0.021506277844309807, "vf_loss": 5338.45703125, "vf_explained_var": -9.070271644873173e-09, "kl": 0.029805023223161697, "entropy": 11.642851829528809, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 978000, "episodes_total": 4890, "training_iteration": 163, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-30-12", "timestamp": 1606258812, "time_this_iter_s": 159.05941343307495, "time_total_s": 28985.459249019623, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 28985.459249019623, "timesteps_since_restore": 978000, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 28.79911894273128, "ram_util_percent": 58.56696035242291}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -467.77824198848197, "episode_reward_min": -595.8349185311831, "episode_reward_mean": -528.9526804506418, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.223338423325856, "mean_processing_ms": 6.191669301438176, "mean_inference_ms": 1.141285207210012}, "off_policy_estimator": {}, "info": {"num_steps_trained": 965632, "num_steps_sampled": 984000, "sample_time_ms": 156024.398, "load_time_ms": 12.587, "grad_time_ms": 908.11, "update_time_ms": 5.052, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5097.6826171875, "policy_loss": -0.018029168248176575, "vf_loss": 5097.70068359375, "vf_explained_var": -7.774518806513697e-09, "kl": 0.03579976409673691, "entropy": 11.911057472229004, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 984000, "episodes_total": 4920, "training_iteration": 164, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-32-49", "timestamp": 1606258969, "time_this_iter_s": 156.95670008659363, "time_total_s": 29142.415949106216, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29142.415949106216, "timesteps_since_restore": 984000, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 28.816517857142856, "ram_util_percent": 58.703571428571436}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -469.04038790652845, "episode_reward_min": -595.8349185311831, "episode_reward_mean": -531.1155874902737, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.18213646463924, "mean_processing_ms": 6.1910581373828215, "mean_inference_ms": 1.1404772191011114}, "off_policy_estimator": {}, "info": {"num_steps_trained": 971520, "num_steps_sampled": 990000, "sample_time_ms": 155764.27, "load_time_ms": 13.01, "grad_time_ms": 944.406, "update_time_ms": 5.009, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5319.6357421875, "policy_loss": -0.017095133662223816, "vf_loss": 5319.65234375, "vf_explained_var": 0.0, "kl": 0.02701191045343876, "entropy": 12.94587516784668, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 990000, "episodes_total": 4950, "training_iteration": 165, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-35-25", "timestamp": 1606259125, "time_this_iter_s": 155.67734503746033, "time_total_s": 29298.093294143677, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29298.093294143677, "timesteps_since_restore": 990000, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 28.877927927927928, "ram_util_percent": 58.681981981982}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -469.04038790652845, "episode_reward_min": -595.4535218174829, "episode_reward_mean": -533.1756085342272, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.140440961406576, "mean_processing_ms": 6.190359873536127, "mean_inference_ms": 1.1396639415069865}, "off_policy_estimator": {}, "info": {"num_steps_trained": 977408, "num_steps_sampled": 996000, "sample_time_ms": 155604.487, "load_time_ms": 12.763, "grad_time_ms": 1012.29, "update_time_ms": 5.009, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5278.33056640625, "policy_loss": -0.019506335258483887, "vf_loss": 5278.35009765625, "vf_explained_var": -6.478765524065011e-09, "kl": 0.022665319964289665, "entropy": 12.568014144897461, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 996000, "episodes_total": 4980, "training_iteration": 166, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-37-59", "timestamp": 1606259279, "time_this_iter_s": 154.66911578178406, "time_total_s": 29452.76240992546, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29452.76240992546, "timesteps_since_restore": 996000, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 29.22217194570136, "ram_util_percent": 58.7579185520362}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -469.04038790652845, "episode_reward_min": -595.4535218174829, "episode_reward_mean": -534.4105339167672, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.09880976180333, "mean_processing_ms": 6.1896444407378635, "mean_inference_ms": 1.138889431527324}, "off_policy_estimator": {}, "info": {"num_steps_trained": 983296, "num_steps_sampled": 1002000, "sample_time_ms": 155900.907, "load_time_ms": 12.614, "grad_time_ms": 1013.633, "update_time_ms": 5.307, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5150.3134765625, "policy_loss": -0.02051142230629921, "vf_loss": 5150.33349609375, "vf_explained_var": 9.070271644873173e-09, "kl": 0.02828717976808548, "entropy": 12.12839412689209, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1002000, "episodes_total": 5010, "training_iteration": 167, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-40-38", "timestamp": 1606259438, "time_this_iter_s": 158.28974533081055, "time_total_s": 29611.05215525627, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29611.05215525627, "timesteps_since_restore": 1002000, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 28.616371681415927, "ram_util_percent": 58.8721238938053}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -469.04038790652845, "episode_reward_min": -612.2076015898016, "episode_reward_mean": -532.1020694969484, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.058111078357996, "mean_processing_ms": 6.189018803798388, "mean_inference_ms": 1.138136111716899}, "off_policy_estimator": {}, "info": {"num_steps_trained": 989184, "num_steps_sampled": 1008000, "sample_time_ms": 155928.814, "load_time_ms": 12.269, "grad_time_ms": 946.822, "update_time_ms": 5.256, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5203.33984375, "policy_loss": -0.02178291603922844, "vf_loss": 5203.3623046875, "vf_explained_var": -1.2957531714263837e-09, "kl": 0.02106347121298313, "entropy": 12.601280212402344, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1008000, "episodes_total": 5040, "training_iteration": 168, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-43-14", "timestamp": 1606259594, "time_this_iter_s": 156.88761186599731, "time_total_s": 29767.93976712227, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29767.93976712227, "timesteps_since_restore": 1008000, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 28.870852017937224, "ram_util_percent": 58.81704035874438}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -462.24948303707896, "episode_reward_min": -612.2076015898016, "episode_reward_mean": -529.8858259645481, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.01807657479838, "mean_processing_ms": 6.188430963283676, "mean_inference_ms": 1.1373881983880014}, "off_policy_estimator": {}, "info": {"num_steps_trained": 995072, "num_steps_sampled": 1014000, "sample_time_ms": 155956.569, "load_time_ms": 11.412, "grad_time_ms": 933.372, "update_time_ms": 4.931, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5172.11328125, "policy_loss": -0.027264321222901344, "vf_loss": 5172.14111328125, "vf_explained_var": -1.4253284774667918e-08, "kl": 0.03328215330839157, "entropy": 12.613726615905762, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1014000, "episodes_total": 5070, "training_iteration": 169, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-45-51", "timestamp": 1606259751, "time_this_iter_s": 156.0509524345398, "time_total_s": 29923.99071955681, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29923.99071955681, "timesteps_since_restore": 1014000, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 29.233183856502244, "ram_util_percent": 58.93183856502242}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -462.24948303707896, "episode_reward_min": -612.2076015898016, "episode_reward_mean": -536.3201016017633, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.98006516664298, "mean_processing_ms": 6.187822915687782, "mean_inference_ms": 1.1366534333335112}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1000960, "num_steps_sampled": 1020000, "sample_time_ms": 156000.654, "load_time_ms": 11.864, "grad_time_ms": 1002.352, "update_time_ms": 4.83, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5566.47314453125, "policy_loss": -0.02293609455227852, "vf_loss": 5566.49560546875, "vf_explained_var": -2.073205074282214e-08, "kl": 0.02171805314719677, "entropy": 12.166108131408691, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1020000, "episodes_total": 5100, "training_iteration": 170, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-48-29", "timestamp": 1606259909, "time_this_iter_s": 158.87102460861206, "time_total_s": 30082.86174416542, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 30082.86174416542, "timesteps_since_restore": 1020000, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 28.99074889867841, "ram_util_percent": 59.00572687224669}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -462.24948303707896, "episode_reward_min": -608.486169644159, "episode_reward_mean": -537.8880699405656, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.943178636054846, "mean_processing_ms": 6.1871326771807755, "mean_inference_ms": 1.1358881945299701}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1006848, "num_steps_sampled": 1026000, "sample_time_ms": 156288.692, "load_time_ms": 11.467, "grad_time_ms": 955.376, "update_time_ms": 5.306, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5551.35009765625, "policy_loss": -0.02048007771372795, "vf_loss": 5551.37060546875, "vf_explained_var": -9.070271644873173e-09, "kl": 0.023625683039426804, "entropy": 12.403887748718262, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1026000, "episodes_total": 5130, "training_iteration": 171, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-51-09", "timestamp": 1606260069, "time_this_iter_s": 159.13175749778748, "time_total_s": 30241.993501663208, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 30241.993501663208, "timesteps_since_restore": 1026000, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 28.793392070484582, "ram_util_percent": 59.07356828193833}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -485.25405955040526, "episode_reward_min": -608.486169644159, "episode_reward_mean": -541.6184050215932, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.907185666469395, "mean_processing_ms": 6.186443219732679, "mean_inference_ms": 1.135135238797245}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1012736, "num_steps_sampled": 1032000, "sample_time_ms": 156313.193, "load_time_ms": 11.701, "grad_time_ms": 1024.162, "update_time_ms": 4.906, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5301.8466796875, "policy_loss": -0.022047938778996468, "vf_loss": 5301.86865234375, "vf_explained_var": -1.8140543289746347e-08, "kl": 0.03206176683306694, "entropy": 12.570679664611816, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1032000, "episodes_total": 5160, "training_iteration": 172, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-53-47", "timestamp": 1606260227, "time_this_iter_s": 158.0176920890808, "time_total_s": 30400.01119375229, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 30400.01119375229, "timesteps_since_restore": 1032000, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 29.051111111111112, "ram_util_percent": 59.122666666666674}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -485.25405955040526, "episode_reward_min": -608.486169644159, "episode_reward_mean": -542.1276713121688, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.872463740314764, "mean_processing_ms": 6.185747142626235, "mean_inference_ms": 1.1343934808390537}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1018624, "num_steps_sampled": 1038000, "sample_time_ms": 156402.695, "load_time_ms": 11.687, "grad_time_ms": 983.084, "update_time_ms": 5.24, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5503.7548828125, "policy_loss": -0.024206355214118958, "vf_loss": 5503.77880859375, "vf_explained_var": 1.2957531048130022e-08, "kl": 0.02530878223478794, "entropy": 12.17053508758545, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1038000, "episodes_total": 5190, "training_iteration": 173, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-56-26", "timestamp": 1606260386, "time_this_iter_s": 159.5423460006714, "time_total_s": 30559.55353975296, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 30559.55353975296, "timesteps_since_restore": 1038000, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 28.74736842105263, "ram_util_percent": 59.09342105263158}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -477.3417009561971, "episode_reward_min": -605.7339381150623, "episode_reward_mean": -539.5830786495576, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.836538635710696, "mean_processing_ms": 6.185064902415416, "mean_inference_ms": 1.1336535295689132}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1024512, "num_steps_sampled": 1044000, "sample_time_ms": 156278.845, "load_time_ms": 12.579, "grad_time_ms": 998.231, "update_time_ms": 4.972, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5321.13134765625, "policy_loss": -0.019403032958507538, "vf_loss": 5321.1513671875, "vf_explained_var": -3.887259403256849e-09, "kl": 0.0227707140147686, "entropy": 12.861331939697266, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1044000, "episodes_total": 5220, "training_iteration": 174, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_04-59-02", "timestamp": 1606260542, "time_this_iter_s": 155.876638174057, "time_total_s": 30715.430177927017, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 30715.430177927017, "timesteps_since_restore": 1044000, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 28.785135135135132, "ram_util_percent": 59.16441441441442}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -473.0843344843018, "episode_reward_min": -619.3262676287378, "episode_reward_mean": -540.9118413900007, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.80001233046771, "mean_processing_ms": 6.184444053867989, "mean_inference_ms": 1.1329251284303647}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1030400, "num_steps_sampled": 1050000, "sample_time_ms": 156378.361, "load_time_ms": 12.584, "grad_time_ms": 1023.756, "update_time_ms": 5.023, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5421.7666015625, "policy_loss": -0.02492239512503147, "vf_loss": 5421.79150390625, "vf_explained_var": -7.774518806513697e-09, "kl": 0.03213969245553017, "entropy": 12.69048023223877, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1050000, "episodes_total": 5250, "training_iteration": 175, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-01-39", "timestamp": 1606260699, "time_this_iter_s": 156.92865705490112, "time_total_s": 30872.35883498192, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 30872.35883498192, "timesteps_since_restore": 1050000, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 28.91473214285714, "ram_util_percent": 59.23035714285714}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -473.0843344843018, "episode_reward_min": -619.3262676287378, "episode_reward_mean": -537.265152204204, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.76233514732156, "mean_processing_ms": 6.183850528637763, "mean_inference_ms": 1.1321920438541513}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1036288, "num_steps_sampled": 1056000, "sample_time_ms": 156346.207, "load_time_ms": 12.319, "grad_time_ms": 954.516, "update_time_ms": 4.913, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5359.5498046875, "policy_loss": -0.023296847939491272, "vf_loss": 5359.57275390625, "vf_explained_var": 1.2957531714263837e-09, "kl": 0.029578037559986115, "entropy": 12.770710945129395, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1056000, "episodes_total": 5280, "training_iteration": 176, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-04-13", "timestamp": 1606260853, "time_this_iter_s": 153.64891266822815, "time_total_s": 31026.007747650146, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 31026.007747650146, "timesteps_since_restore": 1056000, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 29.142009132420092, "ram_util_percent": 59.240182648401834}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -460.4626562763804, "episode_reward_min": -619.3262676287378, "episode_reward_mean": -535.0277886476181, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.72616694972967, "mean_processing_ms": 6.183346315905697, "mean_inference_ms": 1.1315354322380553}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1042176, "num_steps_sampled": 1062000, "sample_time_ms": 156283.352, "load_time_ms": 12.798, "grad_time_ms": 1011.435, "update_time_ms": 4.634, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5265.31884765625, "policy_loss": -0.024615876376628876, "vf_loss": 5265.34326171875, "vf_explained_var": -1.2957531714263837e-09, "kl": 0.024710072204470634, "entropy": 12.256479263305664, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1062000, "episodes_total": 5310, "training_iteration": 177, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-06-51", "timestamp": 1606261011, "time_this_iter_s": 158.23300123214722, "time_total_s": 31184.240748882294, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 31184.240748882294, "timesteps_since_restore": 1062000, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 28.99823008849557, "ram_util_percent": 59.34734513274336}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -460.4626562763804, "episode_reward_min": -628.1240958340549, "episode_reward_mean": -533.5827467362557, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.69104687713318, "mean_processing_ms": 6.182735467268408, "mean_inference_ms": 1.1308831378377178}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1048064, "num_steps_sampled": 1068000, "sample_time_ms": 156150.953, "load_time_ms": 12.734, "grad_time_ms": 1010.927, "update_time_ms": 4.669, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5271.888671875, "policy_loss": -0.02792424149811268, "vf_loss": 5271.9169921875, "vf_explained_var": -1.4253284774667918e-08, "kl": 0.039393119513988495, "entropy": 12.708675384521484, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1068000, "episodes_total": 5340, "training_iteration": 178, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-09-27", "timestamp": 1606261167, "time_this_iter_s": 155.55840134620667, "time_total_s": 31339.7991502285, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 31339.7991502285, "timesteps_since_restore": 1068000, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 28.933333333333337, "ram_util_percent": 59.36666666666666}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -460.4626562763804, "episode_reward_min": -628.1240958340549, "episode_reward_mean": -532.4626096780896, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.65724215998342, "mean_processing_ms": 6.182207124070196, "mean_inference_ms": 1.1302454802147375}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1053952, "num_steps_sampled": 1074000, "sample_time_ms": 156254.4, "load_time_ms": 12.738, "grad_time_ms": 956.411, "update_time_ms": 4.729, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5195.96240234375, "policy_loss": -0.02472219243645668, "vf_loss": 5195.98779296875, "vf_explained_var": -1.9436297904462663e-08, "kl": 0.024082956835627556, "entropy": 12.4151029586792, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1074000, "episodes_total": 5370, "training_iteration": 179, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-12-03", "timestamp": 1606261323, "time_this_iter_s": 156.53665280342102, "time_total_s": 31496.33580303192, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 31496.33580303192, "timesteps_since_restore": 1074000, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 29.039461883408073, "ram_util_percent": 59.32869955156951}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -476.9027744362709, "episode_reward_min": -628.1240958340549, "episode_reward_mean": -535.1370057475135, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.62377046898302, "mean_processing_ms": 6.1816214933634015, "mean_inference_ms": 1.1295947556019181}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1059840, "num_steps_sampled": 1080000, "sample_time_ms": 156417.032, "load_time_ms": 12.762, "grad_time_ms": 897.963, "update_time_ms": 4.41, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5432.7978515625, "policy_loss": -0.025741059333086014, "vf_loss": 5432.8232421875, "vf_explained_var": -2.5915063428527674e-09, "kl": 0.03017180971801281, "entropy": 13.512269020080566, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1080000, "episodes_total": 5400, "training_iteration": 180, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-14-43", "timestamp": 1606261483, "time_this_iter_s": 159.9062786102295, "time_total_s": 31656.24208164215, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 31656.24208164215, "timesteps_since_restore": 1080000, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 28.48515283842795, "ram_util_percent": 59.47117903930131}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -476.3815470950434, "episode_reward_min": -602.9820260699654, "episode_reward_mean": -537.1234431573857, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.59023667645598, "mean_processing_ms": 6.181032215340378, "mean_inference_ms": 1.1289433433770137}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1065728, "num_steps_sampled": 1086000, "sample_time_ms": 156075.142, "load_time_ms": 12.659, "grad_time_ms": 876.901, "update_time_ms": 3.892, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5484.1533203125, "policy_loss": -0.021935146301984787, "vf_loss": 5484.1748046875, "vf_explained_var": -2.073205074282214e-08, "kl": 0.02140306867659092, "entropy": 13.017114639282227, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1086000, "episodes_total": 5430, "training_iteration": 181, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-17-19", "timestamp": 1606261639, "time_this_iter_s": 155.4955677986145, "time_total_s": 31811.737649440765, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 31811.737649440765, "timesteps_since_restore": 1086000, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 28.829864253393662, "ram_util_percent": 59.482352941176465}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -476.3815470950434, "episode_reward_min": -610.8310032925964, "episode_reward_mean": -540.0299746669908, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.55622646569974, "mean_processing_ms": 6.180477807638913, "mean_inference_ms": 1.128319716766165}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1071616, "num_steps_sampled": 1092000, "sample_time_ms": 155809.885, "load_time_ms": 12.698, "grad_time_ms": 876.848, "update_time_ms": 3.804, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5437.23193359375, "policy_loss": -0.022573353722691536, "vf_loss": 5437.25439453125, "vf_explained_var": -1.4253284774667918e-08, "kl": 0.02349173277616501, "entropy": 13.6624116897583, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1092000, "episodes_total": 5460, "training_iteration": 182, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-19-54", "timestamp": 1606261794, "time_this_iter_s": 155.36400437355042, "time_total_s": 31967.101653814316, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 31967.101653814316, "timesteps_since_restore": 1092000, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 29.142792792792797, "ram_util_percent": 59.517567567567575}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -476.3815470950434, "episode_reward_min": -614.2480516278924, "episode_reward_mean": -544.7587943404029, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.52368941734575, "mean_processing_ms": 6.179779436596427, "mean_inference_ms": 1.127682396895376}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1077504, "num_steps_sampled": 1098000, "sample_time_ms": 155640.817, "load_time_ms": 12.341, "grad_time_ms": 848.648, "update_time_ms": 3.459, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5641.0625, "policy_loss": -0.026107728481292725, "vf_loss": 5641.0888671875, "vf_explained_var": -1.2957531714263837e-09, "kl": 0.03348312899470329, "entropy": 13.425500869750977, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1098000, "episodes_total": 5490, "training_iteration": 183, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-22-32", "timestamp": 1606261952, "time_this_iter_s": 157.56436562538147, "time_total_s": 32124.666019439697, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 32124.666019439697, "timesteps_since_restore": 1098000, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 28.798666666666666, "ram_util_percent": 59.53022222222223}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -476.3815470950434, "episode_reward_min": -614.2480516278924, "episode_reward_mean": -544.7240467433406, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.49127698432914, "mean_processing_ms": 6.179172568560205, "mean_inference_ms": 1.1270565856854942}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1083392, "num_steps_sampled": 1104000, "sample_time_ms": 155826.895, "load_time_ms": 12.048, "grad_time_ms": 846.49, "update_time_ms": 3.542, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5566.87548828125, "policy_loss": -0.022761879488825798, "vf_loss": 5566.89794921875, "vf_explained_var": -2.073205074282214e-08, "kl": 0.029309824109077454, "entropy": 13.168251037597656, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1104000, "episodes_total": 5520, "training_iteration": 184, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-25-09", "timestamp": 1606262109, "time_this_iter_s": 157.7140748500824, "time_total_s": 32282.38009428978, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 32282.38009428978, "timesteps_since_restore": 1104000, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 29.21644444444445, "ram_util_percent": 59.64622222222223}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -490.1527162563597, "episode_reward_min": -627.9457936662791, "episode_reward_mean": -548.4819765602775, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.460782367535614, "mean_processing_ms": 6.178643167092355, "mean_inference_ms": 1.1264406651648067}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1089280, "num_steps_sampled": 1110000, "sample_time_ms": 156000.764, "load_time_ms": 12.152, "grad_time_ms": 821.204, "update_time_ms": 3.584, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5704.6689453125, "policy_loss": -0.02913653291761875, "vf_loss": 5704.69970703125, "vf_explained_var": -7.774518806513697e-09, "kl": 0.04572878032922745, "entropy": 13.622915267944336, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1110000, "episodes_total": 5550, "training_iteration": 185, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-27-48", "timestamp": 1606262268, "time_this_iter_s": 158.41575646400452, "time_total_s": 32440.795850753784, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 32440.795850753784, "timesteps_since_restore": 1110000, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 28.937610619469027, "ram_util_percent": 59.61548672566373}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -486.6180350273739, "episode_reward_min": -627.9457936662791, "episode_reward_mean": -549.7838061199592, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.43056552730615, "mean_processing_ms": 6.178187388847082, "mean_inference_ms": 1.1258065777478297}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1095168, "num_steps_sampled": 1116000, "sample_time_ms": 156253.011, "load_time_ms": 12.026, "grad_time_ms": 821.465, "update_time_ms": 3.714, "learner": {"default_policy": {"cur_kl_coeff": 3.662109520519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5660.4091796875, "policy_loss": -0.021122638136148453, "vf_loss": 5660.43017578125, "vf_explained_var": 1.036602537141107e-08, "kl": 0.024355541914701462, "entropy": 13.369436264038086, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1116000, "episodes_total": 5580, "training_iteration": 186, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-30-24", "timestamp": 1606262424, "time_this_iter_s": 156.1732017993927, "time_total_s": 32596.969052553177, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 32596.969052553177, "timesteps_since_restore": 1116000, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 29.052466367713013, "ram_util_percent": 59.721524663677144}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -471.53467399306624, "episode_reward_min": -627.9457936662791, "episode_reward_mean": -546.4070276149049, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.40057202590901, "mean_processing_ms": 6.177694161101719, "mean_inference_ms": 1.1252009323041696}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1101056, "num_steps_sampled": 1122000, "sample_time_ms": 156051.721, "load_time_ms": 12.045, "grad_time_ms": 833.918, "update_time_ms": 3.751, "learner": {"default_policy": {"cur_kl_coeff": 3.662109520519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5367.42431640625, "policy_loss": -0.02558731473982334, "vf_loss": 5367.4501953125, "vf_explained_var": -2.5915063428527674e-09, "kl": 0.03742685168981552, "entropy": 14.103974342346191, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1122000, "episodes_total": 5610, "training_iteration": 187, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-33-00", "timestamp": 1606262580, "time_this_iter_s": 156.34924602508545, "time_total_s": 32753.318298578262, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 32753.318298578262, "timesteps_since_restore": 1122000, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 28.91479820627803, "ram_util_percent": 59.775784753363226}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -471.53467399306624, "episode_reward_min": -609.8387840770629, "episode_reward_mean": -542.9690238694075, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.36942960044243, "mean_processing_ms": 6.177133221444078, "mean_inference_ms": 1.1245880387107265}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1106944, "num_steps_sampled": 1128000, "sample_time_ms": 155996.98, "load_time_ms": 12.582, "grad_time_ms": 902.652, "update_time_ms": 3.87, "learner": {"default_policy": {"cur_kl_coeff": 3.662109520519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5372.35302734375, "policy_loss": -0.022158198058605194, "vf_loss": 5372.37548828125, "vf_explained_var": -1.1661778209770546e-08, "kl": 0.0238003209233284, "entropy": 14.08979320526123, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1128000, "episodes_total": 5640, "training_iteration": 188, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-35-36", "timestamp": 1606262736, "time_this_iter_s": 155.7089602947235, "time_total_s": 32909.027258872986, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 32909.027258872986, "timesteps_since_restore": 1128000, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 28.72567567567567, "ram_util_percent": 59.76981981981981}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -471.53467399306624, "episode_reward_min": -635.3461898302559, "episode_reward_mean": -541.338376168235, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.33890282851183, "mean_processing_ms": 6.17654671079962, "mean_inference_ms": 1.123958088012392}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1112832, "num_steps_sampled": 1134000, "sample_time_ms": 156081.353, "load_time_ms": 13.094, "grad_time_ms": 970.298, "update_time_ms": 4.072, "learner": {"default_policy": {"cur_kl_coeff": 3.662109520519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5577.3134765625, "policy_loss": -0.018989654257893562, "vf_loss": 5577.33251953125, "vf_explained_var": 0.0, "kl": 0.027126822620630264, "entropy": 13.97704792022705, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1134000, "episodes_total": 5670, "training_iteration": 189, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-38-14", "timestamp": 1606262894, "time_this_iter_s": 158.068044424057, "time_total_s": 33067.09530329704, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 33067.09530329704, "timesteps_since_restore": 1134000, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 29.276106194690264, "ram_util_percent": 59.85442477876106}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -471.53467399306624, "episode_reward_min": -635.3461898302559, "episode_reward_mean": -543.5640204661921, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.30828420617737, "mean_processing_ms": 6.175995248345583, "mean_inference_ms": 1.123334445880337}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1118720, "num_steps_sampled": 1140000, "sample_time_ms": 155638.588, "load_time_ms": 12.631, "grad_time_ms": 959.905, "update_time_ms": 4.418, "learner": {"default_policy": {"cur_kl_coeff": 3.662109520519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5698.8173828125, "policy_loss": -0.03208820894360542, "vf_loss": 5698.84912109375, "vf_explained_var": 0.0, "kl": 0.02965487539768219, "entropy": 14.272760391235352, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1140000, "episodes_total": 5700, "training_iteration": 190, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-40-50", "timestamp": 1606263050, "time_this_iter_s": 155.3731768131256, "time_total_s": 33222.46848011017, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 33222.46848011017, "timesteps_since_restore": 1140000, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 28.949321266968322, "ram_util_percent": 59.824434389140265}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -473.16057895395045, "episode_reward_min": -635.3461898302559, "episode_reward_mean": -547.7497621357629, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.27799397462639, "mean_processing_ms": 6.175420756695785, "mean_inference_ms": 1.1227422847278055}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1124608, "num_steps_sampled": 1146000, "sample_time_ms": 155748.253, "load_time_ms": 12.632, "grad_time_ms": 961.2, "update_time_ms": 4.504, "learner": {"default_policy": {"cur_kl_coeff": 3.662109520519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5443.5595703125, "policy_loss": -0.021865181624889374, "vf_loss": 5443.58203125, "vf_explained_var": -1.036602537141107e-08, "kl": 0.050095077604055405, "entropy": 14.613003730773926, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1146000, "episodes_total": 5730, "training_iteration": 191, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-43-26", "timestamp": 1606263206, "time_this_iter_s": 156.60638785362244, "time_total_s": 33379.07486796379, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 33379.07486796379, "timesteps_since_restore": 1146000, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 29.01875, "ram_util_percent": 59.783482142857146}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -473.16057895395045, "episode_reward_min": -635.3461898302559, "episode_reward_mean": -548.4377156022213, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.24779038143701, "mean_processing_ms": 6.174904572053897, "mean_inference_ms": 1.1221926920864984}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1130496, "num_steps_sampled": 1152000, "sample_time_ms": 155939.343, "load_time_ms": 12.133, "grad_time_ms": 892.741, "update_time_ms": 4.555, "learner": {"default_policy": {"cur_kl_coeff": 5.493163916980848e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5745.1435546875, "policy_loss": -0.014218184165656567, "vf_loss": 5745.158203125, "vf_explained_var": 3.887259403256849e-09, "kl": 0.04199672117829323, "entropy": 14.917803764343262, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1152000, "episodes_total": 5760, "training_iteration": 192, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-46-03", "timestamp": 1606263363, "time_this_iter_s": 156.58169651031494, "time_total_s": 33535.656564474106, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 33535.656564474106, "timesteps_since_restore": 1152000, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 29.193721973094167, "ram_util_percent": 59.87847533632286}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -473.16057895395045, "episode_reward_min": -609.7095575556792, "episode_reward_mean": -548.2654705860209, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.21753179797061, "mean_processing_ms": 6.174403273599016, "mean_inference_ms": 1.121657629970612}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1136384, "num_steps_sampled": 1158000, "sample_time_ms": 155802.33, "load_time_ms": 12.58, "grad_time_ms": 973.414, "update_time_ms": 4.623, "learner": {"default_policy": {"cur_kl_coeff": 8.239746239269152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5681.33984375, "policy_loss": -0.018520548939704895, "vf_loss": 5681.35888671875, "vf_explained_var": -7.774518806513697e-09, "kl": 0.026610810309648514, "entropy": 14.854386329650879, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1158000, "episodes_total": 5790, "training_iteration": 193, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-48-40", "timestamp": 1606263520, "time_this_iter_s": 157.00853538513184, "time_total_s": 33692.66509985924, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 33692.66509985924, "timesteps_since_restore": 1158000, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 28.834374999999998, "ram_util_percent": 59.89955357142857}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -482.6633202770186, "episode_reward_min": -609.7095575556792, "episode_reward_mean": -553.1719875404146, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.188584564475335, "mean_processing_ms": 6.1738334218450355, "mean_inference_ms": 1.1210985282067023}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1142272, "num_steps_sampled": 1164000, "sample_time_ms": 155677.36, "load_time_ms": 12.049, "grad_time_ms": 956.171, "update_time_ms": 4.812, "learner": {"default_policy": {"cur_kl_coeff": 8.239746239269152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5796.09912109375, "policy_loss": -0.02526659332215786, "vf_loss": 5796.12451171875, "vf_explained_var": -3.887259403256849e-09, "kl": 0.042173873633146286, "entropy": 14.359855651855469, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1164000, "episodes_total": 5820, "training_iteration": 194, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-51-16", "timestamp": 1606263676, "time_this_iter_s": 156.28857111930847, "time_total_s": 33848.953670978546, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 33848.953670978546, "timesteps_since_restore": 1164000, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 28.980269058295967, "ram_util_percent": 60.01434977578476}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -464.61601910543254, "episode_reward_min": -609.7095575556792, "episode_reward_mean": -549.5554636302056, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.15957561739108, "mean_processing_ms": 6.173303415443728, "mean_inference_ms": 1.1205423758155477}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1148160, "num_steps_sampled": 1170000, "sample_time_ms": 155612.368, "load_time_ms": 11.442, "grad_time_ms": 887.799, "update_time_ms": 4.748, "learner": {"default_policy": {"cur_kl_coeff": 0.0001235961972270161, "cur_lr": 4.999999873689376e-05, "total_loss": 5565.0576171875, "policy_loss": -0.018715720623731613, "vf_loss": 5565.07666015625, "vf_explained_var": -6.478765524065011e-09, "kl": 0.032579123973846436, "entropy": 14.389272689819336, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1170000, "episodes_total": 5850, "training_iteration": 195, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-53-53", "timestamp": 1606263833, "time_this_iter_s": 157.07104206085205, "time_total_s": 34006.0247130394, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 34006.0247130394, "timesteps_since_restore": 1170000, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 28.803124999999998, "ram_util_percent": 60.10625000000001}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -464.61601910543254, "episode_reward_min": -643.8887151411847, "episode_reward_mean": -548.9146100302958, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.13122659190201, "mean_processing_ms": 6.1727648912245945, "mean_inference_ms": 1.119974499553584}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1154048, "num_steps_sampled": 1176000, "sample_time_ms": 155755.837, "load_time_ms": 11.928, "grad_time_ms": 956.814, "update_time_ms": 4.392, "learner": {"default_policy": {"cur_kl_coeff": 0.0001235961972270161, "cur_lr": 4.999999873689376e-05, "total_loss": 5637.83642578125, "policy_loss": -0.01759594865143299, "vf_loss": 5637.8544921875, "vf_explained_var": -1.4253284774667918e-08, "kl": 0.04012824967503548, "entropy": 13.8624849319458, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1176000, "episodes_total": 5880, "training_iteration": 196, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-56-32", "timestamp": 1606263992, "time_this_iter_s": 158.30323457717896, "time_total_s": 34164.32794761658, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 34164.32794761658, "timesteps_since_restore": 1176000, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 28.904867256637168, "ram_util_percent": 60.135840707964604}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -464.61601910543254, "episode_reward_min": -643.8887151411847, "episode_reward_mean": -547.0661872880861, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.10242320925888, "mean_processing_ms": 6.172278571085644, "mean_inference_ms": 1.1194283320032026}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1159936, "num_steps_sampled": 1182000, "sample_time_ms": 155877.856, "load_time_ms": 11.564, "grad_time_ms": 904.483, "update_time_ms": 4.662, "learner": {"default_policy": {"cur_kl_coeff": 0.0001853942812886089, "cur_lr": 4.999999873689376e-05, "total_loss": 5569.78369140625, "policy_loss": -0.024209769442677498, "vf_loss": 5569.80810546875, "vf_explained_var": 1.5549037613027394e-08, "kl": 0.04123475402593613, "entropy": 13.960232734680176, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1182000, "episodes_total": 5910, "training_iteration": 197, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_05-59-09", "timestamp": 1606264149, "time_this_iter_s": 157.0406675338745, "time_total_s": 34321.36861515045, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 34321.36861515045, "timesteps_since_restore": 1182000, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 29.010267857142853, "ram_util_percent": 60.25535714285714}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -464.61601910543254, "episode_reward_min": -643.8887151411847, "episode_reward_mean": -546.7334874518486, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.073483730002266, "mean_processing_ms": 6.171868016125725, "mean_inference_ms": 1.1188846450142245}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1165824, "num_steps_sampled": 1188000, "sample_time_ms": 155886.044, "load_time_ms": 11.026, "grad_time_ms": 841.328, "update_time_ms": 4.567, "learner": {"default_policy": {"cur_kl_coeff": 0.0002780914364848286, "cur_lr": 4.999999873689376e-05, "total_loss": 5670.35888671875, "policy_loss": -0.014952371828258038, "vf_loss": 5670.3740234375, "vf_explained_var": 9.070271644873173e-09, "kl": 0.051373060792684555, "entropy": 14.364374160766602, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1188000, "episodes_total": 5940, "training_iteration": 198, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-01-44", "timestamp": 1606264304, "time_this_iter_s": 155.1489703655243, "time_total_s": 34476.517585515976, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 34476.517585515976, "timesteps_since_restore": 1188000, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 29.18963963963964, "ram_util_percent": 60.366216216216216}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -477.5673520897047, "episode_reward_min": -630.4647221528016, "episode_reward_mean": -543.6825613944939, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.04654516606295, "mean_processing_ms": 6.171592337803521, "mean_inference_ms": 1.1184001148634388}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1171712, "num_steps_sampled": 1194000, "sample_time_ms": 156182.488, "load_time_ms": 10.997, "grad_time_ms": 842.457, "update_time_ms": 4.359, "learner": {"default_policy": {"cur_kl_coeff": 0.00041713714017532766, "cur_lr": 4.999999873689376e-05, "total_loss": 5440.283203125, "policy_loss": -0.01125316135585308, "vf_loss": 5440.29443359375, "vf_explained_var": 9.070271644873173e-09, "kl": 0.032513219863176346, "entropy": 13.629756927490234, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1194000, "episodes_total": 5970, "training_iteration": 199, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-04-25", "timestamp": 1606264465, "time_this_iter_s": 161.04143476486206, "time_total_s": 34637.55902028084, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 34637.55902028084, "timesteps_since_restore": 1194000, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 31.043231441048032, "ram_util_percent": 60.67772925764192}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -477.5673520897047, "episode_reward_min": -630.4647221528016, "episode_reward_mean": -547.4315290315831, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.02096775696769, "mean_processing_ms": 6.171292589305167, "mean_inference_ms": 1.1179167673667396}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1177600, "num_steps_sampled": 1200000, "sample_time_ms": 156390.252, "load_time_ms": 10.951, "grad_time_ms": 844.688, "update_time_ms": 4.271, "learner": {"default_policy": {"cur_kl_coeff": 0.00041713714017532766, "cur_lr": 4.999999873689376e-05, "total_loss": 5759.8154296875, "policy_loss": -0.014977352693676949, "vf_loss": 5759.830078125, "vf_explained_var": -1.2957531714263837e-09, "kl": 0.05039980262517929, "entropy": 14.395459175109863, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1200000, "episodes_total": 6000, "training_iteration": 200, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-07-03", "timestamp": 1606264623, "time_this_iter_s": 157.47186732292175, "time_total_s": 34795.03088760376, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 34795.03088760376, "timesteps_since_restore": 1200000, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 29.35555555555555, "ram_util_percent": 60.59288888888888}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -477.5673520897047, "episode_reward_min": -642.2818284378145, "episode_reward_mean": -548.6587317932539, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.99542321974624, "mean_processing_ms": 6.170898179511214, "mean_inference_ms": 1.1174214940526896}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1183488, "num_steps_sampled": 1206000, "sample_time_ms": 156199.92, "load_time_ms": 12.191, "grad_time_ms": 912.232, "update_time_ms": 4.275, "learner": {"default_policy": {"cur_kl_coeff": 0.0006257056957110763, "cur_lr": 4.999999873689376e-05, "total_loss": 5676.99365234375, "policy_loss": -0.015035394579172134, "vf_loss": 5677.00927734375, "vf_explained_var": 6.478765524065011e-09, "kl": 0.03910433128476143, "entropy": 15.007318496704102, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1206000, "episodes_total": 6030, "training_iteration": 201, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-09-38", "timestamp": 1606264778, "time_this_iter_s": 155.39464855194092, "time_total_s": 34950.4255361557, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 34950.4255361557, "timesteps_since_restore": 1206000, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 29.105405405405403, "ram_util_percent": 60.943693693693696}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -477.5673520897047, "episode_reward_min": -667.5933819724836, "episode_reward_mean": -551.801640796229, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.969560161272895, "mean_processing_ms": 6.170273591363404, "mean_inference_ms": 1.1169041709361855}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1189376, "num_steps_sampled": 1212000, "sample_time_ms": 156149.81, "load_time_ms": 12.932, "grad_time_ms": 929.852, "update_time_ms": 4.667, "learner": {"default_policy": {"cur_kl_coeff": 0.0006257056957110763, "cur_lr": 4.999999873689376e-05, "total_loss": 5856.1513671875, "policy_loss": -0.015586710534989834, "vf_loss": 5856.16796875, "vf_explained_var": -1.036602537141107e-08, "kl": 0.04311104863882065, "entropy": 14.5244722366333, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1212000, "episodes_total": 6060, "training_iteration": 202, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-12-14", "timestamp": 1606264934, "time_this_iter_s": 156.2710657119751, "time_total_s": 35106.696601867676, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 35106.696601867676, "timesteps_since_restore": 1212000, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 29.156502242152463, "ram_util_percent": 60.99955156950673}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -484.12553977525073, "episode_reward_min": -667.5933819724836, "episode_reward_mean": -553.1892921451058, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.9429182638254, "mean_processing_ms": 6.169655616500432, "mean_inference_ms": 1.1164181502944495}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1195264, "num_steps_sampled": 1218000, "sample_time_ms": 156453.415, "load_time_ms": 12.56, "grad_time_ms": 914.383, "update_time_ms": 4.962, "learner": {"default_policy": {"cur_kl_coeff": 0.0009385586017742753, "cur_lr": 4.999999873689376e-05, "total_loss": 5665.8203125, "policy_loss": -0.005750372540205717, "vf_loss": 5665.82568359375, "vf_explained_var": 3.887259403256849e-09, "kl": 0.03762894868850708, "entropy": 14.512452125549316, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1218000, "episodes_total": 6090, "training_iteration": 203, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-14-54", "timestamp": 1606265094, "time_this_iter_s": 159.88815426826477, "time_total_s": 35266.58475613594, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 35266.58475613594, "timesteps_since_restore": 1218000, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 28.82236842105263, "ram_util_percent": 61.26491228070174}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -463.33639464723876, "episode_reward_min": -667.5933819724836, "episode_reward_mean": -548.2764822798798, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.91593247696969, "mean_processing_ms": 6.169094712716827, "mean_inference_ms": 1.115923701931902}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1201152, "num_steps_sampled": 1224000, "sample_time_ms": 156316.191, "load_time_ms": 13.521, "grad_time_ms": 982.514, "update_time_ms": 5.007, "learner": {"default_policy": {"cur_kl_coeff": 0.0009385586017742753, "cur_lr": 4.999999873689376e-05, "total_loss": 5524.82958984375, "policy_loss": -0.018383128568530083, "vf_loss": 5524.84765625, "vf_explained_var": -5.183012685705535e-09, "kl": 0.05106620118021965, "entropy": 14.203673362731934, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1224000, "episodes_total": 6120, "training_iteration": 204, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-17-30", "timestamp": 1606265250, "time_this_iter_s": 155.61022973060608, "time_total_s": 35422.19498586655, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 35422.19498586655, "timesteps_since_restore": 1224000, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 29.07882882882883, "ram_util_percent": 61.44594594594593}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -463.33639464723876, "episode_reward_min": -625.4329333227306, "episode_reward_mean": -547.6153857695506, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.88934800899874, "mean_processing_ms": 6.168515539461133, "mean_inference_ms": 1.1154360043404978}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1207040, "num_steps_sampled": 1230000, "sample_time_ms": 156356.152, "load_time_ms": 13.395, "grad_time_ms": 984.535, "update_time_ms": 5.341, "learner": {"default_policy": {"cur_kl_coeff": 0.001407837844453752, "cur_lr": 4.999999873689376e-05, "total_loss": 5633.26416015625, "policy_loss": -0.013460504822432995, "vf_loss": 5633.27783203125, "vf_explained_var": -2.2027803581181615e-08, "kl": 0.05297158658504486, "entropy": 14.458992004394531, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1230000, "episodes_total": 6150, "training_iteration": 205, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-20-07", "timestamp": 1606265407, "time_this_iter_s": 157.49286079406738, "time_total_s": 35579.687846660614, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 35579.687846660614, "timesteps_since_restore": 1230000, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 28.70622222222222, "ram_util_percent": 61.507555555555555}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -463.33639464723876, "episode_reward_min": -637.1167662655471, "episode_reward_mean": -549.0785461863161, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.862701476840776, "mean_processing_ms": 6.168043615063571, "mean_inference_ms": 1.114961158129706}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1212928, "num_steps_sampled": 1236000, "sample_time_ms": 156063.028, "load_time_ms": 12.741, "grad_time_ms": 916.345, "update_time_ms": 5.305, "learner": {"default_policy": {"cur_kl_coeff": 0.002111756708472967, "cur_lr": 4.999999873689376e-05, "total_loss": 5640.125, "policy_loss": -0.007238202728331089, "vf_loss": 5640.13232421875, "vf_explained_var": -1.5549037613027394e-08, "kl": 0.047507815062999725, "entropy": 14.64547348022461, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1236000, "episodes_total": 6180, "training_iteration": 206, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-22-42", "timestamp": 1606265562, "time_this_iter_s": 154.67851066589355, "time_total_s": 35734.36635732651, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 35734.36635732651, "timesteps_since_restore": 1236000, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 28.988181818181822, "ram_util_percent": 61.57681818181819}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -463.33639464723876, "episode_reward_min": -637.1167662655471, "episode_reward_mean": -543.9124013620541, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.83680592079906, "mean_processing_ms": 6.1675711582396, "mean_inference_ms": 1.1144935558721283}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1218816, "num_steps_sampled": 1242000, "sample_time_ms": 156045.704, "load_time_ms": 13.012, "grad_time_ms": 950.796, "update_time_ms": 4.938, "learner": {"default_policy": {"cur_kl_coeff": 0.0031676352955400944, "cur_lr": 4.999999873689376e-05, "total_loss": 5430.078125, "policy_loss": -0.00864122249186039, "vf_loss": 5430.08642578125, "vf_explained_var": 2.5915063428527674e-09, "kl": 0.05144430696964264, "entropy": 14.15774154663086, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1242000, "episodes_total": 6210, "training_iteration": 207, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-25-19", "timestamp": 1606265719, "time_this_iter_s": 157.2109875679016, "time_total_s": 35891.57734489441, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 35891.57734489441, "timesteps_since_restore": 1242000, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 29.191555555555556, "ram_util_percent": 61.68133333333335}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -465.1720767045717, "episode_reward_min": -637.1167662655471, "episode_reward_mean": -542.888304460899, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.81067106185192, "mean_processing_ms": 6.167188393040289, "mean_inference_ms": 1.1140438724324182}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1224704, "num_steps_sampled": 1248000, "sample_time_ms": 156219.4, "load_time_ms": 13.42, "grad_time_ms": 971.947, "update_time_ms": 4.871, "learner": {"default_policy": {"cur_kl_coeff": 0.004751452710479498, "cur_lr": 4.999999873689376e-05, "total_loss": 5441.11669921875, "policy_loss": -0.004770178813487291, "vf_loss": 5441.12060546875, "vf_explained_var": 1.684479045138687e-08, "kl": 0.07143150269985199, "entropy": 14.707086563110352, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1248000, "episodes_total": 6240, "training_iteration": 208, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-27-56", "timestamp": 1606265876, "time_this_iter_s": 157.10065460205078, "time_total_s": 36048.67799949646, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 36048.67799949646, "timesteps_since_restore": 1248000, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 28.98839285714286, "ram_util_percent": 61.705357142857146}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -465.1720767045717, "episode_reward_min": -613.8202252718356, "episode_reward_mean": -540.7156572633701, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.7861726445762, "mean_processing_ms": 6.166746660983065, "mean_inference_ms": 1.1135651497076575}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1230592, "num_steps_sampled": 1254000, "sample_time_ms": 156006.97, "load_time_ms": 12.86, "grad_time_ms": 905.055, "update_time_ms": 4.844, "learner": {"default_policy": {"cur_kl_coeff": 0.0071271792985498905, "cur_lr": 4.999999873689376e-05, "total_loss": 5553.81689453125, "policy_loss": -0.015510886907577515, "vf_loss": 5553.83203125, "vf_explained_var": 5.183012685705535e-09, "kl": 0.06353716552257538, "entropy": 14.709846496582031, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1254000, "episodes_total": 6270, "training_iteration": 209, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-30-35", "timestamp": 1606266035, "time_this_iter_s": 158.23798322677612, "time_total_s": 36206.915982723236, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 36206.915982723236, "timesteps_since_restore": 1254000, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 28.827111111111112, "ram_util_percent": 61.82044444444444}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -465.1720767045717, "episode_reward_min": -618.0777260542993, "episode_reward_mean": -544.6397650798701, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.76228104531678, "mean_processing_ms": 6.166427887154368, "mean_inference_ms": 1.1130899917113073}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1236480, "num_steps_sampled": 1260000, "sample_time_ms": 156025.784, "load_time_ms": 12.812, "grad_time_ms": 902.969, "update_time_ms": 4.5, "learner": {"default_policy": {"cur_kl_coeff": 0.01069076918065548, "cur_lr": 4.999999873689376e-05, "total_loss": 5772.18701171875, "policy_loss": -0.012008480727672577, "vf_loss": 5772.1982421875, "vf_explained_var": -3.887259403256849e-09, "kl": 0.04457264393568039, "entropy": 14.716187477111816, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1260000, "episodes_total": 6300, "training_iteration": 210, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-33-12", "timestamp": 1606266192, "time_this_iter_s": 157.6350965499878, "time_total_s": 36364.551079273224, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 36364.551079273224, "timesteps_since_restore": 1260000, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 29.338222222222225, "ram_util_percent": 61.81244444444444}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -465.1720767045717, "episode_reward_min": -632.5912366333446, "episode_reward_mean": -547.821689317845, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.73911170265974, "mean_processing_ms": 6.166168985550784, "mean_inference_ms": 1.1126272930979093}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1242368, "num_steps_sampled": 1266000, "sample_time_ms": 156507.832, "load_time_ms": 11.931, "grad_time_ms": 886.359, "update_time_ms": 4.499, "learner": {"default_policy": {"cur_kl_coeff": 0.016036152839660645, "cur_lr": 4.999999873689376e-05, "total_loss": 5788.185546875, "policy_loss": -0.00897915381938219, "vf_loss": 5788.1943359375, "vf_explained_var": -9.070271644873173e-09, "kl": 0.0527983084321022, "entropy": 14.10368537902832, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1266000, "episodes_total": 6330, "training_iteration": 211, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-35-52", "timestamp": 1606266352, "time_this_iter_s": 160.03631329536438, "time_total_s": 36524.58739256859, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 36524.58739256859, "timesteps_since_restore": 1266000, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 28.837991266375543, "ram_util_percent": 61.930567685589516}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -466.4271230958867, "episode_reward_min": -632.5912366333446, "episode_reward_mean": -552.1734565445462, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.71630656919842, "mean_processing_ms": 6.16582139906121, "mean_inference_ms": 1.1121481179854626}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1248256, "num_steps_sampled": 1272000, "sample_time_ms": 156496.229, "load_time_ms": 11.394, "grad_time_ms": 867.989, "update_time_ms": 4.172, "learner": {"default_policy": {"cur_kl_coeff": 0.024054229259490967, "cur_lr": 4.999999873689376e-05, "total_loss": 5751.26513671875, "policy_loss": 0.005846893880516291, "vf_loss": 5751.2568359375, "vf_explained_var": -2.073205074282214e-08, "kl": 0.0695556178689003, "entropy": 15.283101081848145, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1272000, "episodes_total": 6360, "training_iteration": 212, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-38-28", "timestamp": 1606266508, "time_this_iter_s": 155.96142292022705, "time_total_s": 36680.548815488815, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 36680.548815488815, "timesteps_since_restore": 1272000, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 29.06126126126126, "ram_util_percent": 62.014864864864876}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -466.4271230958867, "episode_reward_min": -632.5912366333446, "episode_reward_mean": -552.6424744647094, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.69312175876279, "mean_processing_ms": 6.165367173798402, "mean_inference_ms": 1.1116585920942468}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1254144, "num_steps_sampled": 1278000, "sample_time_ms": 156152.77, "load_time_ms": 11.175, "grad_time_ms": 806.016, "update_time_ms": 3.961, "learner": {"default_policy": {"cur_kl_coeff": 0.03608134388923645, "cur_lr": 4.999999873689376e-05, "total_loss": 5776.220703125, "policy_loss": -0.009057199582457542, "vf_loss": 5776.22802734375, "vf_explained_var": -1.036602537141107e-08, "kl": 0.05080293118953705, "entropy": 15.326579093933105, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1278000, "episodes_total": 6390, "training_iteration": 213, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-41-04", "timestamp": 1606266664, "time_this_iter_s": 155.82595372200012, "time_total_s": 36836.374769210815, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 36836.374769210815, "timesteps_since_restore": 1278000, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 28.893721973094177, "ram_util_percent": 62.039910313901345}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -466.4271230958867, "episode_reward_min": -625.0223176612975, "episode_reward_mean": -553.0741564451552, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.67026369081626, "mean_processing_ms": 6.1648355431309, "mean_inference_ms": 1.1111687403559707}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1260032, "num_steps_sampled": 1284000, "sample_time_ms": 156445.449, "load_time_ms": 10.546, "grad_time_ms": 806.026, "update_time_ms": 3.58, "learner": {"default_policy": {"cur_kl_coeff": 0.054122015833854675, "cur_lr": 4.999999873689376e-05, "total_loss": 5722.35302734375, "policy_loss": 0.008526062592864037, "vf_loss": 5722.341796875, "vf_explained_var": -1.8140543289746347e-08, "kl": 0.06065211072564125, "entropy": 14.80810260772705, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1284000, "episodes_total": 6420, "training_iteration": 214, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-43-43", "timestamp": 1606266823, "time_this_iter_s": 158.52777576446533, "time_total_s": 36994.90254497528, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 36994.90254497528, "timesteps_since_restore": 1284000, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 29.223893805309736, "ram_util_percent": 62.01194690265487}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -466.4271230958867, "episode_reward_min": -625.0223176612975, "episode_reward_mean": -549.0923126506193, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.64655576992349, "mean_processing_ms": 6.164316270690829, "mean_inference_ms": 1.1106779801595368}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1265920, "num_steps_sampled": 1290000, "sample_time_ms": 156195.681, "load_time_ms": 11.025, "grad_time_ms": 872.473, "update_time_ms": 3.62, "learner": {"default_policy": {"cur_kl_coeff": 0.08118302375078201, "cur_lr": 4.999999873689376e-05, "total_loss": 5526.4853515625, "policy_loss": -0.005029825959354639, "vf_loss": 5526.486328125, "vf_explained_var": -7.774518806513697e-09, "kl": 0.04797994717955589, "entropy": 14.467225074768066, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1290000, "episodes_total": 6450, "training_iteration": 215, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-46-19", "timestamp": 1606266979, "time_this_iter_s": 155.66871857643127, "time_total_s": 37150.57126355171, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 37150.57126355171, "timesteps_since_restore": 1290000, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 28.786036036036037, "ram_util_percent": 62.05360360360361}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -489.5829641854872, "episode_reward_min": -613.5708944143332, "episode_reward_mean": -549.5178106916127, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.62368299921641, "mean_processing_ms": 6.163856245827358, "mean_inference_ms": 1.110183129787158}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1271808, "num_steps_sampled": 1296000, "sample_time_ms": 156462.679, "load_time_ms": 11.509, "grad_time_ms": 923.586, "update_time_ms": 4.048, "learner": {"default_policy": {"cur_kl_coeff": 0.12177453935146332, "cur_lr": 4.999999873689376e-05, "total_loss": 5809.90673828125, "policy_loss": 0.0026840481441468, "vf_loss": 5809.89794921875, "vf_explained_var": -1.4253284774667918e-08, "kl": 0.0548909492790699, "entropy": 14.240130424499512, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1296000, "episodes_total": 6480, "training_iteration": 216, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-48-56", "timestamp": 1606267136, "time_this_iter_s": 157.8699038028717, "time_total_s": 37308.441167354584, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 37308.441167354584, "timesteps_since_restore": 1296000, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 29.03377777777778, "ram_util_percent": 62.06}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -452.3631327137079, "episode_reward_min": -631.8026606880196, "episode_reward_mean": -548.8512190005937, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.60075764549519, "mean_processing_ms": 6.163337045864719, "mean_inference_ms": 1.109691162168685}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1277696, "num_steps_sampled": 1302000, "sample_time_ms": 156399.424, "load_time_ms": 11.048, "grad_time_ms": 872.676, "update_time_ms": 4.156, "learner": {"default_policy": {"cur_kl_coeff": 0.18266180157661438, "cur_lr": 4.999999873689376e-05, "total_loss": 5649.53759765625, "policy_loss": -0.006901242304593325, "vf_loss": 5649.53857421875, "vf_explained_var": -7.774518806513697e-09, "kl": 0.03472401574254036, "entropy": 15.520771980285645, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1302000, "episodes_total": 6510, "training_iteration": 217, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-51-33", "timestamp": 1606267293, "time_this_iter_s": 156.0657341480255, "time_total_s": 37464.50690150261, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 37464.50690150261, "timesteps_since_restore": 1302000, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 28.9067264573991, "ram_util_percent": 62.11928251121077}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -452.3631327137079, "episode_reward_min": -631.8026606880196, "episode_reward_mean": -551.714696230486, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.57879339444322, "mean_processing_ms": 6.162817237064946, "mean_inference_ms": 1.109214579373692}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1283584, "num_steps_sampled": 1308000, "sample_time_ms": 156474.059, "load_time_ms": 10.605, "grad_time_ms": 847.755, "update_time_ms": 4.212, "learner": {"default_policy": {"cur_kl_coeff": 0.18266180157661438, "cur_lr": 4.999999873689376e-05, "total_loss": 5919.72802734375, "policy_loss": -0.01410069689154625, "vf_loss": 5919.736328125, "vf_explained_var": -1.036602537141107e-08, "kl": 0.030003361403942108, "entropy": 14.89790153503418, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1308000, "episodes_total": 6540, "training_iteration": 218, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-54-10", "timestamp": 1606267450, "time_this_iter_s": 157.59361743927002, "time_total_s": 37622.10051894188, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 37622.10051894188, "timesteps_since_restore": 1308000, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 29.021777777777775, "ram_util_percent": 62.245777777777775}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -452.3631327137079, "episode_reward_min": -631.8026606880196, "episode_reward_mean": -552.3496792571351, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.556348201170465, "mean_processing_ms": 6.1622394056169085, "mean_inference_ms": 1.1087387593914304}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1289472, "num_steps_sampled": 1314000, "sample_time_ms": 156230.13, "load_time_ms": 11.066, "grad_time_ms": 914.679, "update_time_ms": 4.232, "learner": {"default_policy": {"cur_kl_coeff": 0.18266180157661438, "cur_lr": 4.999999873689376e-05, "total_loss": 5739.96533203125, "policy_loss": -0.00023358604812528938, "vf_loss": 5739.95703125, "vf_explained_var": 2.5915063428527674e-09, "kl": 0.04670853167772293, "entropy": 15.478189468383789, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1314000, "episodes_total": 6570, "training_iteration": 219, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-56-47", "timestamp": 1606267607, "time_this_iter_s": 156.47614192962646, "time_total_s": 37778.576660871506, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 37778.576660871506, "timesteps_since_restore": 1314000, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 29.104035874439464, "ram_util_percent": 62.22017937219731}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -478.56510803606426, "episode_reward_min": -648.6271353573422, "episode_reward_mean": -555.4054390353393, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.53435459653488, "mean_processing_ms": 6.161694292001828, "mean_inference_ms": 1.1082784924515274}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1295360, "num_steps_sampled": 1320000, "sample_time_ms": 156227.643, "load_time_ms": 11.22, "grad_time_ms": 917.334, "update_time_ms": 4.529, "learner": {"default_policy": {"cur_kl_coeff": 0.27399271726608276, "cur_lr": 4.999999873689376e-05, "total_loss": 5985.9912109375, "policy_loss": -0.01173949334770441, "vf_loss": 5985.99609375, "vf_explained_var": -1.2957531714263837e-09, "kl": 0.024202201515436172, "entropy": 15.361322402954102, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1320000, "episodes_total": 6600, "training_iteration": 220, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_06-59-24", "timestamp": 1606267764, "time_this_iter_s": 157.64135479927063, "time_total_s": 37936.21801567078, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 37936.21801567078, "timesteps_since_restore": 1320000, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 28.787111111111113, "ram_util_percent": 62.347111111111104}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -478.56510803606426, "episode_reward_min": -693.6075885884242, "episode_reward_mean": -556.1575707300047, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.512419234303195, "mean_processing_ms": 6.161173408844515, "mean_inference_ms": 1.1078198135571666}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1301248, "num_steps_sampled": 1326000, "sample_time_ms": 155929.629, "load_time_ms": 11.2, "grad_time_ms": 864.145, "update_time_ms": 4.493, "learner": {"default_policy": {"cur_kl_coeff": 0.27399271726608276, "cur_lr": 4.999999873689376e-05, "total_loss": 5949.68896484375, "policy_loss": 0.011258980259299278, "vf_loss": 5949.66455078125, "vf_explained_var": -1.4253284774667918e-08, "kl": 0.04775054007768631, "entropy": 15.584356307983398, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1326000, "episodes_total": 6630, "training_iteration": 221, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-02-01", "timestamp": 1606267921, "time_this_iter_s": 156.5242259502411, "time_total_s": 38092.74224162102, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 38092.74224162102, "timesteps_since_restore": 1326000, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 29.032286995515697, "ram_util_percent": 62.426008968609864}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -490.68522207361735, "episode_reward_min": -693.6075885884242, "episode_reward_mean": -558.9569025423148, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.49119334321745, "mean_processing_ms": 6.1607052597450975, "mean_inference_ms": 1.1073861973864048}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1307136, "num_steps_sampled": 1332000, "sample_time_ms": 156125.632, "load_time_ms": 11.905, "grad_time_ms": 954.117, "update_time_ms": 4.459, "learner": {"default_policy": {"cur_kl_coeff": 0.41098907589912415, "cur_lr": 4.999999873689376e-05, "total_loss": 5773.30908203125, "policy_loss": 0.020130261778831482, "vf_loss": 5773.25390625, "vf_explained_var": -1.8140543289746347e-08, "kl": 0.08571545779705048, "entropy": 15.424578666687012, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1332000, "episodes_total": 6660, "training_iteration": 222, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-04-40", "timestamp": 1606268080, "time_this_iter_s": 158.83010625839233, "time_total_s": 38251.57234787941, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 38251.57234787941, "timesteps_since_restore": 1332000, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 29.11013215859031, "ram_util_percent": 62.45374449339205}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -494.1243388987676, "episode_reward_min": -693.6075885884242, "episode_reward_mean": -557.0785339201913, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.47026426844994, "mean_processing_ms": 6.160267482537617, "mean_inference_ms": 1.1069746607971087}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1313024, "num_steps_sampled": 1338000, "sample_time_ms": 156313.144, "load_time_ms": 12.404, "grad_time_ms": 1019.507, "update_time_ms": 4.581, "learner": {"default_policy": {"cur_kl_coeff": 0.6164836287498474, "cur_lr": 4.999999873689376e-05, "total_loss": 5952.875, "policy_loss": -0.01122961100190878, "vf_loss": 5952.8720703125, "vf_explained_var": -1.2957531048130022e-08, "kl": 0.022671746090054512, "entropy": 14.634283065795898, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1338000, "episodes_total": 6690, "training_iteration": 223, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-07-18", "timestamp": 1606268238, "time_this_iter_s": 158.36627984046936, "time_total_s": 38409.93862771988, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 38409.93862771988, "timesteps_since_restore": 1338000, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 29.01283185840708, "ram_util_percent": 62.55176991150443}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -494.1243388987676, "episode_reward_min": -644.7905627453343, "episode_reward_mean": -553.2785046494943, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.449202165592666, "mean_processing_ms": 6.159873144390055, "mean_inference_ms": 1.106570449693093}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1318912, "num_steps_sampled": 1344000, "sample_time_ms": 156134.746, "load_time_ms": 12.033, "grad_time_ms": 952.187, "update_time_ms": 4.978, "learner": {"default_policy": {"cur_kl_coeff": 0.6164836287498474, "cur_lr": 4.999999873689376e-05, "total_loss": 5741.5595703125, "policy_loss": 0.0030388489831238985, "vf_loss": 5741.5341796875, "vf_explained_var": 2.5915063428527674e-09, "kl": 0.0373816192150116, "entropy": 15.7225341796875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1344000, "episodes_total": 6720, "training_iteration": 224, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-09-54", "timestamp": 1606268394, "time_this_iter_s": 156.0666720867157, "time_total_s": 38566.005299806595, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 38566.005299806595, "timesteps_since_restore": 1344000, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 28.98693693693694, "ram_util_percent": 62.54459459459459}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -490.87455530721166, "episode_reward_min": -644.7905627453343, "episode_reward_mean": -553.1520969691219, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.42791128463161, "mean_processing_ms": 6.159546317959159, "mean_inference_ms": 1.1061673228743982}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1324800, "num_steps_sampled": 1350000, "sample_time_ms": 156140.381, "load_time_ms": 12.137, "grad_time_ms": 951.784, "update_time_ms": 4.637, "learner": {"default_policy": {"cur_kl_coeff": 0.6164836287498474, "cur_lr": 4.999999873689376e-05, "total_loss": 5743.9150390625, "policy_loss": -0.005104662850499153, "vf_loss": 5743.90625, "vf_explained_var": 5.183012685705535e-09, "kl": 0.02246110513806343, "entropy": 15.320417404174805, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1350000, "episodes_total": 6750, "training_iteration": 225, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-12-30", "timestamp": 1606268550, "time_this_iter_s": 155.71879196166992, "time_total_s": 38721.724091768265, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 38721.724091768265, "timesteps_since_restore": 1350000, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 29.060538116591925, "ram_util_percent": 62.52825112107623}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -480.59680579222595, "episode_reward_min": -635.7799548184008, "episode_reward_mean": -550.8705045577387, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.40659118380007, "mean_processing_ms": 6.159171696378448, "mean_inference_ms": 1.1057506729742084}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1330688, "num_steps_sampled": 1356000, "sample_time_ms": 156128.52, "load_time_ms": 11.716, "grad_time_ms": 901.148, "update_time_ms": 4.667, "learner": {"default_policy": {"cur_kl_coeff": 0.6164836287498474, "cur_lr": 4.999999873689376e-05, "total_loss": 5779.4931640625, "policy_loss": -0.007725690957158804, "vf_loss": 5779.4873046875, "vf_explained_var": -5.183012685705535e-09, "kl": 0.02220572903752327, "entropy": 15.19459342956543, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1356000, "episodes_total": 6780, "training_iteration": 226, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-15-07", "timestamp": 1606268707, "time_this_iter_s": 157.2402060031891, "time_total_s": 38878.964297771454, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 38878.964297771454, "timesteps_since_restore": 1356000, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 29.128571428571426, "ram_util_percent": 62.648660714285725}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -480.59680579222595, "episode_reward_min": -642.7758119536719, "episode_reward_mean": -553.8406505308284, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.38557028929108, "mean_processing_ms": 6.158762528423073, "mean_inference_ms": 1.1053333706979094}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1336576, "num_steps_sampled": 1362000, "sample_time_ms": 156171.199, "load_time_ms": 11.936, "grad_time_ms": 899.934, "update_time_ms": 4.541, "learner": {"default_policy": {"cur_kl_coeff": 0.6164836287498474, "cur_lr": 4.999999873689376e-05, "total_loss": 5974.56982421875, "policy_loss": 0.0007705987081862986, "vf_loss": 5974.54541015625, "vf_explained_var": -2.2027803581181615e-08, "kl": 0.038487453013658524, "entropy": 15.789642333984375, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1362000, "episodes_total": 6810, "training_iteration": 227, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-17-44", "timestamp": 1606268864, "time_this_iter_s": 156.48195838928223, "time_total_s": 39035.446256160736, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 39035.446256160736, "timesteps_since_restore": 1362000, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 29.09013452914798, "ram_util_percent": 62.71614349775785}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -449.4250588108346, "episode_reward_min": -642.7758119536719, "episode_reward_mean": -549.384894545236, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.36404837038539, "mean_processing_ms": 6.158259931974035, "mean_inference_ms": 1.1048854603613187}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1342464, "num_steps_sampled": 1368000, "sample_time_ms": 155762.998, "load_time_ms": 11.966, "grad_time_ms": 898.965, "update_time_ms": 4.609, "learner": {"default_policy": {"cur_kl_coeff": 0.6164836287498474, "cur_lr": 4.999999873689376e-05, "total_loss": 5448.33984375, "policy_loss": -0.002768447156995535, "vf_loss": 5448.32958984375, "vf_explained_var": 5.183012685705535e-09, "kl": 0.020909873768687248, "entropy": 14.969836235046387, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1368000, "episodes_total": 6840, "training_iteration": 228, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-20-17", "timestamp": 1606269017, "time_this_iter_s": 153.50338101387024, "time_total_s": 39188.949637174606, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 39188.949637174606, "timesteps_since_restore": 1368000, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 28.784474885844745, "ram_util_percent": 62.7351598173516}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -449.4250588108346, "episode_reward_min": -645.744956160086, "episode_reward_mean": -551.7085739590425, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.34280392985682, "mean_processing_ms": 6.157793015215509, "mean_inference_ms": 1.1044410655217232}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1348352, "num_steps_sampled": 1374000, "sample_time_ms": 155881.2, "load_time_ms": 12.062, "grad_time_ms": 898.278, "update_time_ms": 4.587, "learner": {"default_policy": {"cur_kl_coeff": 0.6164836287498474, "cur_lr": 4.999999873689376e-05, "total_loss": 5933.17919921875, "policy_loss": -0.004913733806461096, "vf_loss": 5933.16845703125, "vf_explained_var": 7.774518806513697e-09, "kl": 0.027411628514528275, "entropy": 15.289652824401855, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1374000, "episodes_total": 6870, "training_iteration": 229, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-22-55", "timestamp": 1606269175, "time_this_iter_s": 157.6544473171234, "time_total_s": 39346.60408449173, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 39346.60408449173, "timesteps_since_restore": 1374000, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 29.094666666666665, "ram_util_percent": 62.84044444444444}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -449.4250588108346, "episode_reward_min": -645.744956160086, "episode_reward_mean": -550.3965920920903, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.3220243846724, "mean_processing_ms": 6.157304943753761, "mean_inference_ms": 1.104017410051257}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1354240, "num_steps_sampled": 1380000, "sample_time_ms": 155800.589, "load_time_ms": 12.464, "grad_time_ms": 964.742, "update_time_ms": 4.734, "learner": {"default_policy": {"cur_kl_coeff": 0.6164836287498474, "cur_lr": 4.999999873689376e-05, "total_loss": 5705.05908203125, "policy_loss": -0.0056379144079983234, "vf_loss": 5705.048828125, "vf_explained_var": 1.2957531714263837e-09, "kl": 0.025169212371110916, "entropy": 15.419426918029785, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1380000, "episodes_total": 6900, "training_iteration": 230, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-25-33", "timestamp": 1606269333, "time_this_iter_s": 157.509703874588, "time_total_s": 39504.11378836632, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 39504.11378836632, "timesteps_since_restore": 1380000, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 29.05688888888889, "ram_util_percent": 62.90133333333333}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -451.64493787505216, "episode_reward_min": -645.744956160086, "episode_reward_mean": -554.3417113216399, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.301426818669654, "mean_processing_ms": 6.156919206271443, "mean_inference_ms": 1.1036037133697314}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1360128, "num_steps_sampled": 1386000, "sample_time_ms": 155620.988, "load_time_ms": 12.175, "grad_time_ms": 964.742, "update_time_ms": 5.318, "learner": {"default_policy": {"cur_kl_coeff": 0.6164836287498474, "cur_lr": 4.999999873689376e-05, "total_loss": 5913.1982421875, "policy_loss": 0.026180889457464218, "vf_loss": 5913.13330078125, "vf_explained_var": -2.5915063428527674e-09, "kl": 0.06349346786737442, "entropy": 15.438244819641113, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1386000, "episodes_total": 6930, "training_iteration": 231, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-28-07", "timestamp": 1606269487, "time_this_iter_s": 154.7314534187317, "time_total_s": 39658.84524178505, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 39658.84524178505, "timesteps_since_restore": 1386000, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 29.20678733031674, "ram_util_percent": 62.840723981900446}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -451.64493787505216, "episode_reward_min": -630.5351883978079, "episode_reward_mean": -555.8714149289455, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.28194812381838, "mean_processing_ms": 6.1565517387575195, "mean_inference_ms": 1.1032197700138309}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1366016, "num_steps_sampled": 1392000, "sample_time_ms": 155679.0, "load_time_ms": 11.302, "grad_time_ms": 876.272, "update_time_ms": 5.28, "learner": {"default_policy": {"cur_kl_coeff": 0.9247254133224487, "cur_lr": 4.999999873689376e-05, "total_loss": 5992.408203125, "policy_loss": 0.0003423002490308136, "vf_loss": 5992.38720703125, "vf_explained_var": 0.0, "kl": 0.023450903594493866, "entropy": 14.983940124511719, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1392000, "episodes_total": 6960, "training_iteration": 232, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-30-46", "timestamp": 1606269646, "time_this_iter_s": 158.51276278495789, "time_total_s": 39817.35800457001, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 39817.35800457001, "timesteps_since_restore": 1392000, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 29.145575221238936, "ram_util_percent": 62.95840707964601}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -451.64493787505216, "episode_reward_min": -630.5351883978079, "episode_reward_mean": -554.1073399619363, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.262319100266176, "mean_processing_ms": 6.156130348966545, "mean_inference_ms": 1.1028132495447822}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1371904, "num_steps_sampled": 1398000, "sample_time_ms": 155474.133, "load_time_ms": 11.327, "grad_time_ms": 876.416, "update_time_ms": 5.029, "learner": {"default_policy": {"cur_kl_coeff": 0.9247254133224487, "cur_lr": 4.999999873689376e-05, "total_loss": 5690.7197265625, "policy_loss": -0.0037868451327085495, "vf_loss": 5690.7060546875, "vf_explained_var": -1.2957531714263837e-09, "kl": 0.01912667788565159, "entropy": 14.7614107131958, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1398000, "episodes_total": 6990, "training_iteration": 233, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-33-22", "timestamp": 1606269802, "time_this_iter_s": 156.3160901069641, "time_total_s": 39973.67409467697, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 39973.67409467697, "timesteps_since_restore": 1398000, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 29.226008968609865, "ram_util_percent": 62.97488789237667}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -469.92880712802906, "episode_reward_min": -630.5351883978079, "episode_reward_mean": -550.8198103376129, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.243073534545054, "mean_processing_ms": 6.155719064227546, "mean_inference_ms": 1.1024071896810377}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1377792, "num_steps_sampled": 1404000, "sample_time_ms": 155526.641, "load_time_ms": 11.829, "grad_time_ms": 908.726, "update_time_ms": 5.0, "learner": {"default_policy": {"cur_kl_coeff": 0.9247254133224487, "cur_lr": 4.999999873689376e-05, "total_loss": 5600.47900390625, "policy_loss": -0.005570397246629, "vf_loss": 5600.46240234375, "vf_explained_var": -1.684479045138687e-08, "kl": 0.023997901007533073, "entropy": 15.204607963562012, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1404000, "episodes_total": 7020, "training_iteration": 234, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-35-59", "timestamp": 1606269959, "time_this_iter_s": 156.92010974884033, "time_total_s": 40130.59420442581, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 40130.59420442581, "timesteps_since_restore": 1404000, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 29.034375000000004, "ram_util_percent": 62.99374999999999}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -469.3579725571285, "episode_reward_min": -639.3086414501504, "episode_reward_mean": -547.6319626737882, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.22313974336936, "mean_processing_ms": 6.155324008195898, "mean_inference_ms": 1.1019911628568155}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1383680, "num_steps_sampled": 1410000, "sample_time_ms": 155631.701, "load_time_ms": 11.831, "grad_time_ms": 909.447, "update_time_ms": 5.074, "learner": {"default_policy": {"cur_kl_coeff": 0.9247254133224487, "cur_lr": 4.999999873689376e-05, "total_loss": 5794.11767578125, "policy_loss": -0.012105163186788559, "vf_loss": 5794.11767578125, "vf_explained_var": 5.183012685705535e-09, "kl": 0.013736966997385025, "entropy": 15.66414737701416, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1410000, "episodes_total": 7050, "training_iteration": 235, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-38-36", "timestamp": 1606270116, "time_this_iter_s": 156.7777795791626, "time_total_s": 40287.371984004974, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 40287.371984004974, "timesteps_since_restore": 1410000, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 29.005803571428572, "ram_util_percent": 63.050000000000004}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -469.3579725571285, "episode_reward_min": -639.3086414501504, "episode_reward_mean": -553.7723407640174, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.20357779859927, "mean_processing_ms": 6.155022226730939, "mean_inference_ms": 1.1015900876915714}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1389568, "num_steps_sampled": 1416000, "sample_time_ms": 155666.198, "load_time_ms": 12.334, "grad_time_ms": 944.654, "update_time_ms": 5.088, "learner": {"default_policy": {"cur_kl_coeff": 0.9247254133224487, "cur_lr": 4.999999873689376e-05, "total_loss": 6210.7744140625, "policy_loss": -0.008844548836350441, "vf_loss": 6210.76611328125, "vf_explained_var": -1.2957531048130022e-08, "kl": 0.018772544339299202, "entropy": 15.420881271362305, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1416000, "episodes_total": 7080, "training_iteration": 236, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-41-14", "timestamp": 1606270274, "time_this_iter_s": 157.9423005580902, "time_total_s": 40445.314284563065, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 40445.314284563065, "timesteps_since_restore": 1416000, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 28.98622222222222, "ram_util_percent": 62.968888888888884}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -469.3579725571285, "episode_reward_min": -648.2235408043513, "episode_reward_mean": -558.8525353723585, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.18405026524186, "mean_processing_ms": 6.154748296510271, "mean_inference_ms": 1.1011998317401064}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1395456, "num_steps_sampled": 1422000, "sample_time_ms": 155726.78, "load_time_ms": 12.657, "grad_time_ms": 1011.488, "update_time_ms": 5.108, "learner": {"default_policy": {"cur_kl_coeff": 0.9247254133224487, "cur_lr": 4.999999873689376e-05, "total_loss": 5942.4462890625, "policy_loss": 0.008374140597879887, "vf_loss": 5942.40234375, "vf_explained_var": -9.070271644873173e-09, "kl": 0.039010558277368546, "entropy": 15.510915756225586, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1422000, "episodes_total": 7110, "training_iteration": 237, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-43-52", "timestamp": 1606270432, "time_this_iter_s": 157.76295709609985, "time_total_s": 40603.077241659164, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 40603.077241659164, "timesteps_since_restore": 1422000, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 29.041777777777778, "ram_util_percent": 61.94400000000001}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -481.7194876695447, "episode_reward_min": -648.2235408043513, "episode_reward_mean": -559.2967603424083, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.164963656544444, "mean_processing_ms": 6.1544100919058975, "mean_inference_ms": 1.100806272551058}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1401344, "num_steps_sampled": 1428000, "sample_time_ms": 155915.415, "load_time_ms": 12.67, "grad_time_ms": 1011.05, "update_time_ms": 5.154, "learner": {"default_policy": {"cur_kl_coeff": 0.9247254133224487, "cur_lr": 4.999999873689376e-05, "total_loss": 5806.90087890625, "policy_loss": -0.005199949722737074, "vf_loss": 5806.88525390625, "vf_explained_var": -9.070271644873173e-09, "kl": 0.023116324096918106, "entropy": 16.079269409179688, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1428000, "episodes_total": 7140, "training_iteration": 238, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-46-27", "timestamp": 1606270587, "time_this_iter_s": 155.38566493988037, "time_total_s": 40758.462906599045, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 40758.462906599045, "timesteps_since_restore": 1428000, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 29.022972972972976, "ram_util_percent": 60.58333333333334}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -481.7194876695447, "episode_reward_min": -648.2235408043513, "episode_reward_mean": -555.24427722752, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.145653988259454, "mean_processing_ms": 6.154055546724364, "mean_inference_ms": 1.1004008153783702}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1407232, "num_steps_sampled": 1434000, "sample_time_ms": 155852.289, "load_time_ms": 12.369, "grad_time_ms": 947.264, "update_time_ms": 5.112, "learner": {"default_policy": {"cur_kl_coeff": 0.9247254133224487, "cur_lr": 4.999999873689376e-05, "total_loss": 5814.3486328125, "policy_loss": -0.00497537711635232, "vf_loss": 5814.33642578125, "vf_explained_var": -1.2957531048130022e-08, "kl": 0.017766112461686134, "entropy": 15.838479995727539, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1434000, "episodes_total": 7170, "training_iteration": 239, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-49-04", "timestamp": 1606270744, "time_this_iter_s": 156.37622618675232, "time_total_s": 40914.8391327858, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 40914.8391327858, "timesteps_since_restore": 1434000, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 29.117040358744397, "ram_util_percent": 60.62017937219732}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -481.7194876695447, "episode_reward_min": -635.3835653905915, "episode_reward_mean": -550.0336014445049, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.125995991080515, "mean_processing_ms": 6.153732411849921, "mean_inference_ms": 1.0999935894783615}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1413120, "num_steps_sampled": 1440000, "sample_time_ms": 155797.895, "load_time_ms": 11.864, "grad_time_ms": 878.017, "update_time_ms": 4.65, "learner": {"default_policy": {"cur_kl_coeff": 0.9247254133224487, "cur_lr": 4.999999873689376e-05, "total_loss": 5644.642578125, "policy_loss": 0.0007610066095367074, "vf_loss": 5644.615234375, "vf_explained_var": -1.5549037613027394e-08, "kl": 0.02879626676440239, "entropy": 15.797575950622559, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1440000, "episodes_total": 7200, "training_iteration": 240, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-51-40", "timestamp": 1606270900, "time_this_iter_s": 156.25925612449646, "time_total_s": 41071.09838891029, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 41071.09838891029, "timesteps_since_restore": 1440000, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 29.066367713004485, "ram_util_percent": 60.63183856502243}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -485.08181296476994, "episode_reward_min": -598.9821472428407, "episode_reward_mean": -547.2501406386872, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.106674988451225, "mean_processing_ms": 6.153482169419583, "mean_inference_ms": 1.0996007750784522}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1419008, "num_steps_sampled": 1446000, "sample_time_ms": 155962.807, "load_time_ms": 11.793, "grad_time_ms": 881.493, "update_time_ms": 4.022, "learner": {"default_policy": {"cur_kl_coeff": 0.9247254133224487, "cur_lr": 4.999999873689376e-05, "total_loss": 5802.01513671875, "policy_loss": 0.013875415548682213, "vf_loss": 5801.9638671875, "vf_explained_var": -2.5915063428527674e-09, "kl": 0.04045620560646057, "entropy": 14.811563491821289, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1446000, "episodes_total": 7230, "training_iteration": 241, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-54-16", "timestamp": 1606271056, "time_this_iter_s": 156.4077227115631, "time_total_s": 41227.50611162186, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 41227.50611162186, "timesteps_since_restore": 1446000, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 29.1237668161435, "ram_util_percent": 60.79910313901344}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -482.8375662434171, "episode_reward_min": -641.0385276343646, "episode_reward_mean": -547.943201462505, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.08726859697147, "mean_processing_ms": 6.153330953341251, "mean_inference_ms": 1.0992218640326052}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1424896, "num_steps_sampled": 1452000, "sample_time_ms": 155746.331, "load_time_ms": 12.97, "grad_time_ms": 897.853, "update_time_ms": 4.069, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 5790.07080078125, "policy_loss": -0.00871629174798727, "vf_loss": 5790.06396484375, "vf_explained_var": 1.1661778209770546e-08, "kl": 0.011217514984309673, "entropy": 15.974693298339844, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1452000, "episodes_total": 7260, "training_iteration": 242, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-56-53", "timestamp": 1606271213, "time_this_iter_s": 156.52433705329895, "time_total_s": 41384.030448675156, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 41384.030448675156, "timesteps_since_restore": 1452000, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 28.85695067264574, "ram_util_percent": 60.687892376681624}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -482.8375662434171, "episode_reward_min": -641.0385276343646, "episode_reward_mean": -550.6623126304675, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.06792366118256, "mean_processing_ms": 6.153210197196394, "mean_inference_ms": 1.0988548048837108}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1430784, "num_steps_sampled": 1458000, "sample_time_ms": 155658.049, "load_time_ms": 12.472, "grad_time_ms": 831.114, "update_time_ms": 4.07, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 5884.42529296875, "policy_loss": -0.00440042233094573, "vf_loss": 5884.4111328125, "vf_explained_var": -3.887259403256849e-09, "kl": 0.01407517958432436, "entropy": 15.611812591552734, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1458000, "episodes_total": 7290, "training_iteration": 243, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_07-59-28", "timestamp": 1606271368, "time_this_iter_s": 154.75719571113586, "time_total_s": 41538.78764438629, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 41538.78764438629, "timesteps_since_restore": 1458000, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 28.958823529411763, "ram_util_percent": 60.893665158371036}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -482.2061697219647, "episode_reward_min": -641.0385276343646, "episode_reward_mean": -550.5493332045128, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.04821202831203, "mean_processing_ms": 6.15309750719549, "mean_inference_ms": 1.0984966727878291}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1436672, "num_steps_sampled": 1464000, "sample_time_ms": 155604.761, "load_time_ms": 11.98, "grad_time_ms": 798.744, "update_time_ms": 3.731, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 5782.82470703125, "policy_loss": -0.0048902095295488834, "vf_loss": 5782.80859375, "vf_explained_var": -9.070271644873173e-09, "kl": 0.015221429988741875, "entropy": 15.728991508483887, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1464000, "episodes_total": 7320, "training_iteration": 244, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-02-04", "timestamp": 1606271524, "time_this_iter_s": 156.05844569206238, "time_total_s": 41694.846090078354, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 41694.846090078354, "timesteps_since_restore": 1464000, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 28.920179372197307, "ram_util_percent": 60.963677130044836}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -482.2061697219647, "episode_reward_min": -641.0385276343646, "episode_reward_mean": -552.2144236055409, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.02886970696129, "mean_processing_ms": 6.152877946047361, "mean_inference_ms": 1.098136657554326}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1442560, "num_steps_sampled": 1470000, "sample_time_ms": 155645.328, "load_time_ms": 11.647, "grad_time_ms": 729.73, "update_time_ms": 3.981, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 5893.2783203125, "policy_loss": -0.006875625811517239, "vf_loss": 5893.26513671875, "vf_explained_var": -3.887259403256849e-09, "kl": 0.01409033965319395, "entropy": 15.981951713562012, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1470000, "episodes_total": 7350, "training_iteration": 245, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-04-40", "timestamp": 1606271680, "time_this_iter_s": 156.48901391029358, "time_total_s": 41851.33510398865, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 41851.33510398865, "timesteps_since_restore": 1470000, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 28.852466367713006, "ram_util_percent": 61.01390134529147}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -482.2061697219647, "episode_reward_min": -646.3197212457068, "episode_reward_mean": -553.7648604840415, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.01049248146383, "mean_processing_ms": 6.1525564480391655, "mean_inference_ms": 1.09778082321344}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1448448, "num_steps_sampled": 1476000, "sample_time_ms": 155811.853, "load_time_ms": 11.157, "grad_time_ms": 695.919, "update_time_ms": 3.579, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 6023.6787109375, "policy_loss": -0.01204141415655613, "vf_loss": 6023.67236328125, "vf_explained_var": -5.183012685705535e-09, "kl": 0.012936764396727085, "entropy": 15.486739158630371, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1476000, "episodes_total": 7380, "training_iteration": 246, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-07-20", "timestamp": 1606271840, "time_this_iter_s": 159.2605848312378, "time_total_s": 42010.595688819885, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 42010.595688819885, "timesteps_since_restore": 1476000, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 28.984140969162993, "ram_util_percent": 60.94317180616739}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -495.1056867771449, "episode_reward_min": -646.3197212457068, "episode_reward_mean": -555.5742838420301, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.99236273724273, "mean_processing_ms": 6.152198916075252, "mean_inference_ms": 1.097400762762916}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1454336, "num_steps_sampled": 1482000, "sample_time_ms": 155641.546, "load_time_ms": 11.649, "grad_time_ms": 692.671, "update_time_ms": 3.622, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 5901.34228515625, "policy_loss": -0.011055432260036469, "vf_loss": 5901.3330078125, "vf_explained_var": -1.2957531714263837e-09, "kl": 0.01435787882655859, "entropy": 16.187864303588867, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1482000, "episodes_total": 7410, "training_iteration": 247, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-09-56", "timestamp": 1606271996, "time_this_iter_s": 156.0301239490509, "time_total_s": 42166.625812768936, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 42166.625812768936, "timesteps_since_restore": 1482000, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 29.227354260089687, "ram_util_percent": 60.9183856502242}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -491.5582364370525, "episode_reward_min": -646.3197212457068, "episode_reward_mean": -556.4377488982964, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.97477499243794, "mean_processing_ms": 6.15182148381892, "mean_inference_ms": 1.0970149768404052}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1460224, "num_steps_sampled": 1488000, "sample_time_ms": 155777.584, "load_time_ms": 12.652, "grad_time_ms": 760.704, "update_time_ms": 3.55, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 5952.3310546875, "policy_loss": 0.003980157896876335, "vf_loss": 5952.296875, "vf_explained_var": -2.073205074282214e-08, "kl": 0.02167178876698017, "entropy": 14.93120002746582, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1488000, "episodes_total": 7440, "training_iteration": 248, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-12-33", "timestamp": 1606272153, "time_this_iter_s": 157.4398832321167, "time_total_s": 42324.06569600105, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 42324.06569600105, "timesteps_since_restore": 1488000, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 28.868303571428573, "ram_util_percent": 60.837053571428555}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -491.5582364370525, "episode_reward_min": -646.3197212457068, "episode_reward_mean": -557.691525822965, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.957939189043735, "mean_processing_ms": 6.151514574382722, "mean_inference_ms": 1.0966447903309278}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1466112, "num_steps_sampled": 1494000, "sample_time_ms": 155985.186, "load_time_ms": 12.299, "grad_time_ms": 758.517, "update_time_ms": 3.93, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 6044.36962890625, "policy_loss": 0.008426601067185402, "vf_loss": 6044.32470703125, "vf_explained_var": 1.2957531048130022e-08, "kl": 0.026901284232735634, "entropy": 15.459001541137695, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1494000, "episodes_total": 7470, "training_iteration": 249, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-15-12", "timestamp": 1606272312, "time_this_iter_s": 158.4302258491516, "time_total_s": 42482.495921850204, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 42482.495921850204, "timesteps_since_restore": 1494000, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 29.315418502202643, "ram_util_percent": 60.939207048458144}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -477.7463591561479, "episode_reward_min": -627.97563981969, "episode_reward_mean": -555.3937039725691, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.9410083386157, "mean_processing_ms": 6.151250585800147, "mean_inference_ms": 1.0962894348897654}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1472000, "num_steps_sampled": 1500000, "sample_time_ms": 155917.024, "load_time_ms": 12.15, "grad_time_ms": 760.015, "update_time_ms": 3.895, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 5845.2138671875, "policy_loss": -0.007164201233536005, "vf_loss": 5845.201171875, "vf_explained_var": -2.5915063428527674e-09, "kl": 0.014180310070514679, "entropy": 16.627981185913086, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1500000, "episodes_total": 7500, "training_iteration": 250, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-17-47", "timestamp": 1606272467, "time_this_iter_s": 155.59026646614075, "time_total_s": 42638.086188316345, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 42638.086188316345, "timesteps_since_restore": 1500000, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 29.004504504504503, "ram_util_percent": 60.99054054054053}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -477.7463591561479, "episode_reward_min": -648.3142930454283, "episode_reward_mean": -557.3868535152345, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.92418541710665, "mean_processing_ms": 6.150962810207211, "mean_inference_ms": 1.0959425344471996}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1477888, "num_steps_sampled": 1506000, "sample_time_ms": 155862.148, "load_time_ms": 12.454, "grad_time_ms": 826.267, "update_time_ms": 3.94, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 6120.2431640625, "policy_loss": 0.00035503823892213404, "vf_loss": 6120.21875, "vf_explained_var": -1.036602537141107e-08, "kl": 0.016881834715604782, "entropy": 16.178882598876953, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1506000, "episodes_total": 7530, "training_iteration": 251, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-20-24", "timestamp": 1606272624, "time_this_iter_s": 156.5291063785553, "time_total_s": 42794.6152946949, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 42794.6152946949, "timesteps_since_restore": 1506000, "iterations_since_restore": 251, "perf": {"cpu_util_percent": 28.956502242152467, "ram_util_percent": 61.026008968609865}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -477.7463591561479, "episode_reward_min": -648.3142930454283, "episode_reward_mean": -556.0802028321937, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.907047508014884, "mean_processing_ms": 6.150675301837477, "mean_inference_ms": 1.095592869592381}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1483776, "num_steps_sampled": 1512000, "sample_time_ms": 156093.18, "load_time_ms": 11.12, "grad_time_ms": 808.689, "update_time_ms": 4.227, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 5905.671875, "policy_loss": -0.007676195818930864, "vf_loss": 5905.65478515625, "vf_explained_var": -1.2957531714263837e-09, "kl": 0.017295580357313156, "entropy": 15.803924560546875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1512000, "episodes_total": 7560, "training_iteration": 252, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-23-03", "timestamp": 1606272783, "time_this_iter_s": 158.6475112438202, "time_total_s": 42953.26280593872, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 42953.26280593872, "timesteps_since_restore": 1512000, "iterations_since_restore": 252, "perf": {"cpu_util_percent": 28.7646017699115, "ram_util_percent": 61.067699115044256}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -462.62170896027084, "episode_reward_min": -648.3142930454283, "episode_reward_mean": -559.5811235830266, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.88970015934455, "mean_processing_ms": 6.150380598620568, "mean_inference_ms": 1.0952421982224845}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1489664, "num_steps_sampled": 1518000, "sample_time_ms": 156232.642, "load_time_ms": 11.028, "grad_time_ms": 831.393, "update_time_ms": 4.238, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 6122.9248046875, "policy_loss": -0.0070075080730021, "vf_loss": 6122.91552734375, "vf_explained_var": -6.478765524065011e-09, "kl": 0.011748324148356915, "entropy": 16.363279342651367, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1518000, "episodes_total": 7590, "training_iteration": 253, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-25-39", "timestamp": 1606272939, "time_this_iter_s": 156.37858843803406, "time_total_s": 43109.641394376755, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 43109.641394376755, "timesteps_since_restore": 1518000, "iterations_since_restore": 253, "perf": {"cpu_util_percent": 28.729596412556056, "ram_util_percent": 61.201345291479825}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -462.62170896027084, "episode_reward_min": -633.7014130763876, "episode_reward_mean": -559.6448008512583, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.87287841932055, "mean_processing_ms": 6.150085438943631, "mean_inference_ms": 1.0949097037519624}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1495552, "num_steps_sampled": 1524000, "sample_time_ms": 156484.017, "load_time_ms": 11.303, "grad_time_ms": 878.592, "update_time_ms": 4.353, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 6114.638671875, "policy_loss": -0.002876020735129714, "vf_loss": 6114.6220703125, "vf_explained_var": 7.774518806513697e-09, "kl": 0.01313246600329876, "entropy": 15.36058235168457, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1524000, "episodes_total": 7620, "training_iteration": 254, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-28-18", "timestamp": 1606273098, "time_this_iter_s": 159.04405570030212, "time_total_s": 43268.68545007706, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 43268.68545007706, "timesteps_since_restore": 1524000, "iterations_since_restore": 254, "perf": {"cpu_util_percent": 28.905286343612335, "ram_util_percent": 61.21718061674009}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -462.62170896027084, "episode_reward_min": -633.7014130763876, "episode_reward_mean": -559.369477104346, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.856542420298894, "mean_processing_ms": 6.149761892281735, "mean_inference_ms": 1.0945777522131739}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1501440, "num_steps_sampled": 1530000, "sample_time_ms": 156465.479, "load_time_ms": 11.23, "grad_time_ms": 878.543, "update_time_ms": 4.12, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 5961.328125, "policy_loss": -0.008985722437500954, "vf_loss": 5961.31396484375, "vf_explained_var": -1.5549037613027394e-08, "kl": 0.016545569524168968, "entropy": 14.662081718444824, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1530000, "episodes_total": 7650, "training_iteration": 255, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-30-54", "timestamp": 1606273254, "time_this_iter_s": 156.30020475387573, "time_total_s": 43424.98565483093, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 43424.98565483093, "timesteps_since_restore": 1530000, "iterations_since_restore": 255, "perf": {"cpu_util_percent": 29.171748878923765, "ram_util_percent": 61.307623318385644}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -476.57951450117565, "episode_reward_min": -633.7014130763876, "episode_reward_mean": -558.0234047901336, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.840600758048105, "mean_processing_ms": 6.149438371473184, "mean_inference_ms": 1.0942561097004633}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1507328, "num_steps_sampled": 1536000, "sample_time_ms": 156386.135, "load_time_ms": 12.609, "grad_time_ms": 944.716, "update_time_ms": 4.152, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 5992.548828125, "policy_loss": -0.005334198009222746, "vf_loss": 5992.53271484375, "vf_explained_var": -3.887259403256849e-09, "kl": 0.014811416156589985, "entropy": 15.550150871276855, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1536000, "episodes_total": 7680, "training_iteration": 256, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-33-33", "timestamp": 1606273413, "time_this_iter_s": 159.146635055542, "time_total_s": 43584.132289886475, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 43584.132289886475, "timesteps_since_restore": 1536000, "iterations_since_restore": 256, "perf": {"cpu_util_percent": 29.41850220264317, "ram_util_percent": 61.45374449339205}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -476.57951450117565, "episode_reward_min": -636.3608997395814, "episode_reward_mean": -553.7632740377409, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.82506524110367, "mean_processing_ms": 6.149114481420373, "mean_inference_ms": 1.0939395299780525}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1513216, "num_steps_sampled": 1542000, "sample_time_ms": 156639.621, "load_time_ms": 11.714, "grad_time_ms": 881.146, "update_time_ms": 4.478, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 5974.2705078125, "policy_loss": 0.0029999406542629004, "vf_loss": 5974.23388671875, "vf_explained_var": -1.2957531048130022e-08, "kl": 0.024033306166529655, "entropy": 15.76462459564209, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1542000, "episodes_total": 7710, "training_iteration": 257, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-36-11", "timestamp": 1606273571, "time_this_iter_s": 157.92247414588928, "time_total_s": 43742.054764032364, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 43742.054764032364, "timesteps_since_restore": 1542000, "iterations_since_restore": 257, "perf": {"cpu_util_percent": 29.005309734513272, "ram_util_percent": 61.504867256637176}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -460.9794334689517, "episode_reward_min": -640.3667162432414, "episode_reward_mean": -553.0292458670189, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.809644632437205, "mean_processing_ms": 6.148787064389735, "mean_inference_ms": 1.093605634158917}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1519104, "num_steps_sampled": 1548000, "sample_time_ms": 156680.092, "load_time_ms": 12.912, "grad_time_ms": 830.08, "update_time_ms": 4.49, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 5956.1669921875, "policy_loss": -0.003837380325421691, "vf_loss": 5956.1513671875, "vf_explained_var": -9.070271644873173e-09, "kl": 0.014004561118781567, "entropy": 15.28159236907959, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1548000, "episodes_total": 7740, "training_iteration": 258, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-38-49", "timestamp": 1606273729, "time_this_iter_s": 157.3418800830841, "time_total_s": 43899.39664411545, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 43899.39664411545, "timesteps_since_restore": 1548000, "iterations_since_restore": 258, "perf": {"cpu_util_percent": 29.130803571428572, "ram_util_percent": 61.571875}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -460.9794334689517, "episode_reward_min": -640.3667162432414, "episode_reward_mean": -550.7811120761747, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.79377859570306, "mean_processing_ms": 6.148570652988728, "mean_inference_ms": 1.0932915043452434}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1524992, "num_steps_sampled": 1554000, "sample_time_ms": 156482.985, "load_time_ms": 13.333, "grad_time_ms": 829.755, "update_time_ms": 4.197, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 5915.1044921875, "policy_loss": -0.010162903927266598, "vf_loss": 5915.10009765625, "vf_explained_var": -1.036602537141107e-08, "kl": 0.01074266992509365, "entropy": 15.049707412719727, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1554000, "episodes_total": 7770, "training_iteration": 259, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-41-25", "timestamp": 1606273885, "time_this_iter_s": 156.45781588554382, "time_total_s": 44055.85446000099, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 44055.85446000099, "timesteps_since_restore": 1554000, "iterations_since_restore": 259, "perf": {"cpu_util_percent": 28.90762331838565, "ram_util_percent": 61.59147982062781}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -460.9794334689517, "episode_reward_min": -649.7255688333003, "episode_reward_mean": -550.3937885906043, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.777869906370135, "mean_processing_ms": 6.14836461468845, "mean_inference_ms": 1.0930116979854612}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1530880, "num_steps_sampled": 1560000, "sample_time_ms": 156701.976, "load_time_ms": 13.524, "grad_time_ms": 828.65, "update_time_ms": 4.218, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 5893.90576171875, "policy_loss": 0.010606292635202408, "vf_loss": 5893.85205078125, "vf_explained_var": -6.478765524065011e-09, "kl": 0.031138500198721886, "entropy": 15.252274513244629, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1560000, "episodes_total": 7800, "training_iteration": 260, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-44-03", "timestamp": 1606274043, "time_this_iter_s": 157.77206993103027, "time_total_s": 44213.62652993202, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 44213.62652993202, "timesteps_since_restore": 1560000, "iterations_since_restore": 260, "perf": {"cpu_util_percent": 28.770666666666664, "ram_util_percent": 61.65200000000001}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -456.458933434766, "episode_reward_min": -649.7255688333003, "episode_reward_mean": -551.869849544225, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.76176536968569, "mean_processing_ms": 6.148129651706467, "mean_inference_ms": 1.0927637663901018}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1536768, "num_steps_sampled": 1566000, "sample_time_ms": 156695.553, "load_time_ms": 13.642, "grad_time_ms": 814.382, "update_time_ms": 4.255, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 6073.3330078125, "policy_loss": -0.012890249490737915, "vf_loss": 6073.33154296875, "vf_explained_var": -2.5915063428527674e-09, "kl": 0.010269386693835258, "entropy": 15.543416976928711, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1566000, "episodes_total": 7830, "training_iteration": 261, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-46-39", "timestamp": 1606274199, "time_this_iter_s": 156.32376909255981, "time_total_s": 44369.95029902458, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 44369.95029902458, "timesteps_since_restore": 1566000, "iterations_since_restore": 261, "perf": {"cpu_util_percent": 29.24241071428571, "ram_util_percent": 61.83660714285714}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -456.458933434766, "episode_reward_min": -649.7255688333003, "episode_reward_mean": -552.7509181162907, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.74610991620319, "mean_processing_ms": 6.147842920956548, "mean_inference_ms": 1.0925191897992488}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1542656, "num_steps_sampled": 1572000, "sample_time_ms": 156516.95, "load_time_ms": 13.727, "grad_time_ms": 817.264, "update_time_ms": 4.252, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 6023.482421875, "policy_loss": -0.00737709691748023, "vf_loss": 6023.470703125, "vf_explained_var": -6.478765524065011e-09, "kl": 0.013791408389806747, "entropy": 15.371527671813965, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1572000, "episodes_total": 7860, "training_iteration": 262, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-49-16", "timestamp": 1606274356, "time_this_iter_s": 156.89123463630676, "time_total_s": 44526.84153366089, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 44526.84153366089, "timesteps_since_restore": 1572000, "iterations_since_restore": 262, "perf": {"cpu_util_percent": 28.78206278026906, "ram_util_percent": 61.86816143497757}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -456.458933434766, "episode_reward_min": -628.2100362432602, "episode_reward_mean": -554.0210697271679, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.73101033377574, "mean_processing_ms": 6.147621380449173, "mean_inference_ms": 1.0922584321517315}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1548544, "num_steps_sampled": 1578000, "sample_time_ms": 156670.584, "load_time_ms": 14.293, "grad_time_ms": 804.759, "update_time_ms": 4.272, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 6016.17236328125, "policy_loss": -0.0041448501870036125, "vf_loss": 6016.15625, "vf_explained_var": 1.4253284774667918e-08, "kl": 0.014412707649171352, "entropy": 15.222901344299316, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1578000, "episodes_total": 7890, "training_iteration": 263, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-51-54", "timestamp": 1606274514, "time_this_iter_s": 157.7949559688568, "time_total_s": 44684.636489629745, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 44684.636489629745, "timesteps_since_restore": 1578000, "iterations_since_restore": 263, "perf": {"cpu_util_percent": 28.903097345132746, "ram_util_percent": 62.072566371681425}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -473.2774533982026, "episode_reward_min": -651.7854012017596, "episode_reward_mean": -553.4812706980179, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.715475506281955, "mean_processing_ms": 6.147515630679011, "mean_inference_ms": 1.0919832169559225}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1554432, "num_steps_sampled": 1584000, "sample_time_ms": 156345.398, "load_time_ms": 13.994, "grad_time_ms": 756.692, "update_time_ms": 4.145, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 6062.4931640625, "policy_loss": -0.01030061300843954, "vf_loss": 6062.484375, "vf_explained_var": -3.887259403256849e-09, "kl": 0.013915118761360645, "entropy": 15.011778831481934, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1584000, "episodes_total": 7920, "training_iteration": 264, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-54-30", "timestamp": 1606274670, "time_this_iter_s": 155.30765461921692, "time_total_s": 44839.94414424896, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 44839.94414424896, "timesteps_since_restore": 1584000, "iterations_since_restore": 264, "perf": {"cpu_util_percent": 29.20678733031674, "ram_util_percent": 62.113574660633496}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -487.55868029504245, "episode_reward_min": -651.7854012017596, "episode_reward_mean": -555.0040938442754, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.70085316138034, "mean_processing_ms": 6.147438271437302, "mean_inference_ms": 1.0917021602126384}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1560320, "num_steps_sampled": 1590000, "sample_time_ms": 156608.982, "load_time_ms": 13.914, "grad_time_ms": 796.798, "update_time_ms": 4.039, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 6104.49853515625, "policy_loss": -0.0015187134267762303, "vf_loss": 6104.482421875, "vf_explained_var": -1.1661778209770546e-08, "kl": 0.013584001921117306, "entropy": 14.467329025268555, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1590000, "episodes_total": 7950, "training_iteration": 265, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-57-09", "timestamp": 1606274829, "time_this_iter_s": 159.3387176990509, "time_total_s": 44999.28286194801, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 44999.28286194801, "timesteps_since_restore": 1590000, "iterations_since_restore": 265, "perf": {"cpu_util_percent": 29.002202643171806, "ram_util_percent": 62.097797356828195}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -465.87297853711755, "episode_reward_min": -651.7854012017596, "episode_reward_mean": -553.9967383167144, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.68597566931392, "mean_processing_ms": 6.147273713540187, "mean_inference_ms": 1.0914212320823176}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1566208, "num_steps_sampled": 1596000, "sample_time_ms": 156574.086, "load_time_ms": 12.624, "grad_time_ms": 728.123, "update_time_ms": 4.344, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 5944.71337890625, "policy_loss": 0.01446190569549799, "vf_loss": 5944.64794921875, "vf_explained_var": 2.5915063428527674e-09, "kl": 0.036272451281547546, "entropy": 15.323953628540039, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1596000, "episodes_total": 7980, "training_iteration": 266, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_08-59-47", "timestamp": 1606274987, "time_this_iter_s": 158.09849762916565, "time_total_s": 45157.38135957718, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 45157.38135957718, "timesteps_since_restore": 1596000, "iterations_since_restore": 266, "perf": {"cpu_util_percent": 28.934513274336286, "ram_util_percent": 62.12654867256638}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -465.87297853711755, "episode_reward_min": -639.9291534070124, "episode_reward_mean": -552.7625575785356, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.67026543402971, "mean_processing_ms": 6.147038138956359, "mean_inference_ms": 1.091127251869191}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1572096, "num_steps_sampled": 1602000, "sample_time_ms": 156254.378, "load_time_ms": 13.011, "grad_time_ms": 772.162, "update_time_ms": 4.1, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 5967.7998046875, "policy_loss": -0.009324811398983002, "vf_loss": 5967.7880859375, "vf_explained_var": -1.8140543289746347e-08, "kl": 0.0141854053363204, "entropy": 15.91136360168457, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1602000, "episodes_total": 8010, "training_iteration": 267, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-02-22", "timestamp": 1606275142, "time_this_iter_s": 155.16715741157532, "time_total_s": 45312.548516988754, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 45312.548516988754, "timesteps_since_restore": 1602000, "iterations_since_restore": 267, "perf": {"cpu_util_percent": 28.928054298642536, "ram_util_percent": 62.268778280542996}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -465.87297853711755, "episode_reward_min": -639.9291534070124, "episode_reward_mean": -551.6425656269139, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.654845452692506, "mean_processing_ms": 6.146779336007564, "mean_inference_ms": 1.090821429617136}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1577984, "num_steps_sampled": 1608000, "sample_time_ms": 156470.016, "load_time_ms": 10.817, "grad_time_ms": 754.983, "update_time_ms": 4.096, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 6027.4638671875, "policy_loss": -0.008293255232274532, "vf_loss": 6027.45703125, "vf_explained_var": -1.1661778209770546e-08, "kl": 0.010867033153772354, "entropy": 15.152499198913574, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1608000, "episodes_total": 8040, "training_iteration": 268, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-05-02", "timestamp": 1606275302, "time_this_iter_s": 159.30441308021545, "time_total_s": 45471.85293006897, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 45471.85293006897, "timesteps_since_restore": 1608000, "iterations_since_restore": 268, "perf": {"cpu_util_percent": 28.94210526315789, "ram_util_percent": 62.20789473684212}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -487.80115016888976, "episode_reward_min": -629.3965336677354, "episode_reward_mean": -555.5095229474933, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.64006467167941, "mean_processing_ms": 6.146526571861029, "mean_inference_ms": 1.0905168774041305}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1583872, "num_steps_sampled": 1614000, "sample_time_ms": 156525.244, "load_time_ms": 10.613, "grad_time_ms": 767.139, "update_time_ms": 4.079, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 6144.3369140625, "policy_loss": -0.006172320805490017, "vf_loss": 6144.32275390625, "vf_explained_var": -1.684479045138687e-08, "kl": 0.015443487092852592, "entropy": 14.658005714416504, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1614000, "episodes_total": 8070, "training_iteration": 269, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-07-39", "timestamp": 1606275459, "time_this_iter_s": 157.13003826141357, "time_total_s": 45628.98296833038, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 45628.98296833038, "timesteps_since_restore": 1614000, "iterations_since_restore": 269, "perf": {"cpu_util_percent": 28.99241071428571, "ram_util_percent": 62.32321428571428}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -493.7825687292129, "episode_reward_min": -675.3332634871034, "episode_reward_mean": -558.3178975779451, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.625980878674596, "mean_processing_ms": 6.146276976616823, "mean_inference_ms": 1.0902139123110988}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1589760, "num_steps_sampled": 1620000, "sample_time_ms": 156352.261, "load_time_ms": 11.55, "grad_time_ms": 836.664, "update_time_ms": 4.189, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 6230.4951171875, "policy_loss": -0.00966571643948555, "vf_loss": 6230.48974609375, "vf_explained_var": 6.478765524065011e-09, "kl": 0.010423338040709496, "entropy": 15.147368431091309, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1620000, "episodes_total": 8100, "training_iteration": 270, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-10-16", "timestamp": 1606275616, "time_this_iter_s": 156.7516815662384, "time_total_s": 45785.73464989662, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 45785.73464989662, "timesteps_since_restore": 1620000, "iterations_since_restore": 270, "perf": {"cpu_util_percent": 29.229910714285715, "ram_util_percent": 62.456250000000004}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -493.8749295390651, "episode_reward_min": -675.3332634871034, "episode_reward_mean": -558.1035134601681, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.61218141373256, "mean_processing_ms": 6.146013593322911, "mean_inference_ms": 1.0899303628788162}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1595648, "num_steps_sampled": 1626000, "sample_time_ms": 156457.88, "load_time_ms": 11.171, "grad_time_ms": 783.662, "update_time_ms": 4.389, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 6132.76953125, "policy_loss": 0.004737998358905315, "vf_loss": 6132.73583984375, "vf_explained_var": -1.4253284774667918e-08, "kl": 0.021310100331902504, "entropy": 15.305793762207031, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1626000, "episodes_total": 8130, "training_iteration": 271, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-12-52", "timestamp": 1606275772, "time_this_iter_s": 156.84404182434082, "time_total_s": 45942.57869172096, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 45942.57869172096, "timesteps_since_restore": 1626000, "iterations_since_restore": 271, "perf": {"cpu_util_percent": 29.293721973094172, "ram_util_percent": 62.46860986547085}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -485.8994911329619, "episode_reward_min": -675.3332634871034, "episode_reward_mean": -555.3792376296178, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.59798751364904, "mean_processing_ms": 6.145768942635345, "mean_inference_ms": 1.0896452963624361}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1601536, "num_steps_sampled": 1632000, "sample_time_ms": 156509.683, "load_time_ms": 11.698, "grad_time_ms": 800.379, "update_time_ms": 4.162, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 6007.51220703125, "policy_loss": -0.0116946492344141, "vf_loss": 6007.50830078125, "vf_explained_var": -6.478765524065011e-09, "kl": 0.011260009370744228, "entropy": 15.2959623336792, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1632000, "episodes_total": 8160, "training_iteration": 272, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-15-30", "timestamp": 1606275930, "time_this_iter_s": 157.58001565933228, "time_total_s": 46100.158707380295, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 46100.158707380295, "timesteps_since_restore": 1632000, "iterations_since_restore": 272, "perf": {"cpu_util_percent": 29.108888888888888, "ram_util_percent": 62.586666666666666}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -485.8994911329619, "episode_reward_min": -658.2368059864577, "episode_reward_mean": -554.818186286429, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.58352649200459, "mean_processing_ms": 6.145530167772036, "mean_inference_ms": 1.0893506727764823}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1607424, "num_steps_sampled": 1638000, "sample_time_ms": 156382.734, "load_time_ms": 11.728, "grad_time_ms": 812.46, "update_time_ms": 4.131, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 6150.26171875, "policy_loss": 0.015828629955649376, "vf_loss": 6150.20458984375, "vf_explained_var": -7.774518806513697e-09, "kl": 0.029433274641633034, "entropy": 15.9339017868042, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1638000, "episodes_total": 8190, "training_iteration": 273, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-18-07", "timestamp": 1606276087, "time_this_iter_s": 156.64630889892578, "time_total_s": 46256.80501627922, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 46256.80501627922, "timesteps_since_restore": 1638000, "iterations_since_restore": 273, "perf": {"cpu_util_percent": 28.95267857142857, "ram_util_percent": 62.76473214285714}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -474.14555421067644, "episode_reward_min": -658.2368059864577, "episode_reward_mean": -552.180045108726, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.56793614475549, "mean_processing_ms": 6.145277559296014, "mean_inference_ms": 1.0890440451933798}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1613312, "num_steps_sampled": 1644000, "sample_time_ms": 156204.113, "load_time_ms": 12.234, "grad_time_ms": 880.893, "update_time_ms": 4.201, "learner": {"default_policy": {"cur_kl_coeff": 1.3870880603790283, "cur_lr": 4.999999873689376e-05, "total_loss": 6060.74462890625, "policy_loss": -0.01599813997745514, "vf_loss": 6060.74853515625, "vf_explained_var": 7.774518806513697e-09, "kl": 0.00924243126064539, "entropy": 15.95921516418457, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1644000, "episodes_total": 8220, "training_iteration": 274, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-20-41", "timestamp": 1606276241, "time_this_iter_s": 154.21593832969666, "time_total_s": 46411.02095460892, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 46411.02095460892, "timesteps_since_restore": 1644000, "iterations_since_restore": 274, "perf": {"cpu_util_percent": 28.99863636363637, "ram_util_percent": 62.77727272727271}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -474.14555421067644, "episode_reward_min": -658.2368059864577, "episode_reward_mean": -555.4240392418116, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.551931806516286, "mean_processing_ms": 6.1449928458621335, "mean_inference_ms": 1.088724858778076}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1619200, "num_steps_sampled": 1650000, "sample_time_ms": 155758.253, "load_time_ms": 12.701, "grad_time_ms": 872.517, "update_time_ms": 4.623, "learner": {"default_policy": {"cur_kl_coeff": 0.6935440301895142, "cur_lr": 4.999999873689376e-05, "total_loss": 6115.8857421875, "policy_loss": -0.005644645541906357, "vf_loss": 6115.88037109375, "vf_explained_var": 5.183012685705535e-09, "kl": 0.01703585311770439, "entropy": 15.893425941467285, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1650000, "episodes_total": 8250, "training_iteration": 275, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-23-16", "timestamp": 1606276396, "time_this_iter_s": 154.80107855796814, "time_total_s": 46565.822033166885, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 46565.822033166885, "timesteps_since_restore": 1650000, "iterations_since_restore": 275, "perf": {"cpu_util_percent": 29.18552036199095, "ram_util_percent": 62.90407239819004}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -474.14555421067644, "episode_reward_min": -639.9041228568583, "episode_reward_mean": -552.7812894064735, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.53558788681039, "mean_processing_ms": 6.1446503085941275, "mean_inference_ms": 1.0884100609752925}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1625088, "num_steps_sampled": 1656000, "sample_time_ms": 155371.367, "load_time_ms": 13.112, "grad_time_ms": 941.236, "update_time_ms": 4.258, "learner": {"default_policy": {"cur_kl_coeff": 0.6935440301895142, "cur_lr": 4.999999873689376e-05, "total_loss": 5927.48779296875, "policy_loss": -0.013541745953261852, "vf_loss": 5927.4892578125, "vf_explained_var": -1.5549037613027394e-08, "kl": 0.01900322549045086, "entropy": 15.45716381072998, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1656000, "episodes_total": 8280, "training_iteration": 276, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-25-51", "timestamp": 1606276551, "time_this_iter_s": 154.92043566703796, "time_total_s": 46720.74246883392, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 46720.74246883392, "timesteps_since_restore": 1656000, "iterations_since_restore": 276, "perf": {"cpu_util_percent": 29.12262443438914, "ram_util_percent": 62.91583710407238}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -480.4354959579005, "episode_reward_min": -639.9041228568583, "episode_reward_mean": -553.4862166638203, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.51970194500443, "mean_processing_ms": 6.144361569167366, "mean_inference_ms": 1.0881097860437847}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1630976, "num_steps_sampled": 1662000, "sample_time_ms": 155439.355, "load_time_ms": 12.651, "grad_time_ms": 896.359, "update_time_ms": 4.475, "learner": {"default_policy": {"cur_kl_coeff": 0.6935440301895142, "cur_lr": 4.999999873689376e-05, "total_loss": 6149.74365234375, "policy_loss": -0.007870332337915897, "vf_loss": 6149.74072265625, "vf_explained_var": -6.478765524065011e-09, "kl": 0.01689457707107067, "entropy": 15.066283226013184, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1662000, "episodes_total": 8310, "training_iteration": 277, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-28-26", "timestamp": 1606276706, "time_this_iter_s": 155.3958706855774, "time_total_s": 46876.1383395195, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 46876.1383395195, "timesteps_since_restore": 1662000, "iterations_since_restore": 277, "perf": {"cpu_util_percent": 29.004954954954957, "ram_util_percent": 63.02747747747747}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -480.4354959579005, "episode_reward_min": -635.7123071446495, "episode_reward_mean": -553.0850736889233, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.5036231459733, "mean_processing_ms": 6.144123031267841, "mean_inference_ms": 1.087807590625415}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1636864, "num_steps_sampled": 1668000, "sample_time_ms": 154848.759, "load_time_ms": 13.132, "grad_time_ms": 956.754, "update_time_ms": 4.546, "learner": {"default_policy": {"cur_kl_coeff": 0.6935440301895142, "cur_lr": 4.999999873689376e-05, "total_loss": 6143.91162109375, "policy_loss": 0.01530845370143652, "vf_loss": 6143.86669921875, "vf_explained_var": 0.0, "kl": 0.04302966222167015, "entropy": 15.584580421447754, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1668000, "episodes_total": 8340, "training_iteration": 278, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-31-00", "timestamp": 1606276860, "time_this_iter_s": 154.00852870941162, "time_total_s": 47030.14686822891, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 47030.14686822891, "timesteps_since_restore": 1668000, "iterations_since_restore": 278, "perf": {"cpu_util_percent": 28.983105022831047, "ram_util_percent": 63.05844748858447}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -467.8195767783826, "episode_reward_min": -635.7123071446495, "episode_reward_mean": -550.4345978054681, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.487179901045856, "mean_processing_ms": 6.143957915150904, "mean_inference_ms": 1.0875094189670453}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1642752, "num_steps_sampled": 1674000, "sample_time_ms": 154651.447, "load_time_ms": 13.575, "grad_time_ms": 1010.982, "update_time_ms": 4.514, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6029.65576171875, "policy_loss": -0.0029910258017480373, "vf_loss": 6029.63037109375, "vf_explained_var": 3.887259403256849e-09, "kl": 0.027528155595064163, "entropy": 15.050287246704102, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1674000, "episodes_total": 8370, "training_iteration": 279, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-33-36", "timestamp": 1606277016, "time_this_iter_s": 155.70771718025208, "time_total_s": 47185.854585409164, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 47185.854585409164, "timesteps_since_restore": 1674000, "iterations_since_restore": 279, "perf": {"cpu_util_percent": 28.879729729729732, "ram_util_percent": 63.182432432432435}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -467.8195767783826, "episode_reward_min": -635.7123071446495, "episode_reward_mean": -550.6946044928616, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.47068056867196, "mean_processing_ms": 6.143815614732311, "mean_inference_ms": 1.0871977117265816}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1648640, "num_steps_sampled": 1680000, "sample_time_ms": 154614.648, "load_time_ms": 13.087, "grad_time_ms": 1010.804, "update_time_ms": 4.778, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6089.2001953125, "policy_loss": -0.008295807987451553, "vf_loss": 6089.1943359375, "vf_explained_var": -5.183012685705535e-09, "kl": 0.013668285682797432, "entropy": 15.755814552307129, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1680000, "episodes_total": 8400, "training_iteration": 280, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-36-12", "timestamp": 1606277172, "time_this_iter_s": 156.3795680999756, "time_total_s": 47342.23415350914, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 47342.23415350914, "timesteps_since_restore": 1680000, "iterations_since_restore": 280, "perf": {"cpu_util_percent": 28.864732142857147, "ram_util_percent": 63.05714285714287}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -467.8195767783826, "episode_reward_min": -636.8669397954419, "episode_reward_mean": -550.6165142163119, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.45451312528882, "mean_processing_ms": 6.143639326075947, "mean_inference_ms": 1.0868877857396146}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1654528, "num_steps_sampled": 1686000, "sample_time_ms": 154597.236, "load_time_ms": 13.579, "grad_time_ms": 1077.533, "update_time_ms": 4.837, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6119.47509765625, "policy_loss": 0.00505579961463809, "vf_loss": 6119.44091796875, "vf_explained_var": 9.070271644873173e-09, "kl": 0.028063448145985603, "entropy": 14.92108154296875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1686000, "episodes_total": 8430, "training_iteration": 281, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-38-50", "timestamp": 1606277330, "time_this_iter_s": 157.3464379310608, "time_total_s": 47499.5805914402, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 47499.5805914402, "timesteps_since_restore": 1686000, "iterations_since_restore": 281, "perf": {"cpu_util_percent": 28.77321428571429, "ram_util_percent": 63.294642857142854}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -453.69988155767436, "episode_reward_min": -636.8669397954419, "episode_reward_mean": -550.7206099813303, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.4389660340547, "mean_processing_ms": 6.143421962627153, "mean_inference_ms": 1.086584619063487}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1660416, "num_steps_sampled": 1692000, "sample_time_ms": 154273.277, "load_time_ms": 13.076, "grad_time_ms": 1058.18, "update_time_ms": 5.062, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 5986.736328125, "policy_loss": -0.017129795625805855, "vf_loss": 5986.7431640625, "vf_explained_var": -1.1661778209770546e-08, "kl": 0.010541030205786228, "entropy": 14.98669719696045, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1692000, "episodes_total": 8460, "training_iteration": 282, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-41-24", "timestamp": 1606277484, "time_this_iter_s": 154.14364194869995, "time_total_s": 47653.7242333889, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 47653.7242333889, "timesteps_since_restore": 1692000, "iterations_since_restore": 282, "perf": {"cpu_util_percent": 29.224545454545456, "ram_util_percent": 63.45727272727272}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -453.69988155767436, "episode_reward_min": -636.8669397954419, "episode_reward_mean": -551.1985425653752, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.42382025561423, "mean_processing_ms": 6.143209944362644, "mean_inference_ms": 1.0862812896607976}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1666304, "num_steps_sampled": 1698000, "sample_time_ms": 154115.445, "load_time_ms": 13.057, "grad_time_ms": 1103.83, "update_time_ms": 5.066, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6205.923828125, "policy_loss": -0.006441512610763311, "vf_loss": 6205.9169921875, "vf_explained_var": -1.4253284774667918e-08, "kl": 0.013165106996893883, "entropy": 15.657586097717285, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1698000, "episodes_total": 8490, "training_iteration": 283, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-44-00", "timestamp": 1606277640, "time_this_iter_s": 155.5290880203247, "time_total_s": 47809.253321409225, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 47809.253321409225, "timesteps_since_restore": 1698000, "iterations_since_restore": 283, "perf": {"cpu_util_percent": 29.16891891891892, "ram_util_percent": 63.504054054054045}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -453.69988155767436, "episode_reward_min": -636.8669397954419, "episode_reward_mean": -547.8871608726153, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.408099197336625, "mean_processing_ms": 6.142962959608767, "mean_inference_ms": 1.0859792838698166}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1672192, "num_steps_sampled": 1704000, "sample_time_ms": 154084.802, "load_time_ms": 12.771, "grad_time_ms": 1035.047, "update_time_ms": 5.368, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 5862.49609375, "policy_loss": 0.008723795413970947, "vf_loss": 5862.45263671875, "vf_explained_var": -2.5915063428527674e-09, "kl": 0.03245442733168602, "entropy": 15.44036865234375, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1704000, "episodes_total": 8520, "training_iteration": 284, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-46-33", "timestamp": 1606277793, "time_this_iter_s": 153.21767377853394, "time_total_s": 47962.47099518776, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 47962.47099518776, "timesteps_since_restore": 1704000, "iterations_since_restore": 284, "perf": {"cpu_util_percent": 28.880365296803653, "ram_util_percent": 63.562100456621}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -453.69988155767436, "episode_reward_min": -639.8147407513795, "episode_reward_mean": -546.7660238966788, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.392450611052475, "mean_processing_ms": 6.142741673232114, "mean_inference_ms": 1.0856688433329809}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1678080, "num_steps_sampled": 1710000, "sample_time_ms": 154280.25, "load_time_ms": 13.042, "grad_time_ms": 1025.665, "update_time_ms": 4.974, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6105.234375, "policy_loss": -0.006089482456445694, "vf_loss": 6105.2275390625, "vf_explained_var": -1.1661778209770546e-08, "kl": 0.011222939006984234, "entropy": 14.694711685180664, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1710000, "episodes_total": 8550, "training_iteration": 285, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-49-10", "timestamp": 1606277950, "time_this_iter_s": 156.6609423160553, "time_total_s": 48119.131937503815, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 48119.131937503815, "timesteps_since_restore": 1710000, "iterations_since_restore": 285, "perf": {"cpu_util_percent": 28.989237668161437, "ram_util_percent": 63.674439461883416}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -456.92367982904545, "episode_reward_min": -639.8147407513795, "episode_reward_mean": -544.7343189617114, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.376677535043015, "mean_processing_ms": 6.142440022170806, "mean_inference_ms": 1.0853550119497801}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1683968, "num_steps_sampled": 1716000, "sample_time_ms": 154335.721, "load_time_ms": 12.591, "grad_time_ms": 959.854, "update_time_ms": 4.941, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6087.30712890625, "policy_loss": -0.00935907568782568, "vf_loss": 6087.29736328125, "vf_explained_var": 5.183012685705535e-09, "kl": 0.01754695363342762, "entropy": 15.639533996582031, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1716000, "episodes_total": 8580, "training_iteration": 286, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-51-44", "timestamp": 1606278104, "time_this_iter_s": 154.80795216560364, "time_total_s": 48273.93988966942, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 48273.93988966942, "timesteps_since_restore": 1716000, "iterations_since_restore": 286, "perf": {"cpu_util_percent": 29.060633484162896, "ram_util_percent": 63.635294117647064}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -456.92367982904545, "episode_reward_min": -649.2679303470536, "episode_reward_mean": -550.6439743605134, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.363209017304264, "mean_processing_ms": 6.142159799218376, "mean_inference_ms": 1.0850758578045725}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1689856, "num_steps_sampled": 1722000, "sample_time_ms": 154820.682, "load_time_ms": 14.174, "grad_time_ms": 1002.718, "update_time_ms": 4.668, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6299.18896484375, "policy_loss": 0.0014506869483739138, "vf_loss": 6299.16357421875, "vf_explained_var": 2.2027803581181615e-08, "kl": 0.022429320961236954, "entropy": 15.290714263916016, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1722000, "episodes_total": 8610, "training_iteration": 287, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-54-25", "timestamp": 1606278265, "time_this_iter_s": 160.6870801448822, "time_total_s": 48434.6269698143, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 48434.6269698143, "timesteps_since_restore": 1722000, "iterations_since_restore": 287, "perf": {"cpu_util_percent": 29.859388646288206, "ram_util_percent": 63.71135371179038}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -478.42902405234094, "episode_reward_min": -649.2679303470536, "episode_reward_mean": -550.7152113847817, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.350446444930796, "mean_processing_ms": 6.141961064301061, "mean_inference_ms": 1.0848106523539203}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1695744, "num_steps_sampled": 1728000, "sample_time_ms": 155060.412, "load_time_ms": 14.451, "grad_time_ms": 1013.56, "update_time_ms": 4.538, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6192.56201171875, "policy_loss": 0.001582939294166863, "vf_loss": 6192.5341796875, "vf_explained_var": -1.1661778209770546e-08, "kl": 0.02495639957487583, "entropy": 14.760673522949219, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1728000, "episodes_total": 8640, "training_iteration": 288, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-57-02", "timestamp": 1606278422, "time_this_iter_s": 156.5198941230774, "time_total_s": 48591.14686393738, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 48591.14686393738, "timesteps_since_restore": 1728000, "iterations_since_restore": 288, "perf": {"cpu_util_percent": 29.724107142857143, "ram_util_percent": 62.891517857142844}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -478.42902405234094, "episode_reward_min": -649.2679303470536, "episode_reward_mean": -553.3789441731219, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.33796139968257, "mean_processing_ms": 6.141712288293307, "mean_inference_ms": 1.0845542705877327}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1701632, "num_steps_sampled": 1734000, "sample_time_ms": 155097.539, "load_time_ms": 14.444, "grad_time_ms": 1015.29, "update_time_ms": 4.908, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6217.29638671875, "policy_loss": -0.0022265203297138214, "vf_loss": 6217.27783203125, "vf_explained_var": 1.1661778209770546e-08, "kl": 0.019984779879450798, "entropy": 15.604756355285645, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1734000, "episodes_total": 8670, "training_iteration": 289, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_09-59-38", "timestamp": 1606278578, "time_this_iter_s": 156.09907341003418, "time_total_s": 48747.24593734741, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 48747.24593734741, "timesteps_since_restore": 1734000, "iterations_since_restore": 289, "perf": {"cpu_util_percent": 29.679729729729733, "ram_util_percent": 63.03513513513513}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -486.99868786435826, "episode_reward_min": -619.5694728565063, "episode_reward_mean": -553.9737789019774, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.32488428336663, "mean_processing_ms": 6.141527836692047, "mean_inference_ms": 1.0842926042551497}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1707520, "num_steps_sampled": 1740000, "sample_time_ms": 155081.765, "load_time_ms": 14.456, "grad_time_ms": 1015.609, "update_time_ms": 5.1, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6238.96044921875, "policy_loss": -0.002911837538704276, "vf_loss": 6238.94140625, "vf_explained_var": 1.1661778209770546e-08, "kl": 0.020127812400460243, "entropy": 15.427020072937012, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1740000, "episodes_total": 8700, "training_iteration": 290, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-02-14", "timestamp": 1606278734, "time_this_iter_s": 156.22708582878113, "time_total_s": 48903.47302317619, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 48903.47302317619, "timesteps_since_restore": 1740000, "iterations_since_restore": 290, "perf": {"cpu_util_percent": 30.056053811659194, "ram_util_percent": 63.2457399103139}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -486.99868786435826, "episode_reward_min": -641.222361868467, "episode_reward_mean": -551.1349468875956, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.31216715062581, "mean_processing_ms": 6.141272325832187, "mean_inference_ms": 1.0840309774927623}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1713408, "num_steps_sampled": 1746000, "sample_time_ms": 155260.389, "load_time_ms": 14.001, "grad_time_ms": 947.447, "update_time_ms": 5.093, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6262.11083984375, "policy_loss": -0.009274836629629135, "vf_loss": 6262.10595703125, "vf_explained_var": -1.2957531714263837e-09, "kl": 0.013625940307974815, "entropy": 14.496684074401855, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1746000, "episodes_total": 8730, "training_iteration": 291, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-04-53", "timestamp": 1606278893, "time_this_iter_s": 158.44295001029968, "time_total_s": 49061.91597318649, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 49061.91597318649, "timesteps_since_restore": 1746000, "iterations_since_restore": 291, "perf": {"cpu_util_percent": 29.818141592920355, "ram_util_percent": 63.419911504424775}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -486.99868786435826, "episode_reward_min": -641.222361868467, "episode_reward_mean": -547.868197281961, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.299919651329695, "mean_processing_ms": 6.14104669037652, "mean_inference_ms": 1.0837743192774163}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1719296, "num_steps_sampled": 1752000, "sample_time_ms": 155466.233, "load_time_ms": 14.495, "grad_time_ms": 1018.103, "update_time_ms": 4.832, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6017.2470703125, "policy_loss": -0.012699270620942116, "vf_loss": 6017.24853515625, "vf_explained_var": -9.070271644873173e-09, "kl": 0.01170638483017683, "entropy": 15.429659843444824, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1752000, "episodes_total": 8760, "training_iteration": 292, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-07-30", "timestamp": 1606279050, "time_this_iter_s": 156.91508507728577, "time_total_s": 49218.83105826378, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 49218.83105826378, "timesteps_since_restore": 1752000, "iterations_since_restore": 292, "perf": {"cpu_util_percent": 29.822767857142857, "ram_util_percent": 63.57410714285715}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -486.99868786435826, "episode_reward_min": -641.222361868467, "episode_reward_mean": -550.1363894917256, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.28848889911807, "mean_processing_ms": 6.140823188282088, "mean_inference_ms": 1.083536242364624}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1725184, "num_steps_sampled": 1758000, "sample_time_ms": 155843.848, "load_time_ms": 14.162, "grad_time_ms": 992.181, "update_time_ms": 5.295, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6423.97265625, "policy_loss": -0.004166652448475361, "vf_loss": 6423.95947265625, "vf_explained_var": -1.2957531048130022e-08, "kl": 0.017328668385744095, "entropy": 15.247827529907227, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1758000, "episodes_total": 8790, "training_iteration": 293, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-10-09", "timestamp": 1606279209, "time_this_iter_s": 159.04996919631958, "time_total_s": 49377.8810274601, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 49377.8810274601, "timesteps_since_restore": 1758000, "iterations_since_restore": 293, "perf": {"cpu_util_percent": 29.307488986784147, "ram_util_percent": 63.45594713656388}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -491.8888006079243, "episode_reward_min": -637.9770777139264, "episode_reward_mean": -550.0979540136811, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.277100139358225, "mean_processing_ms": 6.140602566601108, "mean_inference_ms": 1.083303275089049}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1731072, "num_steps_sampled": 1764000, "sample_time_ms": 156303.209, "load_time_ms": 13.948, "grad_time_ms": 992.774, "update_time_ms": 5.306, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6279.35595703125, "policy_loss": -0.003633322659879923, "vf_loss": 6279.33740234375, "vf_explained_var": -1.684479045138687e-08, "kl": 0.019410649314522743, "entropy": 14.69858169555664, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1764000, "episodes_total": 8820, "training_iteration": 294, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-12-47", "timestamp": 1606279367, "time_this_iter_s": 157.81499528884888, "time_total_s": 49535.69602274895, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 49535.69602274895, "timesteps_since_restore": 1764000, "iterations_since_restore": 294, "perf": {"cpu_util_percent": 29.503555555555554, "ram_util_percent": 62.56355555555557}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -491.5287566038395, "episode_reward_min": -637.9770777139264, "episode_reward_mean": -558.0251492123588, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.26521363583295, "mean_processing_ms": 6.140366004549148, "mean_inference_ms": 1.0830700017745334}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1736960, "num_steps_sampled": 1770000, "sample_time_ms": 156141.562, "load_time_ms": 13.236, "grad_time_ms": 972.32, "update_time_ms": 5.33, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6410.7685546875, "policy_loss": -0.014137079939246178, "vf_loss": 6410.76904296875, "vf_explained_var": -2.2027803581181615e-08, "kl": 0.013625217601656914, "entropy": 15.588763236999512, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1770000, "episodes_total": 8850, "training_iteration": 295, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-15-22", "timestamp": 1606279522, "time_this_iter_s": 154.83234763145447, "time_total_s": 49690.5283703804, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 49690.5283703804, "timesteps_since_restore": 1770000, "iterations_since_restore": 295, "perf": {"cpu_util_percent": 29.116666666666664, "ram_util_percent": 62.55720720720723}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -491.5287566038395, "episode_reward_min": -629.1567063213295, "episode_reward_mean": -561.1668234400712, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.253747722483766, "mean_processing_ms": 6.140104392464191, "mean_inference_ms": 1.0828271203391677}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1742848, "num_steps_sampled": 1776000, "sample_time_ms": 156453.351, "load_time_ms": 13.188, "grad_time_ms": 972.728, "update_time_ms": 5.355, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6511.14794921875, "policy_loss": -0.001126811490394175, "vf_loss": 6511.1220703125, "vf_explained_var": -7.774518806513697e-09, "kl": 0.025266321375966072, "entropy": 15.314776420593262, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1776000, "episodes_total": 8880, "training_iteration": 296, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-18-00", "timestamp": 1606279680, "time_this_iter_s": 157.9300138950348, "time_total_s": 49848.45838427544, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 49848.45838427544, "timesteps_since_restore": 1776000, "iterations_since_restore": 296, "perf": {"cpu_util_percent": 29.424444444444443, "ram_util_percent": 62.13422222222223}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -491.5287566038395, "episode_reward_min": -629.1567063213295, "episode_reward_mean": -560.3687011334392, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.241133956045296, "mean_processing_ms": 6.139767494111743, "mean_inference_ms": 1.0825552688842621}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1748736, "num_steps_sampled": 1782000, "sample_time_ms": 155775.212, "load_time_ms": 11.606, "grad_time_ms": 931.505, "update_time_ms": 5.328, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6375.9580078125, "policy_loss": -0.0014972699573263526, "vf_loss": 6375.9423828125, "vf_explained_var": -6.478765524065011e-09, "kl": 0.017572659999132156, "entropy": 16.177011489868164, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1782000, "episodes_total": 8910, "training_iteration": 297, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-20-33", "timestamp": 1606279833, "time_this_iter_s": 153.47741556167603, "time_total_s": 50001.93579983711, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 50001.93579983711, "timesteps_since_restore": 1782000, "iterations_since_restore": 297, "perf": {"cpu_util_percent": 28.99771689497717, "ram_util_percent": 62.018264840182646}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -483.36907525804054, "episode_reward_min": -662.5314309342854, "episode_reward_mean": -559.9062163827161, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.228733569489506, "mean_processing_ms": 6.1393712731458185, "mean_inference_ms": 1.0822746250653494}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1754624, "num_steps_sampled": 1788000, "sample_time_ms": 155749.318, "load_time_ms": 11.808, "grad_time_ms": 915.574, "update_time_ms": 5.413, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6326.54833984375, "policy_loss": -0.00996099878102541, "vf_loss": 6326.5439453125, "vf_explained_var": -1.2957531714263837e-09, "kl": 0.013995671644806862, "entropy": 15.602616310119629, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1788000, "episodes_total": 8940, "training_iteration": 298, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-23-09", "timestamp": 1606279989, "time_this_iter_s": 156.10088443756104, "time_total_s": 50158.03668427467, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 50158.03668427467, "timesteps_since_restore": 1788000, "iterations_since_restore": 298, "perf": {"cpu_util_percent": 29.44529147982063, "ram_util_percent": 62.05560538116592}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -461.6051607020342, "episode_reward_min": -662.5314309342854, "episode_reward_mean": -553.6867072398799, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.21572794820882, "mean_processing_ms": 6.13900643329818, "mean_inference_ms": 1.0820038939762466}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1760512, "num_steps_sampled": 1794000, "sample_time_ms": 155725.691, "load_time_ms": 11.325, "grad_time_ms": 848.002, "update_time_ms": 5.152, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6115.62890625, "policy_loss": -0.0009709023288451135, "vf_loss": 6115.611328125, "vf_explained_var": -6.478765524065011e-09, "kl": 0.017904825508594513, "entropy": 15.422892570495605, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1794000, "episodes_total": 8970, "training_iteration": 299, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-25-44", "timestamp": 1606280144, "time_this_iter_s": 155.17540526390076, "time_total_s": 50313.212089538574, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 50313.212089538574, "timesteps_since_restore": 1794000, "iterations_since_restore": 299, "perf": {"cpu_util_percent": 29.12533936651583, "ram_util_percent": 62.010859728506794}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -458.2219071739777, "episode_reward_min": -662.5314309342854, "episode_reward_mean": -550.8390573676573, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.20316087021196, "mean_processing_ms": 6.138699890006767, "mean_inference_ms": 1.0817411092398097}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1766400, "num_steps_sampled": 1800000, "sample_time_ms": 155824.871, "load_time_ms": 10.831, "grad_time_ms": 783.255, "update_time_ms": 4.594, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6311.9775390625, "policy_loss": -0.0072205266915261745, "vf_loss": 6311.96875, "vf_explained_var": -2.4619309257900568e-08, "kl": 0.015770938247442245, "entropy": 15.01662826538086, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1800000, "episodes_total": 9000, "training_iteration": 300, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-28-21", "timestamp": 1606280301, "time_this_iter_s": 156.55719184875488, "time_total_s": 50469.76928138733, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 50469.76928138733, "timesteps_since_restore": 1800000, "iterations_since_restore": 300, "perf": {"cpu_util_percent": 29.035426008968617, "ram_util_percent": 62.06860986547085}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -458.2219071739777, "episode_reward_min": -645.363194824215, "episode_reward_mean": -548.6557259401762, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.19076037668717, "mean_processing_ms": 6.138439308452444, "mean_inference_ms": 1.081497120014395}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1772288, "num_steps_sampled": 1806000, "sample_time_ms": 155527.774, "load_time_ms": 10.743, "grad_time_ms": 783.605, "update_time_ms": 4.28, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6433.986328125, "policy_loss": -0.012017895467579365, "vf_loss": 6433.98486328125, "vf_explained_var": 2.5915063428527674e-09, "kl": 0.013122913427650928, "entropy": 15.770023345947266, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1806000, "episodes_total": 9030, "training_iteration": 301, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-30-56", "timestamp": 1606280456, "time_this_iter_s": 155.4713010787964, "time_total_s": 50625.240582466125, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 50625.240582466125, "timesteps_since_restore": 1806000, "iterations_since_restore": 301, "perf": {"cpu_util_percent": 29.226576576576576, "ram_util_percent": 62.15405405405406}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -458.2219071739777, "episode_reward_min": -645.363194824215, "episode_reward_mean": -550.3018556834955, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.17829071280153, "mean_processing_ms": 6.138160198673497, "mean_inference_ms": 1.0812600456475239}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1778176, "num_steps_sampled": 1812000, "sample_time_ms": 155456.533, "load_time_ms": 10.709, "grad_time_ms": 713.687, "update_time_ms": 4.217, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6146.794921875, "policy_loss": -0.012561745941638947, "vf_loss": 6146.79052734375, "vf_explained_var": -5.183012685705535e-09, "kl": 0.01594557613134384, "entropy": 15.489385604858398, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1812000, "episodes_total": 9060, "training_iteration": 302, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-33-32", "timestamp": 1606280612, "time_this_iter_s": 155.49857306480408, "time_total_s": 50780.73915553093, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 50780.73915553093, "timesteps_since_restore": 1812000, "iterations_since_restore": 302, "perf": {"cpu_util_percent": 28.858108108108112, "ram_util_percent": 62.22117117117118}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -476.1747939373172, "episode_reward_min": -645.363194824215, "episode_reward_mean": -549.5950457689949, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.16586255479004, "mean_processing_ms": 6.137843814729364, "mean_inference_ms": 1.0810163687053351}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1784064, "num_steps_sampled": 1818000, "sample_time_ms": 155214.964, "load_time_ms": 10.561, "grad_time_ms": 671.584, "update_time_ms": 3.725, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6282.46044921875, "policy_loss": -0.004444590304046869, "vf_loss": 6282.4482421875, "vf_explained_var": -2.4619309257900568e-08, "kl": 0.015663526952266693, "entropy": 15.288482666015625, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1818000, "episodes_total": 9090, "training_iteration": 303, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-36-08", "timestamp": 1606280768, "time_this_iter_s": 156.19943594932556, "time_total_s": 50936.938591480255, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 50936.938591480255, "timesteps_since_restore": 1818000, "iterations_since_restore": 303, "perf": {"cpu_util_percent": 29.002690582959644, "ram_util_percent": 62.15246636771302}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -476.1747939373172, "episode_reward_min": -645.363194824215, "episode_reward_mean": -548.4585095940423, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.15275105528936, "mean_processing_ms": 6.1375806741889285, "mean_inference_ms": 1.0807561288978726}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1789952, "num_steps_sampled": 1824000, "sample_time_ms": 154860.898, "load_time_ms": 11.106, "grad_time_ms": 739.206, "update_time_ms": 3.37, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6274.5498046875, "policy_loss": 0.0021554238628596067, "vf_loss": 6274.52197265625, "vf_explained_var": -1.2957531048130022e-08, "kl": 0.02459174580872059, "entropy": 15.769396781921387, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1824000, "episodes_total": 9120, "training_iteration": 304, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-38-43", "timestamp": 1606280923, "time_this_iter_s": 154.95693922042847, "time_total_s": 51091.89553070068, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 51091.89553070068, "timesteps_since_restore": 1824000, "iterations_since_restore": 304, "perf": {"cpu_util_percent": 29.167873303167422, "ram_util_percent": 62.26696832579184}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -489.6486325837666, "episode_reward_min": -622.1265519119601, "episode_reward_mean": -552.8554335797485, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.14056145138689, "mean_processing_ms": 6.137357495114711, "mean_inference_ms": 1.080502671001371}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1795840, "num_steps_sampled": 1830000, "sample_time_ms": 155178.59, "load_time_ms": 11.556, "grad_time_ms": 806.894, "update_time_ms": 3.638, "learner": {"default_policy": {"cur_kl_coeff": 1.040316104888916, "cur_lr": 4.999999873689376e-05, "total_loss": 6610.58837890625, "policy_loss": 0.020036913454532623, "vf_loss": 6610.5263671875, "vf_explained_var": -1.5549037613027394e-08, "kl": 0.040395066142082214, "entropy": 15.045111656188965, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1830000, "episodes_total": 9150, "training_iteration": 305, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-41-22", "timestamp": 1606281082, "time_this_iter_s": 158.696928024292, "time_total_s": 51250.592458724976, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 51250.592458724976, "timesteps_since_restore": 1830000, "iterations_since_restore": 305, "perf": {"cpu_util_percent": 29.43700440528634, "ram_util_percent": 62.385022026431706}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -470.371318921039, "episode_reward_min": -622.1265519119601, "episode_reward_mean": -554.0630023207393, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.12946777148551, "mean_processing_ms": 6.1371745798232995, "mean_inference_ms": 1.0802640051140076}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1801728, "num_steps_sampled": 1836000, "sample_time_ms": 155324.38, "load_time_ms": 12.037, "grad_time_ms": 873.669, "update_time_ms": 3.791, "learner": {"default_policy": {"cur_kl_coeff": 1.560474157333374, "cur_lr": 4.999999873689376e-05, "total_loss": 6492.0400390625, "policy_loss": -0.006457620300352573, "vf_loss": 6492.0244140625, "vf_explained_var": 5.183012685705535e-09, "kl": 0.014465279877185822, "entropy": 15.14327335357666, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1836000, "episodes_total": 9180, "training_iteration": 306, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-44-02", "timestamp": 1606281242, "time_this_iter_s": 160.06585597991943, "time_total_s": 51410.658314704895, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 51410.658314704895, "timesteps_since_restore": 1836000, "iterations_since_restore": 306, "perf": {"cpu_util_percent": 30.661842105263162, "ram_util_percent": 62.43508771929825}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -470.371318921039, "episode_reward_min": -614.6342485543692, "episode_reward_mean": -555.9940436748665, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.11985687780354, "mean_processing_ms": 6.136951824385701, "mean_inference_ms": 1.0800430106528265}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1807616, "num_steps_sampled": 1842000, "sample_time_ms": 155822.006, "load_time_ms": 12.528, "grad_time_ms": 940.736, "update_time_ms": 4.053, "learner": {"default_policy": {"cur_kl_coeff": 1.560474157333374, "cur_lr": 4.999999873689376e-05, "total_loss": 6478.11083984375, "policy_loss": 0.017765864729881287, "vf_loss": 6478.04052734375, "vf_explained_var": 1.2957531714263837e-09, "kl": 0.032870981842279434, "entropy": 14.487447738647461, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1842000, "episodes_total": 9210, "training_iteration": 307, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-46-41", "timestamp": 1606281401, "time_this_iter_s": 159.13570737838745, "time_total_s": 51569.79402208328, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 51569.79402208328, "timesteps_since_restore": 1842000, "iterations_since_restore": 307, "perf": {"cpu_util_percent": 29.222907488986785, "ram_util_percent": 62.62202643171806}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -470.371318921039, "episode_reward_min": -671.4851663020244, "episode_reward_mean": -555.425725233666, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.11002754211735, "mean_processing_ms": 6.136703070295966, "mean_inference_ms": 1.0798260462518572}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1813504, "num_steps_sampled": 1848000, "sample_time_ms": 155788.738, "load_time_ms": 11.561, "grad_time_ms": 890.075, "update_time_ms": 4.3, "learner": {"default_policy": {"cur_kl_coeff": 1.560474157333374, "cur_lr": 4.999999873689376e-05, "total_loss": 6352.45947265625, "policy_loss": 0.0028370320796966553, "vf_loss": 6352.421875, "vf_explained_var": 5.183012685705535e-09, "kl": 0.021867945790290833, "entropy": 15.418545722961426, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1848000, "episodes_total": 9240, "training_iteration": 308, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-49-17", "timestamp": 1606281557, "time_this_iter_s": 155.2534339427948, "time_total_s": 51725.04745602608, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 51725.04745602608, "timesteps_since_restore": 1848000, "iterations_since_restore": 308, "perf": {"cpu_util_percent": 29.21891891891892, "ram_util_percent": 62.76756756756756}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -486.68773918470526, "episode_reward_min": -671.4851663020244, "episode_reward_mean": -552.2331285747126, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.100295380704935, "mean_processing_ms": 6.1364896434479075, "mean_inference_ms": 1.0795981272688027}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1819392, "num_steps_sampled": 1854000, "sample_time_ms": 156208.898, "load_time_ms": 11.561, "grad_time_ms": 888.224, "update_time_ms": 4.195, "learner": {"default_policy": {"cur_kl_coeff": 1.560474157333374, "cur_lr": 4.999999873689376e-05, "total_loss": 6424.28173828125, "policy_loss": -0.007130804937332869, "vf_loss": 6424.26904296875, "vf_explained_var": 1.2957531048130022e-08, "kl": 0.012375831604003906, "entropy": 13.788392066955566, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1854000, "episodes_total": 9270, "training_iteration": 309, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-51-56", "timestamp": 1606281716, "time_this_iter_s": 159.35761833190918, "time_total_s": 51884.40507435799, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 51884.40507435799, "timesteps_since_restore": 1854000, "iterations_since_restore": 309, "perf": {"cpu_util_percent": 29.309251101321586, "ram_util_percent": 62.79999999999999}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -480.947335503033, "episode_reward_min": -671.4851663020244, "episode_reward_mean": -553.6541094971461, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.09077141968396, "mean_processing_ms": 6.136242120812708, "mean_inference_ms": 1.0793675855235094}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1825280, "num_steps_sampled": 1860000, "sample_time_ms": 156362.758, "load_time_ms": 11.568, "grad_time_ms": 886.687, "update_time_ms": 4.226, "learner": {"default_policy": {"cur_kl_coeff": 1.560474157333374, "cur_lr": 4.999999873689376e-05, "total_loss": 6569.3251953125, "policy_loss": -0.008718670345842838, "vf_loss": 6569.31787109375, "vf_explained_var": 1.2957531048130022e-08, "kl": 0.010056120343506336, "entropy": 14.565186500549316, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1860000, "episodes_total": 9300, "training_iteration": 310, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-54-34", "timestamp": 1606281874, "time_this_iter_s": 158.0805516242981, "time_total_s": 52042.485625982285, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 52042.485625982285, "timesteps_since_restore": 1860000, "iterations_since_restore": 310, "perf": {"cpu_util_percent": 29.22, "ram_util_percent": 62.88177777777777}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -480.947335503033, "episode_reward_min": -671.4851663020244, "episode_reward_mean": -555.3977534302453, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.08100460970898, "mean_processing_ms": 6.135962885291583, "mean_inference_ms": 1.0791319659178502}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1831168, "num_steps_sampled": 1866000, "sample_time_ms": 156387.131, "load_time_ms": 12.185, "grad_time_ms": 967.695, "update_time_ms": 4.256, "learner": {"default_policy": {"cur_kl_coeff": 1.560474157333374, "cur_lr": 4.999999873689376e-05, "total_loss": 6436.328125, "policy_loss": -0.004017692990601063, "vf_loss": 6436.310546875, "vf_explained_var": 6.478765524065011e-09, "kl": 0.013506113551557064, "entropy": 16.02033042907715, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1866000, "episodes_total": 9330, "training_iteration": 311, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-57-11", "timestamp": 1606282031, "time_this_iter_s": 156.53577303886414, "time_total_s": 52199.02139902115, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 52199.02139902115, "timesteps_since_restore": 1866000, "iterations_since_restore": 311, "perf": {"cpu_util_percent": 29.339285714285715, "ram_util_percent": 62.942857142857136}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -479.0221730837898, "episode_reward_min": -623.2453723415433, "episode_reward_mean": -549.7805153047054, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.07025986644392, "mean_processing_ms": 6.135604730536927, "mean_inference_ms": 1.078890190463929}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1837056, "num_steps_sampled": 1872000, "sample_time_ms": 156494.947, "load_time_ms": 11.98, "grad_time_ms": 966.309, "update_time_ms": 4.561, "learner": {"default_policy": {"cur_kl_coeff": 1.560474157333374, "cur_lr": 4.999999873689376e-05, "total_loss": 6336.1689453125, "policy_loss": 0.007437379565089941, "vf_loss": 6336.12109375, "vf_explained_var": 1.2957531048130022e-08, "kl": 0.02607046440243721, "entropy": 14.690295219421387, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1872000, "episodes_total": 9360, "training_iteration": 312, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_10-59-47", "timestamp": 1606282187, "time_this_iter_s": 156.56394910812378, "time_total_s": 52355.58534812927, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 52355.58534812927, "timesteps_since_restore": 1872000, "iterations_since_restore": 312, "perf": {"cpu_util_percent": 28.810762331838564, "ram_util_percent": 62.98251121076234}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
{"episode_reward_max": -479.0221730837898, "episode_reward_min": -654.698471350413, "episode_reward_mean": -550.8454058593871, "episode_len_mean": 200.0, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.06007686559367, "mean_processing_ms": 6.135342639102865, "mean_inference_ms": 1.0786628021271543}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1842944, "num_steps_sampled": 1878000, "sample_time_ms": 157055.718, "load_time_ms": 11.995, "grad_time_ms": 971.299, "update_time_ms": 4.691, "learner": {"default_policy": {"cur_kl_coeff": 1.560474157333374, "cur_lr": 4.999999873689376e-05, "total_loss": 6645.51904296875, "policy_loss": -0.012272448278963566, "vf_loss": 6645.513671875, "vf_explained_var": -2.5915063428527674e-09, "kl": 0.011766447685658932, "entropy": 14.967358589172363, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 6000, "done": false, "timesteps_total": 1878000, "episodes_total": 9390, "training_iteration": 313, "experiment_id": "9460914741bd497fb2dd1e1f18405456", "date": "2020-11-25_11-02-29", "timestamp": 1606282349, "time_this_iter_s": 161.86320161819458, "time_total_s": 52517.44854974747, "pid": 22881, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 2, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"probability\": 0.25,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 52517.44854974747, "timesteps_since_restore": 1878000, "iterations_since_restore": 313, "perf": {"cpu_util_percent": 30.13030303030303, "ram_util_percent": 62.812554112554125}, "num_healthy_workers": 2, "trial_id": "496c08c6", "experiment_tag": "0"}
