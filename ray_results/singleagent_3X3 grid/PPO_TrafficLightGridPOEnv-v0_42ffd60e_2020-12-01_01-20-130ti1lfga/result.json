{"episode_reward_max": -340.74704901679314, "episode_reward_min": -405.80007933686574, "episode_reward_mean": -373.7620990264845, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 30.377174242908833, "mean_processing_ms": 3.298683669583569, "mean_inference_ms": 1.630254798147135}, "off_policy_estimator": {}, "info": {"num_steps_trained": 25088, "num_steps_sampled": 25200, "sample_time_ms": 182427.946, "load_time_ms": 402.59, "grad_time_ms": 5132.509, "update_time_ms": 1244.828, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 585.9983520507812, "policy_loss": -0.00801919586956501, "vf_loss": 586.00537109375, "vf_explained_var": -6.748097348463489e-06, "kl": 0.004933360498398542, "entropy": 12.783527374267578, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 25200, "episodes_total": 61, "training_iteration": 1, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_01-23-34", "timestamp": 1606766014, "time_this_iter_s": 189.29423141479492, "time_total_s": 189.29423141479492, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 189.29423141479492, "timesteps_since_restore": 25200, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 69.05461254612547, "ram_util_percent": 55.45129151291513}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -322.29304128829136, "episode_reward_min": -406.76029042355873, "episode_reward_mean": -373.3429792400369, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.871434688735736, "mean_processing_ms": 3.429331774526016, "mean_inference_ms": 1.6882261547495916}, "off_policy_estimator": {}, "info": {"num_steps_trained": 50176, "num_steps_sampled": 50400, "sample_time_ms": 195096.728, "load_time_ms": 235.799, "grad_time_ms": 4332.476, "update_time_ms": 625.031, "learner": {"default_policy": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 582.6919555664062, "policy_loss": -0.00991533137857914, "vf_loss": 582.7009887695312, "vf_explained_var": -9.935121170201455e-07, "kl": 0.00833961647003889, "entropy": 12.72502326965332, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 50400, "episodes_total": 126, "training_iteration": 2, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_01-27-06", "timestamp": 1606766226, "time_this_iter_s": 211.38883566856384, "time_total_s": 400.68306708335876, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 400.68306708335876, "timesteps_since_restore": 50400, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 70.34385382059801, "ram_util_percent": 59.53421926910298}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -334.9189028073335, "episode_reward_min": -406.26923732844165, "episode_reward_mean": -370.3577292113945, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.40812186421207, "mean_processing_ms": 3.482385877245479, "mean_inference_ms": 1.7503950527366532}, "off_policy_estimator": {}, "info": {"num_steps_trained": 75264, "num_steps_sampled": 75600, "sample_time_ms": 201900.762, "load_time_ms": 193.845, "grad_time_ms": 5128.04, "update_time_ms": 419.646, "learner": {"default_policy": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 567.04833984375, "policy_loss": -0.009829431772232056, "vf_loss": 567.0577392578125, "vf_explained_var": -3.0228071068449935e-07, "kl": 0.008495177142322063, "entropy": 12.667632102966309, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 75600, "episodes_total": 187, "training_iteration": 3, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_01-30-48", "timestamp": 1606766448, "time_this_iter_s": 222.36337065696716, "time_total_s": 623.0464377403259, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 623.0464377403259, "timesteps_since_restore": 75600, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 71.69337539432178, "ram_util_percent": 59.841955835962146}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -334.9189028073335, "episode_reward_min": -399.26315951229026, "episode_reward_mean": -366.7066482579113, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.87687370811565, "mean_processing_ms": 3.4930247687765394, "mean_inference_ms": 1.7612197242124454}, "off_policy_estimator": {}, "info": {"num_steps_trained": 100352, "num_steps_sampled": 100800, "sample_time_ms": 201053.06, "load_time_ms": 183.666, "grad_time_ms": 5515.032, "update_time_ms": 317.149, "learner": {"default_policy": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 542.5518188476562, "policy_loss": -0.011799699626863003, "vf_loss": 542.5634155273438, "vf_explained_var": -7.663454226758404e-08, "kl": 0.008340922184288502, "entropy": 12.666055679321289, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 100800, "episodes_total": 252, "training_iteration": 4, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_01-34-14", "timestamp": 1606766654, "time_this_iter_s": 205.36891889572144, "time_total_s": 828.4153566360474, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 828.4153566360474, "timesteps_since_restore": 100800, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 70.17440273037542, "ram_util_percent": 64.31501706484643}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -334.5383785686899, "episode_reward_min": -399.26315951229026, "episode_reward_mean": -366.37544187388266, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.12869147435858, "mean_processing_ms": 3.5026375213859477, "mean_inference_ms": 1.7666960359781598}, "off_policy_estimator": {}, "info": {"num_steps_trained": 125440, "num_steps_sampled": 126000, "sample_time_ms": 203344.243, "load_time_ms": 170.418, "grad_time_ms": 5671.457, "update_time_ms": 255.424, "learner": {"default_policy": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 540.8928833007812, "policy_loss": -0.009902053512632847, "vf_loss": 540.9027709960938, "vf_explained_var": -4.0446007432137776e-08, "kl": 0.007116617634892464, "entropy": 12.616654396057129, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 126000, "episodes_total": 313, "training_iteration": 5, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_01-37-53", "timestamp": 1606766873, "time_this_iter_s": 218.94753289222717, "time_total_s": 1047.3628895282745, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1047.3628895282745, "timesteps_since_restore": 126000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 70.23942307692307, "ram_util_percent": 59.530448717948715}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -321.5464959958821, "episode_reward_min": -415.97955182600776, "episode_reward_mean": -362.95138753915336, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.41653229065707, "mean_processing_ms": 3.523364558640974, "mean_inference_ms": 1.779790603092335}, "off_policy_estimator": {}, "info": {"num_steps_trained": 150528, "num_steps_sampled": 151200, "sample_time_ms": 204528.738, "load_time_ms": 156.212, "grad_time_ms": 5774.817, "update_time_ms": 214.288, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 518.8619384765625, "policy_loss": -0.013024569489061832, "vf_loss": 518.8748779296875, "vf_explained_var": -2.159147882707657e-08, "kl": 0.011964519508183002, "entropy": 12.610072135925293, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 151200, "episodes_total": 378, "training_iteration": 6, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_01-41-29", "timestamp": 1606767089, "time_this_iter_s": 216.85322284698486, "time_total_s": 1264.2161123752594, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1264.2161123752594, "timesteps_since_restore": 151200, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 70.3858064516129, "ram_util_percent": 59.761290322580656}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -323.44200601749907, "episode_reward_min": -397.42417139945525, "episode_reward_mean": -361.41701948728956, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.79626986438003, "mean_processing_ms": 3.6094582180037036, "mean_inference_ms": 1.8014057097022098}, "off_policy_estimator": {}, "info": {"num_steps_trained": 175616, "num_steps_sampled": 176400, "sample_time_ms": 208024.325, "load_time_ms": 151.742, "grad_time_ms": 5852.83, "update_time_ms": 185.068, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 514.7799072265625, "policy_loss": -0.012244092300534248, "vf_loss": 514.7921142578125, "vf_explained_var": -9.123160005231057e-09, "kl": 0.011506984010338783, "entropy": 12.596784591674805, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 176400, "episodes_total": 439, "training_iteration": 7, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_01-45-25", "timestamp": 1606767325, "time_this_iter_s": 235.65371823310852, "time_total_s": 1499.869830608368, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1499.869830608368, "timesteps_since_restore": 176400, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 73.08392857142857, "ram_util_percent": 61.19583333333334}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -320.4157627479246, "episode_reward_min": -402.16025632418194, "episode_reward_mean": -361.88751409579277, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 35.047014163792255, "mean_processing_ms": 3.663553619315438, "mean_inference_ms": 1.8142956189419852}, "off_policy_estimator": {}, "info": {"num_steps_trained": 200704, "num_steps_sampled": 201600, "sample_time_ms": 208515.851, "load_time_ms": 143.567, "grad_time_ms": 5911.308, "update_time_ms": 163.155, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 508.1605529785156, "policy_loss": -0.011132597923278809, "vf_loss": 508.171630859375, "vf_explained_var": -2.1287374085687816e-09, "kl": 0.010438389144837856, "entropy": 12.482763290405273, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 201600, "episodes_total": 504, "training_iteration": 8, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_01-49-04", "timestamp": 1606767544, "time_this_iter_s": 218.39065957069397, "time_total_s": 1718.260490179062, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1718.260490179062, "timesteps_since_restore": 201600, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 70.19485530546625, "ram_util_percent": 59.26173633440515}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -320.4157627479246, "episode_reward_min": -400.8585332826398, "episode_reward_mean": -361.86152345051335, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 35.14293882540409, "mean_processing_ms": 3.653821733455577, "mean_inference_ms": 1.8179472093487499}, "off_policy_estimator": {}, "info": {"num_steps_trained": 225792, "num_steps_sampled": 226800, "sample_time_ms": 209184.93, "load_time_ms": 141.068, "grad_time_ms": 5956.519, "update_time_ms": 146.191, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 503.09454345703125, "policy_loss": -0.011498239822685719, "vf_loss": 503.10595703125, "vf_explained_var": -9.123160005231057e-10, "kl": 0.01183844543993473, "entropy": 12.463488578796387, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 226800, "episodes_total": 565, "training_iteration": 9, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_01-52-45", "timestamp": 1606767765, "time_this_iter_s": 221.00591707229614, "time_total_s": 1939.266407251358, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1939.266407251358, "timesteps_since_restore": 226800, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 70.06190476190476, "ram_util_percent": 59.46984126984127}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -330.4621344605789, "episode_reward_min": -407.9365084355053, "episode_reward_mean": -359.1971647255416, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 35.25112593042954, "mean_processing_ms": 3.6497698883209604, "mean_inference_ms": 1.8226828937567496}, "off_policy_estimator": {}, "info": {"num_steps_trained": 250880, "num_steps_sampled": 252000, "sample_time_ms": 209601.746, "load_time_ms": 138.569, "grad_time_ms": 5991.139, "update_time_ms": 132.414, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 490.51904296875, "policy_loss": -0.013040445744991302, "vf_loss": 490.53204345703125, "vf_explained_var": 5.169790817660669e-09, "kl": 0.012455356307327747, "entropy": 12.498108863830566, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 252000, "episodes_total": 630, "training_iteration": 10, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_01-56-24", "timestamp": 1606767984, "time_this_iter_s": 219.79819226264954, "time_total_s": 2159.0645995140076, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2159.0645995140076, "timesteps_since_restore": 252000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 70.96337579617834, "ram_util_percent": 60.42356687898088}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -330.6473377111229, "episode_reward_min": -407.73357499506807, "episode_reward_mean": -358.2715585105836, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 35.341379343325286, "mean_processing_ms": 3.644584528897292, "mean_inference_ms": 1.825641834634174}, "off_policy_estimator": {}, "info": {"num_steps_trained": 275968, "num_steps_sampled": 277200, "sample_time_ms": 212654.705, "load_time_ms": 110.731, "grad_time_ms": 5759.565, "update_time_ms": 8.838, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 493.9248962402344, "policy_loss": -0.013221529312431812, "vf_loss": 493.93804931640625, "vf_explained_var": -3.0410534090918873e-09, "kl": 0.010770268738269806, "entropy": 12.524775505065918, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 277200, "episodes_total": 691, "training_iteration": 11, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_02-00-00", "timestamp": 1606768200, "time_this_iter_s": 215.9176468849182, "time_total_s": 2374.982246398926, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2374.982246398926, "timesteps_since_restore": 277200, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 73.29902597402597, "ram_util_percent": 62.57564935064935}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -308.79338879572, "episode_reward_min": -407.73357499506807, "episode_reward_mean": -355.3551615230451, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 35.21143994516565, "mean_processing_ms": 3.6380493877623588, "mean_inference_ms": 1.8126595528275857}, "off_policy_estimator": {}, "info": {"num_steps_trained": 301056, "num_steps_sampled": 302400, "sample_time_ms": 211085.542, "load_time_ms": 116.09, "grad_time_ms": 5718.473, "update_time_ms": 8.74, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 477.6261901855469, "policy_loss": -0.014341709204018116, "vf_loss": 477.6404724121094, "vf_explained_var": -6.082106485116867e-10, "kl": 0.012965960428118706, "entropy": 12.454047203063965, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 302400, "episodes_total": 756, "training_iteration": 12, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_02-03-16", "timestamp": 1606768396, "time_this_iter_s": 195.33322668075562, "time_total_s": 2570.3154730796814, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2570.3154730796814, "timesteps_since_restore": 302400, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 66.31654676258992, "ram_util_percent": 62.72805755395684}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -316.9053408828187, "episode_reward_min": -391.77461781547805, "episode_reward_mean": -354.7358755733014, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.98601560391226, "mean_processing_ms": 3.624867179379763, "mean_inference_ms": 1.7945586379382947}, "off_policy_estimator": {}, "info": {"num_steps_trained": 326144, "num_steps_sampled": 327600, "sample_time_ms": 208735.632, "load_time_ms": 117.471, "grad_time_ms": 5362.933, "update_time_ms": 8.299, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 479.83856201171875, "policy_loss": -0.012475765310227871, "vf_loss": 479.8509216308594, "vf_explained_var": -8.210843560618741e-09, "kl": 0.010826234705746174, "entropy": 12.416110038757324, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 327600, "episodes_total": 817, "training_iteration": 13, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_02-06-31", "timestamp": 1606768591, "time_this_iter_s": 195.3127224445343, "time_total_s": 2765.6281955242157, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2765.6281955242157, "timesteps_since_restore": 327600, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 65.89784946236558, "ram_util_percent": 62.76451612903225}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -305.6980670748826, "episode_reward_min": -397.1783425245664, "episode_reward_mean": -351.46739149363253, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.77679657773168, "mean_processing_ms": 3.615292399151497, "mean_inference_ms": 1.7780794255890293}, "off_policy_estimator": {}, "info": {"num_steps_trained": 351232, "num_steps_sampled": 352800, "sample_time_ms": 207981.82, "load_time_ms": 114.849, "grad_time_ms": 5143.256, "update_time_ms": 7.748, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 465.56219482421875, "policy_loss": -0.013635990209877491, "vf_loss": 465.57574462890625, "vf_explained_var": -1.5205267045459436e-09, "kl": 0.013493986800312996, "entropy": 12.34683895111084, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 352800, "episodes_total": 882, "training_iteration": 14, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_02-09-47", "timestamp": 1606768787, "time_this_iter_s": 195.59261631965637, "time_total_s": 2961.220811843872, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2961.220811843872, "timesteps_since_restore": 352800, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 65.8483870967742, "ram_util_percent": 62.993189964157715}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -317.04204544695983, "episode_reward_min": -393.50452327268897, "episode_reward_mean": -351.982581117093, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.619453958126925, "mean_processing_ms": 3.603410594347756, "mean_inference_ms": 1.7653981192577752}, "off_policy_estimator": {}, "info": {"num_steps_trained": 376320, "num_steps_sampled": 378000, "sample_time_ms": 205984.186, "load_time_ms": 110.659, "grad_time_ms": 4777.296, "update_time_ms": 7.319, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 474.038818359375, "policy_loss": -0.013554544188082218, "vf_loss": 474.05230712890625, "vf_explained_var": -9.123160005231057e-09, "kl": 0.011447385884821415, "entropy": 12.270223617553711, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 378000, "episodes_total": 943, "training_iteration": 15, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_02-13-02", "timestamp": 1606768982, "time_this_iter_s": 195.25994038581848, "time_total_s": 3156.4807522296906, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3156.4807522296906, "timesteps_since_restore": 378000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 66.03512544802867, "ram_util_percent": 63.159856630824365}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -312.1165356030165, "episode_reward_min": -393.50452327268897, "episode_reward_mean": -349.35903828770824, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.44902449896405, "mean_processing_ms": 3.59661382871979, "mean_inference_ms": 1.7519202236636304}, "off_policy_estimator": {}, "info": {"num_steps_trained": 401408, "num_steps_sampled": 403200, "sample_time_ms": 203947.942, "load_time_ms": 114.76, "grad_time_ms": 4467.119, "update_time_ms": 6.872, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 474.4023742675781, "policy_loss": -0.013477153144776821, "vf_loss": 474.4157409667969, "vf_explained_var": -1.338063437827941e-08, "kl": 0.012649611569941044, "entropy": 12.17825984954834, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 403200, "episodes_total": 1008, "training_iteration": 16, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_02-16-15", "timestamp": 1606769175, "time_this_iter_s": 193.4195408821106, "time_total_s": 3349.900293111801, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3349.900293111801, "timesteps_since_restore": 403200, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 65.92545454545454, "ram_util_percent": 63.35745454545456}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -312.1165356030165, "episode_reward_min": -405.3757183325919, "episode_reward_mean": -348.950988763283, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.304929133914456, "mean_processing_ms": 3.5878520384016146, "mean_inference_ms": 1.7409983761182468}, "off_policy_estimator": {}, "info": {"num_steps_trained": 426496, "num_steps_sampled": 428400, "sample_time_ms": 200065.833, "load_time_ms": 115.414, "grad_time_ms": 4381.851, "update_time_ms": 6.329, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 477.9717712402344, "policy_loss": -0.015396786853671074, "vf_loss": 477.9870910644531, "vf_explained_var": 0.0, "kl": 0.014492682181298733, "entropy": 12.100984573364258, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 428400, "episodes_total": 1069, "training_iteration": 17, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_02-19-31", "timestamp": 1606769371, "time_this_iter_s": 195.79286003112793, "time_total_s": 3545.693153142929, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3545.693153142929, "timesteps_since_restore": 428400, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 65.44142857142857, "ram_util_percent": 63.517142857142865}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -313.88108242838183, "episode_reward_min": -375.65798166497626, "episode_reward_mean": -347.50907162601396, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.15671838973317, "mean_processing_ms": 3.5822933994321433, "mean_inference_ms": 1.7299644209650342}, "off_policy_estimator": {}, "info": {"num_steps_trained": 451584, "num_steps_sampled": 453600, "sample_time_ms": 197843.1, "load_time_ms": 119.261, "grad_time_ms": 4180.891, "update_time_ms": 5.797, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 476.0150146484375, "policy_loss": -0.013339760713279247, "vf_loss": 476.0282897949219, "vf_explained_var": -1.338063437827941e-08, "kl": 0.013294314034283161, "entropy": 12.058025360107422, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 453600, "episodes_total": 1134, "training_iteration": 18, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_02-22-45", "timestamp": 1606769565, "time_this_iter_s": 194.17986536026, "time_total_s": 3739.873018503189, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3739.873018503189, "timesteps_since_restore": 453600, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 65.51841155234656, "ram_util_percent": 63.70613718411552}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -318.5982632719777, "episode_reward_min": -379.14440520069246, "episode_reward_mean": -348.636607910115, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.03700679598047, "mean_processing_ms": 3.57498593140136, "mean_inference_ms": 1.7210523968850884}, "off_policy_estimator": {}, "info": {"num_steps_trained": 476672, "num_steps_sampled": 478800, "sample_time_ms": 195368.114, "load_time_ms": 119.498, "grad_time_ms": 3984.068, "update_time_ms": 5.109, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 488.76287841796875, "policy_loss": -0.012112263590097427, "vf_loss": 488.77496337890625, "vf_explained_var": -8.514949634275126e-09, "kl": 0.012059167958796024, "entropy": 11.928056716918945, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 478800, "episodes_total": 1195, "training_iteration": 19, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_02-26-00", "timestamp": 1606769760, "time_this_iter_s": 194.2751235961914, "time_total_s": 3934.1481420993805, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3934.1481420993805, "timesteps_since_restore": 478800, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 65.74404332129964, "ram_util_percent": 63.898194945848374}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -316.20711448989573, "episode_reward_min": -381.7579179338365, "episode_reward_mean": -345.36966266789705, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.921775609641216, "mean_processing_ms": 3.571023958798564, "mean_inference_ms": 1.7121572863270023}, "off_policy_estimator": {}, "info": {"num_steps_trained": 501760, "num_steps_sampled": 504000, "sample_time_ms": 192926.854, "load_time_ms": 114.913, "grad_time_ms": 3613.406, "update_time_ms": 4.636, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 482.39349365234375, "policy_loss": -0.011839187704026699, "vf_loss": 482.40521240234375, "vf_explained_var": -2.736948001569317e-09, "kl": 0.012141335755586624, "entropy": 11.75696086883545, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 504000, "episodes_total": 1260, "training_iteration": 20, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_02-29-11", "timestamp": 1606769951, "time_this_iter_s": 191.6200602054596, "time_total_s": 4125.76820230484, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4125.76820230484, "timesteps_since_restore": 504000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 66.1117216117216, "ram_util_percent": 64.07985347985348}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -309.5153127185849, "episode_reward_min": -380.9098839199982, "episode_reward_mean": -340.7099360160485, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.82221010638657, "mean_processing_ms": 3.5656835933138518, "mean_inference_ms": 1.7047914012254517}, "off_policy_estimator": {}, "info": {"num_steps_trained": 526848, "num_steps_sampled": 529200, "sample_time_ms": 190627.987, "load_time_ms": 114.172, "grad_time_ms": 3628.067, "update_time_ms": 4.202, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 479.4698791503906, "policy_loss": -0.015250461176037788, "vf_loss": 479.4850158691406, "vf_explained_var": -1.5205267045459436e-09, "kl": 0.01427455060184002, "entropy": 11.768134117126465, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 529200, "episodes_total": 1321, "training_iteration": 21, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_02-32-24", "timestamp": 1606770144, "time_this_iter_s": 193.07094860076904, "time_total_s": 4318.839150905609, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4318.839150905609, "timesteps_since_restore": 529200, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 65.78436363636362, "ram_util_percent": 64.2429090909091}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -303.6208731286584, "episode_reward_min": -376.10290328720845, "episode_reward_mean": -341.86548069372344, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.73998291303504, "mean_processing_ms": 3.5628197569754274, "mean_inference_ms": 1.6985323837557809}, "off_policy_estimator": {}, "info": {"num_steps_trained": 551936, "num_steps_sampled": 554400, "sample_time_ms": 190483.879, "load_time_ms": 113.491, "grad_time_ms": 3685.868, "update_time_ms": 4.543, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 489.6344909667969, "policy_loss": -0.01240647304803133, "vf_loss": 489.6467590332031, "vf_explained_var": 6.082106485116867e-10, "kl": 0.013399089686572552, "entropy": 11.618236541748047, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 554400, "episodes_total": 1386, "training_iteration": 22, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_02-35-39", "timestamp": 1606770339, "time_this_iter_s": 194.46611380577087, "time_total_s": 4513.30526471138, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4513.30526471138, "timesteps_since_restore": 554400, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 65.83992805755396, "ram_util_percent": 64.4208633093525}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -303.6714376634843, "episode_reward_min": -373.17083094160796, "episode_reward_mean": -341.3554297277576, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.671984549283, "mean_processing_ms": 3.558854745440477, "mean_inference_ms": 1.6932247249228058}, "off_policy_estimator": {}, "info": {"num_steps_trained": 577024, "num_steps_sampled": 579600, "sample_time_ms": 190458.454, "load_time_ms": 112.502, "grad_time_ms": 3716.095, "update_time_ms": 4.496, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 498.1133728027344, "policy_loss": -0.013413619250059128, "vf_loss": 498.1266784667969, "vf_explained_var": -9.123160005231057e-10, "kl": 0.013593204319477081, "entropy": 11.576939582824707, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 579600, "episodes_total": 1447, "training_iteration": 23, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_02-38-54", "timestamp": 1606770534, "time_this_iter_s": 195.34913897514343, "time_total_s": 4708.654403686523, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4708.654403686523, "timesteps_since_restore": 579600, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 65.55863309352519, "ram_util_percent": 64.5654676258993}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -308.18998122209797, "episode_reward_min": -374.51169783751584, "episode_reward_mean": -342.251612704348, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.605908559779806, "mean_processing_ms": 3.5562801690272057, "mean_inference_ms": 1.6879374884481642}, "off_policy_estimator": {}, "info": {"num_steps_trained": 602112, "num_steps_sampled": 604800, "sample_time_ms": 190509.299, "load_time_ms": 109.435, "grad_time_ms": 3588.159, "update_time_ms": 4.472, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 520.6535034179688, "policy_loss": -0.013500548899173737, "vf_loss": 520.6669311523438, "vf_explained_var": -1.5205267045459436e-09, "kl": 0.013424791395664215, "entropy": 11.553013801574707, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 604800, "episodes_total": 1512, "training_iteration": 24, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_02-42-09", "timestamp": 1606770729, "time_this_iter_s": 194.79822301864624, "time_total_s": 4903.45262670517, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4903.45262670517, "timesteps_since_restore": 604800, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 65.93129496402878, "ram_util_percent": 64.7388489208633}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -308.18998122209797, "episode_reward_min": -394.8275441189061, "episode_reward_mean": -343.15495154539633, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.54546191363629, "mean_processing_ms": 3.5520289238812186, "mean_inference_ms": 1.6833318942684814}, "off_policy_estimator": {}, "info": {"num_steps_trained": 627200, "num_steps_sampled": 630000, "sample_time_ms": 190120.261, "load_time_ms": 113.811, "grad_time_ms": 3879.541, "update_time_ms": 4.909, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 522.390625, "policy_loss": -0.01521387044340372, "vf_loss": 522.4057006835938, "vf_explained_var": -9.123160005231057e-10, "kl": 0.017235904932022095, "entropy": 11.605740547180176, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 630000, "episodes_total": 1573, "training_iteration": 25, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_02-45-23", "timestamp": 1606770923, "time_this_iter_s": 194.33964824676514, "time_total_s": 5097.792274951935, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5097.792274951935, "timesteps_since_restore": 630000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 65.67589928057555, "ram_util_percent": 65.06115107913669}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -314.3418563573666, "episode_reward_min": -371.6607522191943, "episode_reward_mean": -342.48346919073776, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.48213153362764, "mean_processing_ms": 3.5497790184163485, "mean_inference_ms": 1.6784014611219618}, "off_policy_estimator": {}, "info": {"num_steps_trained": 652288, "num_steps_sampled": 655200, "sample_time_ms": 190122.512, "load_time_ms": 114.021, "grad_time_ms": 3922.644, "update_time_ms": 5.362, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 540.0172119140625, "policy_loss": -0.013398663140833378, "vf_loss": 540.030517578125, "vf_explained_var": -5.778001188616599e-09, "kl": 0.01351518277078867, "entropy": 11.489315032958984, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 655200, "episodes_total": 1638, "training_iteration": 26, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_02-48-37", "timestamp": 1606771117, "time_this_iter_s": 193.87941694259644, "time_total_s": 5291.671691894531, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5291.671691894531, "timesteps_since_restore": 655200, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 66.00326086956522, "ram_util_percent": 65.29710144927536}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -316.91483213212973, "episode_reward_min": -376.1563830704319, "episode_reward_mean": -343.6231920173557, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.43340585284902, "mean_processing_ms": 3.546486438207411, "mean_inference_ms": 1.674503843379686}, "off_policy_estimator": {}, "info": {"num_steps_trained": 677376, "num_steps_sampled": 680400, "sample_time_ms": 190268.057, "load_time_ms": 112.174, "grad_time_ms": 3672.251, "update_time_ms": 5.303, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 560.9805297851562, "policy_loss": -0.0172674972563982, "vf_loss": 560.9976196289062, "vf_explained_var": -6.690317189139705e-09, "kl": 0.018051644787192345, "entropy": 11.537891387939453, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 680400, "episodes_total": 1699, "training_iteration": 27, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_02-51-52", "timestamp": 1606771312, "time_this_iter_s": 194.73055863380432, "time_total_s": 5486.402250528336, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5486.402250528336, "timesteps_since_restore": 680400, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 65.44028776978416, "ram_util_percent": 65.46546762589928}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -321.86269620676836, "episode_reward_min": -389.4069904241399, "episode_reward_mean": -347.9562713109254, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.38604586191107, "mean_processing_ms": 3.5452262029325765, "mean_inference_ms": 1.6704766202846644}, "off_policy_estimator": {}, "info": {"num_steps_trained": 702464, "num_steps_sampled": 705600, "sample_time_ms": 190487.695, "load_time_ms": 106.388, "grad_time_ms": 3535.332, "update_time_ms": 5.542, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 592.3236083984375, "policy_loss": -0.015187656506896019, "vf_loss": 592.3387451171875, "vf_explained_var": -8.210843560618741e-09, "kl": 0.014146189205348492, "entropy": 11.425382614135742, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 705600, "episodes_total": 1764, "training_iteration": 28, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_02-55-07", "timestamp": 1606771507, "time_this_iter_s": 194.958801984787, "time_total_s": 5681.361052513123, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5681.361052513123, "timesteps_since_restore": 705600, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 66.08129496402877, "ram_util_percent": 65.68776978417264}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -313.8172396746067, "episode_reward_min": -385.989484550239, "episode_reward_mean": -347.29079674575735, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.339971468771225, "mean_processing_ms": 3.5421199196019346, "mean_inference_ms": 1.6668741081500105}, "off_policy_estimator": {}, "info": {"num_steps_trained": 727552, "num_steps_sampled": 730800, "sample_time_ms": 190504.878, "load_time_ms": 105.517, "grad_time_ms": 3651.97, "update_time_ms": 5.923, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 584.9487915039062, "policy_loss": -0.0164916031062603, "vf_loss": 584.9652709960938, "vf_explained_var": -6.38621200366174e-09, "kl": 0.01624804362654686, "entropy": 11.398780822753906, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 730800, "episodes_total": 1825, "training_iteration": 29, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_02-58-23", "timestamp": 1606771703, "time_this_iter_s": 195.61678743362427, "time_total_s": 5876.977839946747, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5876.977839946747, "timesteps_since_restore": 730800, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 65.46917562724015, "ram_util_percent": 65.8347670250896}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -313.44109102400125, "episode_reward_min": -384.1897084216515, "episode_reward_mean": -343.9317508647023, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.29558958118598, "mean_processing_ms": 3.5406706777116916, "mean_inference_ms": 1.6634519799175254}, "off_policy_estimator": {}, "info": {"num_steps_trained": 752640, "num_steps_sampled": 756000, "sample_time_ms": 190677.068, "load_time_ms": 105.259, "grad_time_ms": 3655.668, "update_time_ms": 6.28, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 605.971923828125, "policy_loss": -0.015278044156730175, "vf_loss": 605.987060546875, "vf_explained_var": -6.0821068181837745e-09, "kl": 0.015448538586497307, "entropy": 11.287797927856445, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 756000, "episodes_total": 1890, "training_iteration": 30, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_03-01-36", "timestamp": 1606771896, "time_this_iter_s": 193.38025856018066, "time_total_s": 6070.3580985069275, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6070.3580985069275, "timesteps_since_restore": 756000, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 66.0126811594203, "ram_util_percent": 66.0018115942029}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -313.44109102400125, "episode_reward_min": -385.4099932818644, "episode_reward_mean": -346.6415910554616, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.25514966041299, "mean_processing_ms": 3.5377078896777387, "mean_inference_ms": 1.6603145060821476}, "off_policy_estimator": {}, "info": {"num_steps_trained": 777728, "num_steps_sampled": 781200, "sample_time_ms": 190696.689, "load_time_ms": 105.251, "grad_time_ms": 3897.508, "update_time_ms": 6.181, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 627.5213623046875, "policy_loss": -0.015993861481547356, "vf_loss": 627.5372924804688, "vf_explained_var": -3.6492640020924227e-09, "kl": 0.015579753555357456, "entropy": 11.305489540100098, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 781200, "episodes_total": 1951, "training_iteration": 31, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_03-04-52", "timestamp": 1606772092, "time_this_iter_s": 195.6789526939392, "time_total_s": 6266.037051200867, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6266.037051200867, "timesteps_since_restore": 781200, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 65.40931899641576, "ram_util_percent": 66.15125448028672}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -306.4124159396755, "episode_reward_min": -390.01025514187745, "episode_reward_mean": -344.1357143770882, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.20895488911719, "mean_processing_ms": 3.5354690986333317, "mean_inference_ms": 1.6567032499083145}, "off_policy_estimator": {}, "info": {"num_steps_trained": 802816, "num_steps_sampled": 806400, "sample_time_ms": 190380.927, "load_time_ms": 101.33, "grad_time_ms": 3977.457, "update_time_ms": 5.798, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 646.1679077148438, "policy_loss": -0.015748947858810425, "vf_loss": 646.18359375, "vf_explained_var": -3.0410534090918873e-09, "kl": 0.014653395861387253, "entropy": 11.169713020324707, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 806400, "episodes_total": 2016, "training_iteration": 32, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_03-08-04", "timestamp": 1606772284, "time_this_iter_s": 192.07178139686584, "time_total_s": 6458.1088325977325, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6458.1088325977325, "timesteps_since_restore": 806400, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 66.16970802919708, "ram_util_percent": 66.32737226277372}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -306.4124159396755, "episode_reward_min": -390.01025514187745, "episode_reward_mean": -343.78263538821477, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.16838063221039, "mean_processing_ms": 3.533063235971996, "mean_inference_ms": 1.653797548105141}, "off_policy_estimator": {}, "info": {"num_steps_trained": 827904, "num_steps_sampled": 831600, "sample_time_ms": 190136.447, "load_time_ms": 101.423, "grad_time_ms": 3924.905, "update_time_ms": 6.231, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 647.9302978515625, "policy_loss": -0.015035061165690422, "vf_loss": 647.9452514648438, "vf_explained_var": -5.473896003138634e-09, "kl": 0.015072813257575035, "entropy": 11.304500579833984, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 831600, "episodes_total": 2077, "training_iteration": 33, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_03-11-16", "timestamp": 1606772476, "time_this_iter_s": 192.39216780662537, "time_total_s": 6650.501000404358, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6650.501000404358, "timesteps_since_restore": 831600, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 65.85328467153285, "ram_util_percent": 66.49014598540145}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -301.51713243778755, "episode_reward_min": -379.05081761463333, "episode_reward_mean": -341.46164466524095, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.13167899671248, "mean_processing_ms": 3.5310440344720115, "mean_inference_ms": 1.6510587085948516}, "off_policy_estimator": {}, "info": {"num_steps_trained": 852992, "num_steps_sampled": 856800, "sample_time_ms": 189893.85, "load_time_ms": 105.883, "grad_time_ms": 3989.906, "update_time_ms": 6.567, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 683.45166015625, "policy_loss": -0.016308201476931572, "vf_loss": 683.4678955078125, "vf_explained_var": -2.1287374085687816e-09, "kl": 0.0174555666744709, "entropy": 11.0479154586792, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 856800, "episodes_total": 2142, "training_iteration": 34, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_03-14-29", "timestamp": 1606772669, "time_this_iter_s": 193.06270289421082, "time_total_s": 6843.563703298569, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6843.563703298569, "timesteps_since_restore": 856800, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 66.11521739130436, "ram_util_percent": 66.6572463768116}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -308.72639760787985, "episode_reward_min": -377.6699601777178, "episode_reward_mean": -342.0476932210594, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.10187071764204, "mean_processing_ms": 3.528566701775988, "mean_inference_ms": 1.648805371909944}, "off_policy_estimator": {}, "info": {"num_steps_trained": 878080, "num_steps_sampled": 882000, "sample_time_ms": 189961.772, "load_time_ms": 100.53, "grad_time_ms": 3740.631, "update_time_ms": 6.09, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 688.0098266601562, "policy_loss": -0.015008422546088696, "vf_loss": 688.0247192382812, "vf_explained_var": -1.8246320010462114e-09, "kl": 0.014311564154922962, "entropy": 11.104056358337402, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 882000, "episodes_total": 2203, "training_iteration": 35, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_03-17-42", "timestamp": 1606772862, "time_this_iter_s": 192.46606492996216, "time_total_s": 7036.029768228531, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7036.029768228531, "timesteps_since_restore": 882000, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 65.86861313868613, "ram_util_percent": 66.81569343065694}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -314.5850689174506, "episode_reward_min": -379.20354113502174, "episode_reward_mean": -345.4999183618891, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.066206816820184, "mean_processing_ms": 3.5278408490204622, "mean_inference_ms": 1.6461132859099754}, "off_policy_estimator": {}, "info": {"num_steps_trained": 903168, "num_steps_sampled": 907200, "sample_time_ms": 189858.434, "load_time_ms": 99.936, "grad_time_ms": 3952.564, "update_time_ms": 5.975, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 727.296875, "policy_loss": -0.016961826011538506, "vf_loss": 727.313720703125, "vf_explained_var": 2.1287374085687816e-09, "kl": 0.017158685252070427, "entropy": 10.926127433776855, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 907200, "episodes_total": 2268, "training_iteration": 36, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_03-20-57", "timestamp": 1606773057, "time_this_iter_s": 194.96558690071106, "time_total_s": 7230.995355129242, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7230.995355129242, "timesteps_since_restore": 907200, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 65.87374100719425, "ram_util_percent": 67.0021582733813}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -308.4140554894069, "episode_reward_min": -396.4115470737777, "episode_reward_mean": -343.24509341950085, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.03768974565166, "mean_processing_ms": 3.5258698224954004, "mean_inference_ms": 1.6438880095379524}, "off_policy_estimator": {}, "info": {"num_steps_trained": 928256, "num_steps_sampled": 932400, "sample_time_ms": 189582.003, "load_time_ms": 96.335, "grad_time_ms": 3913.609, "update_time_ms": 6.393, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 723.7213134765625, "policy_loss": -0.016517655923962593, "vf_loss": 723.7377319335938, "vf_explained_var": -4.865685188093494e-09, "kl": 0.01687019318342209, "entropy": 11.03144645690918, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 932400, "episodes_total": 2329, "training_iteration": 37, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_03-24-08", "timestamp": 1606773248, "time_this_iter_s": 191.53679966926575, "time_total_s": 7422.532154798508, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7422.532154798508, "timesteps_since_restore": 932400, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 65.83357664233577, "ram_util_percent": 67.17299270072994}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -310.73204299273397, "episode_reward_min": -396.4115470737777, "episode_reward_mean": -341.45909860950474, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.01227772588905, "mean_processing_ms": 3.525058255982178, "mean_inference_ms": 1.6417314200201552}, "off_policy_estimator": {}, "info": {"num_steps_trained": 953344, "num_steps_sampled": 957600, "sample_time_ms": 189535.218, "load_time_ms": 96.217, "grad_time_ms": 3877.563, "update_time_ms": 6.164, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 771.6367797851562, "policy_loss": -0.015616845339536667, "vf_loss": 771.65234375, "vf_explained_var": -5.169790817660669e-09, "kl": 0.01614532060921192, "entropy": 10.745392799377441, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 957600, "episodes_total": 2394, "training_iteration": 38, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_03-27-22", "timestamp": 1606773442, "time_this_iter_s": 194.11914443969727, "time_total_s": 7616.651299238205, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7616.651299238205, "timesteps_since_restore": 957600, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 65.97184115523464, "ram_util_percent": 67.29927797833936}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -312.7089572748933, "episode_reward_min": -378.7451687172814, "episode_reward_mean": -336.8498732009413, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.99209130229177, "mean_processing_ms": 3.5233507883711632, "mean_inference_ms": 1.6400929251718173}, "off_policy_estimator": {}, "info": {"num_steps_trained": 978432, "num_steps_sampled": 982800, "sample_time_ms": 189610.506, "load_time_ms": 100.244, "grad_time_ms": 3857.976, "update_time_ms": 5.873, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 757.30908203125, "policy_loss": -0.015795612707734108, "vf_loss": 757.32470703125, "vf_explained_var": -1.0643686820799303e-08, "kl": 0.018183285370469093, "entropy": 10.747879981994629, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 982800, "episodes_total": 2455, "training_iteration": 39, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_03-30-39", "timestamp": 1606773639, "time_this_iter_s": 196.20274448394775, "time_total_s": 7812.854043722153, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7812.854043722153, "timesteps_since_restore": 982800, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 65.51648745519712, "ram_util_percent": 67.50322580645162}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -309.49541164147814, "episode_reward_min": -369.1715637272921, "episode_reward_mean": -336.48223278902486, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.95740638224857, "mean_processing_ms": 3.522682930249879, "mean_inference_ms": 1.6376516912276748}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1003520, "num_steps_sampled": 1008000, "sample_time_ms": 189409.298, "load_time_ms": 104.628, "grad_time_ms": 4061.956, "update_time_ms": 5.604, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 820.3805541992188, "policy_loss": -0.015949435532093048, "vf_loss": 820.3963623046875, "vf_explained_var": -1.5205267045459436e-09, "kl": 0.016065994277596474, "entropy": 10.706134796142578, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1008000, "episodes_total": 2520, "training_iteration": 40, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_03-33-52", "timestamp": 1606773832, "time_this_iter_s": 193.44942784309387, "time_total_s": 8006.303471565247, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8006.303471565247, "timesteps_since_restore": 1008000, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 65.46413043478262, "ram_util_percent": 67.52789855072463}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -299.7303431321048, "episode_reward_min": -371.72209887558665, "episode_reward_mean": -339.4579249936869, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.93509700568668, "mean_processing_ms": 3.5210788809875906, "mean_inference_ms": 1.6360544222174054}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1028608, "num_steps_sampled": 1033200, "sample_time_ms": 189419.827, "load_time_ms": 106.812, "grad_time_ms": 3831.095, "update_time_ms": 5.743, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 814.05810546875, "policy_loss": -0.015953924506902695, "vf_loss": 814.073974609375, "vf_explained_var": -7.2985280041848455e-09, "kl": 0.015024621039628983, "entropy": 10.700765609741211, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1033200, "episodes_total": 2581, "training_iteration": 41, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_03-37-06", "timestamp": 1606774026, "time_this_iter_s": 193.4967803955078, "time_total_s": 8199.800251960754, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8199.800251960754, "timesteps_since_restore": 1033200, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 66.04565217391304, "ram_util_percent": 67.77028985507246}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -302.26404136386, "episode_reward_min": -391.001390400671, "episode_reward_mean": -342.7003454372365, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.90837095104741, "mean_processing_ms": 3.520800893422794, "mean_inference_ms": 1.6340908976692738}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1053696, "num_steps_sampled": 1058400, "sample_time_ms": 189580.893, "load_time_ms": 110.05, "grad_time_ms": 3933.521, "update_time_ms": 5.746, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 882.9315795898438, "policy_loss": -0.01750992424786091, "vf_loss": 882.948974609375, "vf_explained_var": -1.0643686820799303e-08, "kl": 0.019009502604603767, "entropy": 10.531381607055664, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1058400, "episodes_total": 2646, "training_iteration": 42, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_03-40-20", "timestamp": 1606774220, "time_this_iter_s": 194.73971962928772, "time_total_s": 8394.539971590042, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8394.539971590042, "timesteps_since_restore": 1058400, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 65.93812949640288, "ram_util_percent": 67.50071942446043}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -312.7855261104792, "episode_reward_min": -391.001390400671, "episode_reward_mean": -340.5364171058515, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.889087898457355, "mean_processing_ms": 3.518368508811559, "mean_inference_ms": 1.6325012975927269}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1078784, "num_steps_sampled": 1083600, "sample_time_ms": 189721.513, "load_time_ms": 109.677, "grad_time_ms": 4003.322, "update_time_ms": 5.733, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 864.9614868164062, "policy_loss": -0.016518956050276756, "vf_loss": 864.9779052734375, "vf_explained_var": 3.0410532425584336e-10, "kl": 0.016479745507240295, "entropy": 10.52055549621582, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1083600, "episodes_total": 2707, "training_iteration": 43, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_03-43-35", "timestamp": 1606774415, "time_this_iter_s": 194.48411464691162, "time_total_s": 8589.024086236954, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8589.024086236954, "timesteps_since_restore": 1083600, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 65.66223021582734, "ram_util_percent": 66.74928057553957}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -311.19593028213075, "episode_reward_min": -373.05713076467026, "episode_reward_mean": -336.53297592911593, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.86332010056082, "mean_processing_ms": 3.5182664257139957, "mean_inference_ms": 1.630513096444843}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1103872, "num_steps_sampled": 1108800, "sample_time_ms": 189897.647, "load_time_ms": 103.936, "grad_time_ms": 3872.71, "update_time_ms": 5.42, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 914.7169799804688, "policy_loss": -0.016938842833042145, "vf_loss": 914.7337646484375, "vf_explained_var": 5.473896003138634e-09, "kl": 0.015891369432210922, "entropy": 10.533466339111328, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1108800, "episodes_total": 2772, "training_iteration": 44, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_03-46-48", "timestamp": 1606774608, "time_this_iter_s": 193.45789051055908, "time_total_s": 8782.481976747513, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8782.481976747513, "timesteps_since_restore": 1108800, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 65.92327272727273, "ram_util_percent": 66.9410909090909}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -301.66093849093903, "episode_reward_min": -373.05713076467026, "episode_reward_mean": -337.47028214614335, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.84821641463061, "mean_processing_ms": 3.5163918728340646, "mean_inference_ms": 1.6293145185218898}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1128960, "num_steps_sampled": 1134000, "sample_time_ms": 189917.383, "load_time_ms": 105.361, "grad_time_ms": 4085.331, "update_time_ms": 5.571, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 915.6104736328125, "policy_loss": -0.01668069139122963, "vf_loss": 915.6270141601562, "vf_explained_var": -9.123160005231057e-09, "kl": 0.016431249678134918, "entropy": 10.599838256835938, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1134000, "episodes_total": 2833, "training_iteration": 45, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_03-50-03", "timestamp": 1606774803, "time_this_iter_s": 194.80518627166748, "time_total_s": 8977.28716301918, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8977.28716301918, "timesteps_since_restore": 1134000, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 66.0341726618705, "ram_util_percent": 67.13669064748201}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -300.70045024168456, "episode_reward_min": -369.4079809915584, "episode_reward_mean": -336.44910359936154, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.82556091317071, "mean_processing_ms": 3.5160529729136103, "mean_inference_ms": 1.627565381076223}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1154048, "num_steps_sampled": 1159200, "sample_time_ms": 189779.208, "load_time_ms": 104.781, "grad_time_ms": 4065.949, "update_time_ms": 5.568, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 974.6882934570312, "policy_loss": -0.016509223729372025, "vf_loss": 974.7046508789062, "vf_explained_var": -1.338063437827941e-08, "kl": 0.01647375151515007, "entropy": 10.392105102539062, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1159200, "episodes_total": 2898, "training_iteration": 46, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_03-53-17", "timestamp": 1606774997, "time_this_iter_s": 193.38421988487244, "time_total_s": 9170.671382904053, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9170.671382904053, "timesteps_since_restore": 1159200, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 65.81630434782609, "ram_util_percent": 67.2858695652174}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -300.70045024168456, "episode_reward_min": -375.577572311479, "episode_reward_mean": -337.31336526582004, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.80532487889364, "mean_processing_ms": 3.514748678027262, "mean_inference_ms": 1.6261725282709583}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1179136, "num_steps_sampled": 1184400, "sample_time_ms": 189752.57, "load_time_ms": 109.275, "grad_time_ms": 4181.227, "update_time_ms": 5.511, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 962.4520263671875, "policy_loss": -0.01626858487725258, "vf_loss": 962.468017578125, "vf_explained_var": -3.6492640020924227e-09, "kl": 0.01607409119606018, "entropy": 10.517496109008789, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1184400, "episodes_total": 2959, "training_iteration": 47, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_03-56-29", "timestamp": 1606775189, "time_this_iter_s": 192.46927618980408, "time_total_s": 9363.140659093857, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9363.140659093857, "timesteps_since_restore": 1184400, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 65.82618181818182, "ram_util_percent": 67.38}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -300.8217160337618, "episode_reward_min": -375.577572311479, "episode_reward_mean": -335.95283931817903, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.786015434789164, "mean_processing_ms": 3.514476816911056, "mean_inference_ms": 1.6247892853435377}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1204224, "num_steps_sampled": 1209600, "sample_time_ms": 189615.062, "load_time_ms": 109.537, "grad_time_ms": 4242.131, "update_time_ms": 5.444, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1035.047607421875, "policy_loss": -0.01678197644650936, "vf_loss": 1035.064208984375, "vf_explained_var": -1.0947792006277268e-08, "kl": 0.015443466603755951, "entropy": 10.230216979980469, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1209600, "episodes_total": 3024, "training_iteration": 48, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_03-59-43", "timestamp": 1606775383, "time_this_iter_s": 193.36480593681335, "time_total_s": 9556.50546503067, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9556.50546503067, "timesteps_since_restore": 1209600, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 66.01195652173914, "ram_util_percent": 67.55978260869566}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -300.8217160337618, "episode_reward_min": -371.72684798258166, "episode_reward_mean": -336.69978421042237, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.77513359030964, "mean_processing_ms": 3.513201897029988, "mean_inference_ms": 1.6239408691369028}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1229312, "num_steps_sampled": 1234800, "sample_time_ms": 189655.889, "load_time_ms": 101.484, "grad_time_ms": 4086.526, "update_time_ms": 5.88, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1018.56298828125, "policy_loss": -0.01657942868769169, "vf_loss": 1018.5794677734375, "vf_explained_var": -6.0821068181837745e-09, "kl": 0.01763053610920906, "entropy": 10.335579872131348, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1234800, "episodes_total": 3085, "training_iteration": 49, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_04-02-58", "timestamp": 1606775578, "time_this_iter_s": 194.98772287368774, "time_total_s": 9751.493187904358, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9751.493187904358, "timesteps_since_restore": 1234800, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 65.5640287769784, "ram_util_percent": 67.71690647482014}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -300.6487419209588, "episode_reward_min": -368.37639519195585, "episode_reward_mean": -336.50048818792175, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.75351628131497, "mean_processing_ms": 3.513648768356775, "mean_inference_ms": 1.6223700394936014}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1254400, "num_steps_sampled": 1260000, "sample_time_ms": 189674.512, "load_time_ms": 101.932, "grad_time_ms": 4072.531, "update_time_ms": 6.175, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1100.671875, "policy_loss": -0.016998786479234695, "vf_loss": 1100.688720703125, "vf_explained_var": -3.953369187570388e-09, "kl": 0.01609254628419876, "entropy": 10.279439926147461, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1260000, "episodes_total": 3150, "training_iteration": 50, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_04-06-11", "timestamp": 1606775771, "time_this_iter_s": 193.50373888015747, "time_total_s": 9944.996926784515, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9944.996926784515, "timesteps_since_restore": 1260000, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 65.88840579710146, "ram_util_percent": 67.91195652173911}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -300.6487419209588, "episode_reward_min": -370.61708031822235, "episode_reward_mean": -338.8388013406652, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.73871259806344, "mean_processing_ms": 3.512116474099491, "mean_inference_ms": 1.6213959341892021}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1279488, "num_steps_sampled": 1285200, "sample_time_ms": 189689.733, "load_time_ms": 95.139, "grad_time_ms": 4030.335, "update_time_ms": 6.076, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1091.2095947265625, "policy_loss": -0.017390107735991478, "vf_loss": 1091.2269287109375, "vf_explained_var": -6.99442281870688e-09, "kl": 0.016988936811685562, "entropy": 10.229277610778809, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1285200, "episodes_total": 3211, "training_iteration": 51, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_04-09-24", "timestamp": 1606775964, "time_this_iter_s": 193.1579988002777, "time_total_s": 10138.154925584793, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10138.154925584793, "timesteps_since_restore": 1285200, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 65.78290909090909, "ram_util_percent": 68.088}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -308.8643014544956, "episode_reward_min": -366.86772489715645, "episode_reward_mean": -338.30274557020147, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.718837784022284, "mean_processing_ms": 3.511591441710227, "mean_inference_ms": 1.6198782734467492}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1304576, "num_steps_sampled": 1310400, "sample_time_ms": 189617.0, "load_time_ms": 96.662, "grad_time_ms": 4029.928, "update_time_ms": 6.082, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1171.3707275390625, "policy_loss": -0.016199510544538498, "vf_loss": 1171.3868408203125, "vf_explained_var": -7.60263318966281e-09, "kl": 0.01639462821185589, "entropy": 10.149484634399414, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1310400, "episodes_total": 3276, "training_iteration": 52, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_04-12-38", "timestamp": 1606776158, "time_this_iter_s": 194.02395391464233, "time_total_s": 10332.178879499435, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10332.178879499435, "timesteps_since_restore": 1310400, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 65.90072202166066, "ram_util_percent": 68.24512635379062}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -291.28286894923485, "episode_reward_min": -368.7322188173379, "episode_reward_mean": -335.3849132006931, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.704819627270396, "mean_processing_ms": 3.509443453705992, "mean_inference_ms": 1.6187565193894593}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1329664, "num_steps_sampled": 1335600, "sample_time_ms": 189344.976, "load_time_ms": 97.101, "grad_time_ms": 4219.156, "update_time_ms": 6.095, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1149.64794921875, "policy_loss": -0.015174461528658867, "vf_loss": 1149.6629638671875, "vf_explained_var": -2.432842594046747e-09, "kl": 0.018155565485358238, "entropy": 10.20399284362793, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1335600, "episodes_total": 3337, "training_iteration": 53, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_04-15-52", "timestamp": 1606776352, "time_this_iter_s": 193.66446614265442, "time_total_s": 10525.84334564209, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10525.84334564209, "timesteps_since_restore": 1335600, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 65.95, "ram_util_percent": 68.45362318840579}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -291.28286894923485, "episode_reward_min": -368.7322188173379, "episode_reward_mean": -336.20215480022483, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.687780822256634, "mean_processing_ms": 3.508843218488641, "mean_inference_ms": 1.6174902923725103}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1354752, "num_steps_sampled": 1360800, "sample_time_ms": 189195.845, "load_time_ms": 102.201, "grad_time_ms": 4242.887, "update_time_ms": 6.053, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1233.4510498046875, "policy_loss": -0.016631338745355606, "vf_loss": 1233.4676513671875, "vf_explained_var": -3.3451585945698525e-09, "kl": 0.015716955065727234, "entropy": 10.056143760681152, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1360800, "episodes_total": 3402, "training_iteration": 54, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_04-19-04", "timestamp": 1606776544, "time_this_iter_s": 192.25440573692322, "time_total_s": 10718.097751379013, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10718.097751379013, "timesteps_since_restore": 1360800, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 66.0324817518248, "ram_util_percent": 68.63029197080293}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -302.9775088689835, "episode_reward_min": -365.4667834498884, "episode_reward_mean": -335.0635666956226, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.67624178072808, "mean_processing_ms": 3.507735701891192, "mean_inference_ms": 1.6165204198625913}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1379840, "num_steps_sampled": 1386000, "sample_time_ms": 189248.473, "load_time_ms": 106.421, "grad_time_ms": 4068.312, "update_time_ms": 5.92, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1192.0435791015625, "policy_loss": -0.019859258085489273, "vf_loss": 1192.0633544921875, "vf_explained_var": -1.6725792306715448e-08, "kl": 0.01838032342493534, "entropy": 10.05765438079834, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1386000, "episodes_total": 3463, "training_iteration": 55, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_04-22-18", "timestamp": 1606776738, "time_this_iter_s": 193.62078261375427, "time_total_s": 10911.718533992767, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10911.718533992767, "timesteps_since_restore": 1386000, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 65.70505415162455, "ram_util_percent": 68.72671480144406}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -301.24760645103254, "episode_reward_min": -376.60004259425517, "episode_reward_mean": -334.328267306473, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.66387075344242, "mean_processing_ms": 3.507518019354476, "mean_inference_ms": 1.6155056885191015}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1404928, "num_steps_sampled": 1411200, "sample_time_ms": 189464.28, "load_time_ms": 102.486, "grad_time_ms": 3792.073, "update_time_ms": 5.573, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1288.770751953125, "policy_loss": -0.017778415232896805, "vf_loss": 1288.7884521484375, "vf_explained_var": -8.819054819753092e-09, "kl": 0.018580937758088112, "entropy": 9.90639877319336, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1411200, "episodes_total": 3528, "training_iteration": 56, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_04-25-31", "timestamp": 1606776931, "time_this_iter_s": 192.73641228675842, "time_total_s": 11104.454946279526, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11104.454946279526, "timesteps_since_restore": 1411200, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 66.04072727272728, "ram_util_percent": 68.87054545454546}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -296.8761269638832, "episode_reward_min": -369.47854858371727, "episode_reward_mean": -332.3016731763979, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.655710134333226, "mean_processing_ms": 3.506870223328399, "mean_inference_ms": 1.6148525469108332}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1430016, "num_steps_sampled": 1436400, "sample_time_ms": 189759.054, "load_time_ms": 97.13, "grad_time_ms": 3714.871, "update_time_ms": 5.632, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1250.31005859375, "policy_loss": -0.017818190157413483, "vf_loss": 1250.3277587890625, "vf_explained_var": -7.2985280041848455e-09, "kl": 0.01953912526369095, "entropy": 10.03571891784668, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1436400, "episodes_total": 3589, "training_iteration": 57, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_04-28-45", "timestamp": 1606777125, "time_this_iter_s": 194.59833574295044, "time_total_s": 11299.053282022476, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11299.053282022476, "timesteps_since_restore": 1436400, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 65.81805054151624, "ram_util_percent": 69.00541516245487}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -296.8761269638832, "episode_reward_min": -363.11319533053023, "episode_reward_mean": -332.9949411804789, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.64454713015061, "mean_processing_ms": 3.5071061225622797, "mean_inference_ms": 1.6139713440744816}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1455104, "num_steps_sampled": 1461600, "sample_time_ms": 189742.339, "load_time_ms": 98.738, "grad_time_ms": 3675.916, "update_time_ms": 6.042, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1344.7567138671875, "policy_loss": -0.017087262123823166, "vf_loss": 1344.7738037109375, "vf_explained_var": -5.169790817660669e-09, "kl": 0.017025679349899292, "entropy": 9.903755187988281, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1461600, "episodes_total": 3654, "training_iteration": 58, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_04-31-58", "timestamp": 1606777318, "time_this_iter_s": 192.8262484073639, "time_total_s": 11491.87953042984, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11491.87953042984, "timesteps_since_restore": 1461600, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 66.01563636363636, "ram_util_percent": 69.22763636363636}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -298.06518438506447, "episode_reward_min": -363.11319533053023, "episode_reward_mean": -331.6157054828423, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.633526818354056, "mean_processing_ms": 3.506757090452204, "mean_inference_ms": 1.6131413153866612}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1480192, "num_steps_sampled": 1486800, "sample_time_ms": 189604.149, "load_time_ms": 104.441, "grad_time_ms": 3838.32, "update_time_ms": 5.981, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1299.9459228515625, "policy_loss": -0.018347805365920067, "vf_loss": 1299.9639892578125, "vf_explained_var": -8.514949634275126e-09, "kl": 0.019977381452918053, "entropy": 9.920350074768066, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1486800, "episodes_total": 3715, "training_iteration": 59, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_04-35-13", "timestamp": 1606777513, "time_this_iter_s": 195.27763557434082, "time_total_s": 11687.15716600418, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11687.15716600418, "timesteps_since_restore": 1486800, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 65.55770609318998, "ram_util_percent": 69.4222222222222}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -297.76509500889426, "episode_reward_min": -368.61661123668773, "episode_reward_mean": -332.12803456721923, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.619667982761, "mean_processing_ms": 3.50668994690364, "mean_inference_ms": 1.6121657594914447}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1505280, "num_steps_sampled": 1512000, "sample_time_ms": 189648.414, "load_time_ms": 105.493, "grad_time_ms": 3718.086, "update_time_ms": 5.65, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1407.7364501953125, "policy_loss": -0.01737886480987072, "vf_loss": 1407.7537841796875, "vf_explained_var": 6.690317189139705e-09, "kl": 0.018280237913131714, "entropy": 9.701461791992188, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1512000, "episodes_total": 3780, "training_iteration": 60, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_04-38-26", "timestamp": 1606777706, "time_this_iter_s": 192.7576503753662, "time_total_s": 11879.914816379547, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11879.914816379547, "timesteps_since_restore": 1512000, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 65.92654545454545, "ram_util_percent": 69.55490909090909}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -302.3155480063388, "episode_reward_min": -368.61661123668773, "episode_reward_mean": -333.23749574300166, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.60915594876119, "mean_processing_ms": 3.505870558639206, "mean_inference_ms": 1.611413931113391}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1530368, "num_steps_sampled": 1537200, "sample_time_ms": 189650.251, "load_time_ms": 110.023, "grad_time_ms": 3805.497, "update_time_ms": 6.001, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1359.4619140625, "policy_loss": -0.017961153760552406, "vf_loss": 1359.479736328125, "vf_explained_var": 1.8246320010462114e-09, "kl": 0.018781065940856934, "entropy": 9.72304630279541, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1537200, "episodes_total": 3841, "training_iteration": 61, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_04-41-40", "timestamp": 1606777900, "time_this_iter_s": 194.09951210021973, "time_total_s": 12074.014328479767, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12074.014328479767, "timesteps_since_restore": 1537200, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 65.51949458483755, "ram_util_percent": 69.75595667870037}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -301.2686268434616, "episode_reward_min": -368.376926740363, "episode_reward_mean": -332.0625925930672, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.595949132271514, "mean_processing_ms": 3.5058947719020215, "mean_inference_ms": 1.6105004779751484}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1555456, "num_steps_sampled": 1562400, "sample_time_ms": 189678.029, "load_time_ms": 111.075, "grad_time_ms": 3807.354, "update_time_ms": 6.107, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1452.9569091796875, "policy_loss": -0.017770536243915558, "vf_loss": 1452.9744873046875, "vf_explained_var": -1.1251897191755234e-08, "kl": 0.016231343150138855, "entropy": 9.511951446533203, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1562400, "episodes_total": 3906, "training_iteration": 62, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_04-44-55", "timestamp": 1606778095, "time_this_iter_s": 194.3312623500824, "time_total_s": 12268.34559082985, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12268.34559082985, "timesteps_since_restore": 1562400, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 66.0173285198556, "ram_util_percent": 69.95415162454871}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -298.32023218906744, "episode_reward_min": -363.0260801167531, "episode_reward_mean": -331.30277777877643, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.584106456263875, "mean_processing_ms": 3.5051149346468504, "mean_inference_ms": 1.6097479364259601}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1580544, "num_steps_sampled": 1587600, "sample_time_ms": 189566.471, "load_time_ms": 111.115, "grad_time_ms": 3806.4, "update_time_ms": 6.254, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1404.2774658203125, "policy_loss": -0.018261361867189407, "vf_loss": 1404.2957763671875, "vf_explained_var": -4.257474817137563e-09, "kl": 0.018309185281395912, "entropy": 9.716912269592285, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1587600, "episodes_total": 3967, "training_iteration": 63, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_04-48-07", "timestamp": 1606778287, "time_this_iter_s": 192.54494428634644, "time_total_s": 12460.890535116196, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12460.890535116196, "timesteps_since_restore": 1587600, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 66.05381818181817, "ram_util_percent": 70.12218181818182}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -298.32023218906744, "episode_reward_min": -363.0260801167531, "episode_reward_mean": -331.8603765806906, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.57289561487151, "mean_processing_ms": 3.5047940863197766, "mean_inference_ms": 1.6089076362413595}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1605632, "num_steps_sampled": 1612800, "sample_time_ms": 189499.148, "load_time_ms": 109.488, "grad_time_ms": 3925.315, "update_time_ms": 6.621, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1501.7645263671875, "policy_loss": -0.015886563807725906, "vf_loss": 1501.7806396484375, "vf_explained_var": -1.2164213636367549e-08, "kl": 0.017045794054865837, "entropy": 9.765329360961914, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1612800, "episodes_total": 4032, "training_iteration": 64, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_04-51-20", "timestamp": 1606778480, "time_this_iter_s": 192.7588312625885, "time_total_s": 12653.649366378784, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12653.649366378784, "timesteps_since_restore": 1612800, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 66.15745454545454, "ram_util_percent": 70.28472727272728}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -289.13610930449425, "episode_reward_min": -366.8257670467697, "episode_reward_mean": -332.60399467046693, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.56570541645768, "mean_processing_ms": 3.5039362529961138, "mean_inference_ms": 1.60827008316528}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1630720, "num_steps_sampled": 1638000, "sample_time_ms": 189600.643, "load_time_ms": 108.939, "grad_time_ms": 3904.967, "update_time_ms": 6.675, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1457.46044921875, "policy_loss": -0.018119655549526215, "vf_loss": 1457.478271484375, "vf_explained_var": -1.0035475561664953e-08, "kl": 0.016275491565465927, "entropy": 9.954948425292969, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1638000, "episodes_total": 4093, "training_iteration": 65, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_04-54-35", "timestamp": 1606778675, "time_this_iter_s": 194.42663383483887, "time_total_s": 12848.076000213623, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12848.076000213623, "timesteps_since_restore": 1638000, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 65.70036101083032, "ram_util_percent": 70.35198555956678}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -289.13610930449425, "episode_reward_min": -366.8257670467697, "episode_reward_mean": -331.4434842318954, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.556425544873385, "mean_processing_ms": 3.5037463902935246, "mean_inference_ms": 1.60747690201974}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1655808, "num_steps_sampled": 1663200, "sample_time_ms": 189552.055, "load_time_ms": 115.755, "grad_time_ms": 3969.786, "update_time_ms": 6.652, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1554.4302978515625, "policy_loss": -0.017657501623034477, "vf_loss": 1554.4478759765625, "vf_explained_var": -9.123160005231057e-10, "kl": 0.019772622734308243, "entropy": 9.831575393676758, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1663200, "episodes_total": 4158, "training_iteration": 66, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_04-57-47", "timestamp": 1606778867, "time_this_iter_s": 192.95973873138428, "time_total_s": 13041.035738945007, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13041.035738945007, "timesteps_since_restore": 1663200, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 66.0970909090909, "ram_util_percent": 70.48254545454546}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -298.4810974886075, "episode_reward_min": -361.2113407178101, "episode_reward_mean": -332.10923472077803, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.551623285310946, "mean_processing_ms": 3.5029035054727364, "mean_inference_ms": 1.6070948788257438}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1680896, "num_steps_sampled": 1688400, "sample_time_ms": 189309.836, "load_time_ms": 120.469, "grad_time_ms": 3984.914, "update_time_ms": 6.238, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1498.22705078125, "policy_loss": -0.016627011820673943, "vf_loss": 1498.2437744140625, "vf_explained_var": -1.3076529192801445e-08, "kl": 0.016647251322865486, "entropy": 10.002779006958008, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1688400, "episodes_total": 4219, "training_iteration": 67, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_05-01-00", "timestamp": 1606779060, "time_this_iter_s": 192.36317563056946, "time_total_s": 13233.398914575577, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13233.398914575577, "timesteps_since_restore": 1688400, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 66.11934306569341, "ram_util_percent": 70.67299270072994}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -298.4810974886075, "episode_reward_min": -370.1708740393715, "episode_reward_mean": -332.2318684710593, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.53602743958706, "mean_processing_ms": 3.5034798635009223, "mean_inference_ms": 1.6060416113061953}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1705984, "num_steps_sampled": 1713600, "sample_time_ms": 189307.972, "load_time_ms": 125.079, "grad_time_ms": 4086.33, "update_time_ms": 5.821, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1598.9332275390625, "policy_loss": -0.01767871528863907, "vf_loss": 1598.9505615234375, "vf_explained_var": -1.0643686820799303e-08, "kl": 0.019553860649466515, "entropy": 9.866508483886719, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1713600, "episodes_total": 4284, "training_iteration": 68, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_05-04-14", "timestamp": 1606779254, "time_this_iter_s": 193.85682201385498, "time_total_s": 13427.255736589432, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13427.255736589432, "timesteps_since_restore": 1713600, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 65.52924187725631, "ram_util_percent": 70.85740072202167}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -301.4082892677539, "episode_reward_min": -357.6726950844961, "episode_reward_mean": -330.8274372847349, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.53007623974232, "mean_processing_ms": 3.502612182696065, "mean_inference_ms": 1.6056614546166634}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1731072, "num_steps_sampled": 1738800, "sample_time_ms": 189192.259, "load_time_ms": 118.642, "grad_time_ms": 4068.049, "update_time_ms": 5.414, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1534.0111083984375, "policy_loss": -0.01953127607703209, "vf_loss": 1534.0303955078125, "vf_explained_var": -9.123160005231057e-09, "kl": 0.020549077540636063, "entropy": 9.845623016357422, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1738800, "episodes_total": 4345, "training_iteration": 69, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_05-07-28", "timestamp": 1606779448, "time_this_iter_s": 193.8756606578827, "time_total_s": 13621.131397247314, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13621.131397247314, "timesteps_since_restore": 1738800, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 66.21949458483756, "ram_util_percent": 71.04584837545127}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -301.06364310473714, "episode_reward_min": -357.6909816446917, "episode_reward_mean": -328.5365831616164, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.517199250033016, "mean_processing_ms": 3.5031071205972455, "mean_inference_ms": 1.6047843570149218}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1756160, "num_steps_sampled": 1764000, "sample_time_ms": 189240.223, "load_time_ms": 114.679, "grad_time_ms": 4063.585, "update_time_ms": 5.805, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1623.89306640625, "policy_loss": -0.017623379826545715, "vf_loss": 1623.910400390625, "vf_explained_var": 3.3451585945698525e-09, "kl": 0.018479902297258377, "entropy": 9.537468910217285, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1764000, "episodes_total": 4410, "training_iteration": 70, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_05-10-41", "timestamp": 1606779641, "time_this_iter_s": 193.1578872203827, "time_total_s": 13814.289284467697, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13814.289284467697, "timesteps_since_restore": 1764000, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 66.26254545454545, "ram_util_percent": 70.29745454545454}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -304.5138101823636, "episode_reward_min": -359.9059348325674, "episode_reward_mean": -328.6481919455226, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.51329312530815, "mean_processing_ms": 3.5019308955015687, "mean_inference_ms": 1.6043015812641437}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1781248, "num_steps_sampled": 1789200, "sample_time_ms": 189398.314, "load_time_ms": 109.606, "grad_time_ms": 3990.148, "update_time_ms": 5.857, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1556.5736083984375, "policy_loss": -0.01666019856929779, "vf_loss": 1556.590087890625, "vf_explained_var": -5.778001188616599e-09, "kl": 0.018057197332382202, "entropy": 9.620431900024414, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1789200, "episodes_total": 4471, "training_iteration": 71, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_05-13-56", "timestamp": 1606779836, "time_this_iter_s": 194.89679217338562, "time_total_s": 14009.186076641083, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14009.186076641083, "timesteps_since_restore": 1789200, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 65.9226618705036, "ram_util_percent": 68.71007194244604}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -304.5138101823636, "episode_reward_min": -373.73097101762204, "episode_reward_mean": -332.327987249786, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.50591660623676, "mean_processing_ms": 3.5021318617503003, "mean_inference_ms": 1.6037925550886751}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1806336, "num_steps_sampled": 1814400, "sample_time_ms": 189554.628, "load_time_ms": 107.535, "grad_time_ms": 3814.451, "update_time_ms": 5.836, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1667.264404296875, "policy_loss": -0.018572332337498665, "vf_loss": 1667.28271484375, "vf_explained_var": 9.123160005231057e-10, "kl": 0.01913408935070038, "entropy": 9.470956802368164, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1814400, "episodes_total": 4536, "training_iteration": 72, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_05-17-10", "timestamp": 1606780030, "time_this_iter_s": 194.10892128944397, "time_total_s": 14203.294997930527, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14203.294997930527, "timesteps_since_restore": 1814400, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 66.03465703971119, "ram_util_percent": 67.71696750902528}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -300.7324915358222, "episode_reward_min": -373.73097101762204, "episode_reward_mean": -331.88556668761606, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.5019785441822, "mean_processing_ms": 3.5014680797167466, "mean_inference_ms": 1.603654099930095}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1831424, "num_steps_sampled": 1839600, "sample_time_ms": 189966.047, "load_time_ms": 101.937, "grad_time_ms": 3522.621, "update_time_ms": 5.25, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1589.3211669921875, "policy_loss": -0.01711534895002842, "vf_loss": 1589.33837890625, "vf_explained_var": 4.257474817137563e-09, "kl": 0.020906243473291397, "entropy": 9.580072402954102, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1839600, "episodes_total": 4597, "training_iteration": 73, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_05-20-24", "timestamp": 1606780224, "time_this_iter_s": 193.67123413085938, "time_total_s": 14396.966232061386, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14396.966232061386, "timesteps_since_restore": 1839600, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 65.61123188405799, "ram_util_percent": 67.9014492753623}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -294.9819388171421, "episode_reward_min": -361.5149502732828, "episode_reward_mean": -331.79271817515166, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.49152416202481, "mean_processing_ms": 3.5019873462751288, "mean_inference_ms": 1.6029152529382145}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1856512, "num_steps_sampled": 1864800, "sample_time_ms": 190190.202, "load_time_ms": 96.163, "grad_time_ms": 3417.723, "update_time_ms": 5.001, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1692.7493896484375, "policy_loss": -0.01763462834060192, "vf_loss": 1692.766845703125, "vf_explained_var": -6.082106485116867e-10, "kl": 0.018453145399689674, "entropy": 9.513303756713867, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1864800, "episodes_total": 4662, "training_iteration": 74, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_05-23-37", "timestamp": 1606780417, "time_this_iter_s": 193.89635801315308, "time_total_s": 14590.86259007454, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14590.86259007454, "timesteps_since_restore": 1864800, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 66.10649819494584, "ram_util_percent": 67.99638989169675}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -294.9819388171421, "episode_reward_min": -360.22108308314904, "episode_reward_mean": -329.5811709362903, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.49041581873802, "mean_processing_ms": 3.5008084543068274, "mean_inference_ms": 1.6026818959271254}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1881600, "num_steps_sampled": 1890000, "sample_time_ms": 190160.121, "load_time_ms": 90.492, "grad_time_ms": 3351.695, "update_time_ms": 5.327, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1622.378173828125, "policy_loss": -0.019204935058951378, "vf_loss": 1622.3973388671875, "vf_explained_var": -8.210843560618741e-09, "kl": 0.01981063187122345, "entropy": 9.599934577941895, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1890000, "episodes_total": 4723, "training_iteration": 75, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_05-26-51", "timestamp": 1606780611, "time_this_iter_s": 193.411141872406, "time_total_s": 14784.273731946945, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14784.273731946945, "timesteps_since_restore": 1890000, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 65.7978260869565, "ram_util_percent": 68.14239130434784}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -296.832159704269, "episode_reward_min": -373.63498147061244, "episode_reward_mean": -330.74905579634463, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.47956745224265, "mean_processing_ms": 3.501005911127097, "mean_inference_ms": 1.6018324254874516}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1906688, "num_steps_sampled": 1915200, "sample_time_ms": 190159.543, "load_time_ms": 85.666, "grad_time_ms": 3366.012, "update_time_ms": 5.313, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1711.342529296875, "policy_loss": -0.019084567204117775, "vf_loss": 1711.3614501953125, "vf_explained_var": 4.5615800026155284e-09, "kl": 0.022186266258358955, "entropy": 9.437731742858887, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1915200, "episodes_total": 4788, "training_iteration": 76, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_05-30-04", "timestamp": 1606780804, "time_this_iter_s": 193.04755854606628, "time_total_s": 14977.321290493011, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14977.321290493011, "timesteps_since_restore": 1915200, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 66.35818181818182, "ram_util_percent": 68.30363636363636}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -298.9812859629739, "episode_reward_min": -369.74364607180377, "episode_reward_mean": -329.85289318726217, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.473089360337354, "mean_processing_ms": 3.4999648575366944, "mean_inference_ms": 1.6012315326457263}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1931776, "num_steps_sampled": 1940400, "sample_time_ms": 190158.003, "load_time_ms": 83.814, "grad_time_ms": 3375.522, "update_time_ms": 5.331, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1642.4566650390625, "policy_loss": -0.0186854787170887, "vf_loss": 1642.4754638671875, "vf_explained_var": -6.690317189139705e-09, "kl": 0.021668141707777977, "entropy": 9.594677925109863, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1940400, "episodes_total": 4849, "training_iteration": 77, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_05-33-16", "timestamp": 1606780996, "time_this_iter_s": 192.4310085773468, "time_total_s": 15169.752299070358, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 15169.752299070358, "timesteps_since_restore": 1940400, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 66.01715328467154, "ram_util_percent": 68.45401459854016}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -300.85820442281533, "episode_reward_min": -373.68177031218585, "episode_reward_mean": -329.4778757783286, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.463797702183804, "mean_processing_ms": 3.4999382862877373, "mean_inference_ms": 1.6006002024609043}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1956864, "num_steps_sampled": 1965600, "sample_time_ms": 190078.756, "load_time_ms": 80.728, "grad_time_ms": 3340.955, "update_time_ms": 5.665, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1738.6441650390625, "policy_loss": -0.01789884828031063, "vf_loss": 1738.6619873046875, "vf_explained_var": -5.778001188616599e-09, "kl": 0.02016500011086464, "entropy": 9.246085166931152, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1965600, "episodes_total": 4914, "training_iteration": 78, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_05-36-29", "timestamp": 1606781189, "time_this_iter_s": 192.6902792453766, "time_total_s": 15362.442578315735, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 15362.442578315735, "timesteps_since_restore": 1965600, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 65.75672727272726, "ram_util_percent": 68.65781818181819}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -300.85820442281533, "episode_reward_min": -359.6944807830022, "episode_reward_mean": -330.90094114398636, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.456030591239866, "mean_processing_ms": 3.499402826182285, "mean_inference_ms": 1.6000799907193033}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1981952, "num_steps_sampled": 1990800, "sample_time_ms": 190204.054, "load_time_ms": 85.155, "grad_time_ms": 3284.09, "update_time_ms": 5.652, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1660.8626708984375, "policy_loss": -0.015810001641511917, "vf_loss": 1660.8785400390625, "vf_explained_var": -2.1287374085687816e-09, "kl": 0.019287962466478348, "entropy": 9.46894645690918, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 1990800, "episodes_total": 4975, "training_iteration": 79, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_05-39-44", "timestamp": 1606781384, "time_this_iter_s": 194.59715962409973, "time_total_s": 15557.039737939835, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 15557.039737939835, "timesteps_since_restore": 1990800, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 65.39280575539567, "ram_util_percent": 68.86043165467626}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -299.8553139602088, "episode_reward_min": -359.2328601138237, "episode_reward_mean": -330.4446886672898, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.445671636353836, "mean_processing_ms": 3.499411919337334, "mean_inference_ms": 1.599395841527131}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2007040, "num_steps_sampled": 2016000, "sample_time_ms": 190072.963, "load_time_ms": 88.427, "grad_time_ms": 3478.06, "update_time_ms": 5.281, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1764.6358642578125, "policy_loss": -0.016469806432724, "vf_loss": 1764.6524658203125, "vf_explained_var": 6.082106485116867e-10, "kl": 0.01845850795507431, "entropy": 9.381139755249023, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2016000, "episodes_total": 5040, "training_iteration": 80, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_05-42-58", "timestamp": 1606781578, "time_this_iter_s": 193.80767107009888, "time_total_s": 15750.847409009933, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 15750.847409009933, "timesteps_since_restore": 2016000, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 65.71630434782608, "ram_util_percent": 69.02608695652172}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -299.51140947065977, "episode_reward_min": -373.5109411547465, "episode_reward_mean": -332.02144781698996, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.44128880988618, "mean_processing_ms": 3.4986183456896693, "mean_inference_ms": 1.5990255003927163}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2032128, "num_steps_sampled": 2041200, "sample_time_ms": 189710.749, "load_time_ms": 89.644, "grad_time_ms": 3666.919, "update_time_ms": 4.849, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1685.9739990234375, "policy_loss": -0.01782231219112873, "vf_loss": 1685.9913330078125, "vf_explained_var": -1.2468318821845514e-08, "kl": 0.021920310333371162, "entropy": 9.50084400177002, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2041200, "episodes_total": 5101, "training_iteration": 81, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_05-46-11", "timestamp": 1606781771, "time_this_iter_s": 193.17709398269653, "time_total_s": 15944.02450299263, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 15944.02450299263, "timesteps_since_restore": 2041200, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 65.93586956521737, "ram_util_percent": 69.27717391304348}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -299.51140947065977, "episode_reward_min": -373.5109411547465, "episode_reward_mean": -331.60798347672835, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.430266522028276, "mean_processing_ms": 3.498757174907937, "mean_inference_ms": 1.5983138871984044}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2057216, "num_steps_sampled": 2066400, "sample_time_ms": 189572.733, "load_time_ms": 90.475, "grad_time_ms": 3593.132, "update_time_ms": 5.162, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1776.8995361328125, "policy_loss": -0.019119851291179657, "vf_loss": 1776.918701171875, "vf_explained_var": -1.2164213636367549e-08, "kl": 0.019829388707876205, "entropy": 9.234909057617188, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2066400, "episodes_total": 5166, "training_iteration": 82, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_05-49-23", "timestamp": 1606781963, "time_this_iter_s": 192.01032972335815, "time_total_s": 16136.034832715988, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16136.034832715988, "timesteps_since_restore": 2066400, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 65.83722627737227, "ram_util_percent": 69.46277372262774}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -300.09320742063835, "episode_reward_min": -367.19785161865514, "episode_reward_mean": -332.3853247774467, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.425424727484675, "mean_processing_ms": 3.498019181670198, "mean_inference_ms": 1.5979748401961968}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2082304, "num_steps_sampled": 2091600, "sample_time_ms": 189580.674, "load_time_ms": 96.299, "grad_time_ms": 3735.871, "update_time_ms": 5.535, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1703.5428466796875, "policy_loss": -0.018428074195981026, "vf_loss": 1703.561279296875, "vf_explained_var": -3.0410532425584336e-10, "kl": 0.022339921444654465, "entropy": 9.338611602783203, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2091600, "episodes_total": 5227, "training_iteration": 83, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_05-52-38", "timestamp": 1606782158, "time_this_iter_s": 195.2423849105835, "time_total_s": 16331.277217626572, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16331.277217626572, "timesteps_since_restore": 2091600, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 65.5636690647482, "ram_util_percent": 69.66798561151079}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -299.78419813775116, "episode_reward_min": -369.2687173705931, "episode_reward_mean": -331.1815371959164, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.419530613787316, "mean_processing_ms": 3.497639000093358, "mean_inference_ms": 1.5974927013605673}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2107392, "num_steps_sampled": 2116800, "sample_time_ms": 189277.739, "load_time_ms": 97.969, "grad_time_ms": 3827.046, "update_time_ms": 5.465, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1806.0911865234375, "policy_loss": -0.018370741978287697, "vf_loss": 1806.109375, "vf_explained_var": -1.8246320010462114e-09, "kl": 0.02300652116537094, "entropy": 9.149890899658203, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2116800, "episodes_total": 5292, "training_iteration": 84, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_05-55-50", "timestamp": 1606782350, "time_this_iter_s": 191.79494547843933, "time_total_s": 16523.07216310501, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16523.07216310501, "timesteps_since_restore": 2116800, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 66.43868613138686, "ram_util_percent": 69.77007299270073}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -303.7346003656903, "episode_reward_min": -369.2687173705931, "episode_reward_mean": -331.14700842391875, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.41839891312758, "mean_processing_ms": 3.4967290549734305, "mean_inference_ms": 1.597474335128851}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2132480, "num_steps_sampled": 2142000, "sample_time_ms": 189230.641, "load_time_ms": 98.954, "grad_time_ms": 3825.757, "update_time_ms": 5.546, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1717.54833984375, "policy_loss": -0.017783649265766144, "vf_loss": 1717.5660400390625, "vf_explained_var": -5.778001188616599e-09, "kl": 0.02117697335779667, "entropy": 9.415132522583008, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2142000, "episodes_total": 5353, "training_iteration": 85, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_05-59-03", "timestamp": 1606782543, "time_this_iter_s": 192.93885803222656, "time_total_s": 16716.011021137238, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16716.011021137238, "timesteps_since_restore": 2142000, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 66.00072727272726, "ram_util_percent": 69.94909090909091}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -303.7346003656903, "episode_reward_min": -362.7210834819779, "episode_reward_mean": -331.1097329010295, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.40702454248908, "mean_processing_ms": 3.497424984849337, "mean_inference_ms": 1.5966904972911395}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2157568, "num_steps_sampled": 2167200, "sample_time_ms": 189253.868, "load_time_ms": 100.949, "grad_time_ms": 3859.383, "update_time_ms": 5.545, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1816.372802734375, "policy_loss": -0.01768787018954754, "vf_loss": 1816.3902587890625, "vf_explained_var": -7.2985280041848455e-09, "kl": 0.023950697854161263, "entropy": 9.208441734313965, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2167200, "episodes_total": 5418, "training_iteration": 86, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_06-02-17", "timestamp": 1606782737, "time_this_iter_s": 193.6374228000641, "time_total_s": 16909.6484439373, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16909.6484439373, "timesteps_since_restore": 2167200, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 65.60072463768115, "ram_util_percent": 69.98913043478261}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -300.32737514107964, "episode_reward_min": -361.27427630770217, "episode_reward_mean": -331.3949301385044, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.403865742503704, "mean_processing_ms": 3.49670874533263, "mean_inference_ms": 1.5962385243793948}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2182656, "num_steps_sampled": 2192400, "sample_time_ms": 189237.613, "load_time_ms": 98.754, "grad_time_ms": 3990.673, "update_time_ms": 5.53, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1730.997802734375, "policy_loss": -0.018807178363204002, "vf_loss": 1731.0166015625, "vf_explained_var": -4.5615800026155284e-09, "kl": 0.024792123585939407, "entropy": 9.616189956665039, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2192400, "episodes_total": 5479, "training_iteration": 87, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_06-05-30", "timestamp": 1606782930, "time_this_iter_s": 193.55245995521545, "time_total_s": 17103.200903892517, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 17103.200903892517, "timesteps_since_restore": 2192400, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 66.1054347826087, "ram_util_percent": 70.21050724637682}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -298.8698123924181, "episode_reward_min": -361.9519659795729, "episode_reward_mean": -331.3914730795579, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.39771648439476, "mean_processing_ms": 3.4964560606324344, "mean_inference_ms": 1.5957505148414497}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2207744, "num_steps_sampled": 2217600, "sample_time_ms": 189021.37, "load_time_ms": 95.525, "grad_time_ms": 4091.845, "update_time_ms": 5.191, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1832.48974609375, "policy_loss": -0.017412636429071426, "vf_loss": 1832.5069580078125, "vf_explained_var": -6.690317189139705e-09, "kl": 0.021913910284638405, "entropy": 9.182217597961426, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2217600, "episodes_total": 5544, "training_iteration": 88, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_06-08-42", "timestamp": 1606783122, "time_this_iter_s": 191.51185297966003, "time_total_s": 17294.712756872177, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 17294.712756872177, "timesteps_since_restore": 2217600, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 66.25474452554744, "ram_util_percent": 70.38613138686131}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -302.69904318622446, "episode_reward_min": -359.27686466499017, "episode_reward_mean": -328.31258830928186, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.39386653756039, "mean_processing_ms": 3.4956596449399964, "mean_inference_ms": 1.5954432888756072}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2232832, "num_steps_sampled": 2242800, "sample_time_ms": 189045.329, "load_time_ms": 91.153, "grad_time_ms": 4001.788, "update_time_ms": 5.502, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1738.438720703125, "policy_loss": -0.014801056124269962, "vf_loss": 1738.4534912109375, "vf_explained_var": -5.169790817660669e-09, "kl": 0.02092832885682583, "entropy": 9.244776725769043, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2242800, "episodes_total": 5605, "training_iteration": 89, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_06-11-56", "timestamp": 1606783316, "time_this_iter_s": 193.90335941314697, "time_total_s": 17488.616116285324, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 17488.616116285324, "timesteps_since_restore": 2242800, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 65.7050724637681, "ram_util_percent": 70.51811594202898}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -291.9831363544818, "episode_reward_min": -369.38786838586907, "episode_reward_mean": -327.08817210482124, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.38872550944209, "mean_processing_ms": 3.4955779292893614, "mean_inference_ms": 1.595058584993399}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2257920, "num_steps_sampled": 2268000, "sample_time_ms": 189280.863, "load_time_ms": 91.568, "grad_time_ms": 3784.094, "update_time_ms": 6.218, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1846.4541015625, "policy_loss": -0.018828198313713074, "vf_loss": 1846.4725341796875, "vf_explained_var": -3.6492640020924227e-09, "kl": 0.021532366052269936, "entropy": 8.853080749511719, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2268000, "episodes_total": 5670, "training_iteration": 90, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_06-15-10", "timestamp": 1606783510, "time_this_iter_s": 194.00810146331787, "time_total_s": 17682.624217748642, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 17682.624217748642, "timesteps_since_restore": 2268000, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 65.9913357400722, "ram_util_percent": 70.68303249097474}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -291.9831363544818, "episode_reward_min": -369.38786838586907, "episode_reward_mean": -327.85374232522577, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.385448699711944, "mean_processing_ms": 3.4951218474072085, "mean_inference_ms": 1.5948500504113867}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2283008, "num_steps_sampled": 2293200, "sample_time_ms": 189432.738, "load_time_ms": 91.353, "grad_time_ms": 3579.352, "update_time_ms": 6.604, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1738.421875, "policy_loss": -0.016776157543063164, "vf_loss": 1738.4384765625, "vf_explained_var": -7.60263318966281e-09, "kl": 0.023387718945741653, "entropy": 8.906737327575684, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2293200, "episodes_total": 5731, "training_iteration": 91, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_06-18-22", "timestamp": 1606783702, "time_this_iter_s": 192.65111231803894, "time_total_s": 17875.27533006668, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 17875.27533006668, "timesteps_since_restore": 2293200, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 65.92618181818182, "ram_util_percent": 70.83163636363635}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -301.0063917207253, "episode_reward_min": -358.22083857465196, "episode_reward_mean": -325.58296980408255, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.380787202677084, "mean_processing_ms": 3.4951215313480954, "mean_inference_ms": 1.5945316479866398}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2308096, "num_steps_sampled": 2318400, "sample_time_ms": 189437.189, "load_time_ms": 91.081, "grad_time_ms": 3698.408, "update_time_ms": 6.568, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1834.1593017578125, "policy_loss": -0.017967088147997856, "vf_loss": 1834.177001953125, "vf_explained_var": -1.5205267045459436e-09, "kl": 0.02183466963469982, "entropy": 8.576701164245605, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2318400, "episodes_total": 5796, "training_iteration": 92, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_06-21-36", "timestamp": 1606783896, "time_this_iter_s": 193.23494696617126, "time_total_s": 18068.510277032852, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 18068.510277032852, "timesteps_since_restore": 2318400, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 66.63600000000001, "ram_util_percent": 71.30436363636363}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -290.0470196083509, "episode_reward_min": -355.2318744243013, "episode_reward_mean": -325.45870991930286, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.37569095111599, "mean_processing_ms": 3.4944182383400646, "mean_inference_ms": 1.594179697549647}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2333184, "num_steps_sampled": 2343600, "sample_time_ms": 189128.417, "load_time_ms": 90.32, "grad_time_ms": 3695.06, "update_time_ms": 6.198, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1741.6025390625, "policy_loss": -0.018100552260875702, "vf_loss": 1741.6204833984375, "vf_explained_var": -4.865685188093494e-09, "kl": 0.02204040065407753, "entropy": 8.785181999206543, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2343600, "episodes_total": 5857, "training_iteration": 93, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_06-24-48", "timestamp": 1606784088, "time_this_iter_s": 192.1079351902008, "time_total_s": 18260.618212223053, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 18260.618212223053, "timesteps_since_restore": 2343600, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 65.5970802919708, "ram_util_percent": 71.43065693430657}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -287.1390683088208, "episode_reward_min": -355.2318744243013, "episode_reward_mean": -324.66708064453803, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.36775265333745, "mean_processing_ms": 3.4944583823967195, "mean_inference_ms": 1.5935984485555144}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2358272, "num_steps_sampled": 2368800, "sample_time_ms": 189249.03, "load_time_ms": 89.756, "grad_time_ms": 3583.941, "update_time_ms": 6.24, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1840.47900390625, "policy_loss": -0.016380680724978447, "vf_loss": 1840.495361328125, "vf_explained_var": -9.427265190709022e-09, "kl": 0.021769674494862556, "entropy": 8.404073715209961, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2368800, "episodes_total": 5922, "training_iteration": 94, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_06-28-00", "timestamp": 1606784280, "time_this_iter_s": 191.88448309898376, "time_total_s": 18452.502695322037, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 18452.502695322037, "timesteps_since_restore": 2368800, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 65.97700729927007, "ram_util_percent": 71.60583941605839}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -287.1390683088208, "episode_reward_min": -363.2267157723283, "episode_reward_mean": -323.4249018783344, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.36526566350076, "mean_processing_ms": 3.493978961782149, "mean_inference_ms": 1.5935487742815815}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2383360, "num_steps_sampled": 2394000, "sample_time_ms": 189176.313, "load_time_ms": 90.474, "grad_time_ms": 3588.972, "update_time_ms": 6.303, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1742.6014404296875, "policy_loss": -0.01664002239704132, "vf_loss": 1742.6180419921875, "vf_explained_var": -1.2164212970233734e-09, "kl": 0.019858932122588158, "entropy": 8.891023635864258, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2394000, "episodes_total": 5983, "training_iteration": 95, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_06-31-12", "timestamp": 1606784472, "time_this_iter_s": 192.26949000358582, "time_total_s": 18644.772185325623, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 18644.772185325623, "timesteps_since_restore": 2394000, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 65.80255474452554, "ram_util_percent": 71.8448905109489}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -292.19730074858796, "episode_reward_min": -363.2267157723283, "episode_reward_mean": -324.3768862081781, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.35427578298919, "mean_processing_ms": 3.494471742995969, "mean_inference_ms": 1.5928567063147687}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2408448, "num_steps_sampled": 2419200, "sample_time_ms": 189103.131, "load_time_ms": 93.337, "grad_time_ms": 3678.993, "update_time_ms": 6.342, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1833.8319091796875, "policy_loss": -0.02039226144552231, "vf_loss": 1833.8524169921875, "vf_explained_var": -9.731370376186987e-09, "kl": 0.0226735919713974, "entropy": 8.563298225402832, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2419200, "episodes_total": 6048, "training_iteration": 96, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_06-34-26", "timestamp": 1606784666, "time_this_iter_s": 193.8370714187622, "time_total_s": 18838.609256744385, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 18838.609256744385, "timesteps_since_restore": 2419200, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 65.83610108303249, "ram_util_percent": 71.23862815884476}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -295.3306643280399, "episode_reward_min": -361.92893692227227, "episode_reward_mean": -322.9370981403997, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.35434028905121, "mean_processing_ms": 3.4935322606752495, "mean_inference_ms": 1.592651685826672}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2433536, "num_steps_sampled": 2444400, "sample_time_ms": 189287.903, "load_time_ms": 96.853, "grad_time_ms": 3524.162, "update_time_ms": 6.424, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1733.3792724609375, "policy_loss": -0.01786404475569725, "vf_loss": 1733.39697265625, "vf_explained_var": -4.865685188093494e-09, "kl": 0.020917564630508423, "entropy": 8.903817176818848, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2444400, "episodes_total": 6109, "training_iteration": 97, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_06-37-40", "timestamp": 1606784860, "time_this_iter_s": 193.96876001358032, "time_total_s": 19032.578016757965, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19032.578016757965, "timesteps_since_restore": 2444400, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 65.54657039711192, "ram_util_percent": 70.89061371841154}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -301.7717192635294, "episode_reward_min": -359.8775656918344, "episode_reward_mean": -325.07387085292964, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.3449097012978, "mean_processing_ms": 3.4936347643223233, "mean_inference_ms": 1.5920715268606591}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2458624, "num_steps_sampled": 2469600, "sample_time_ms": 189473.668, "load_time_ms": 102.63, "grad_time_ms": 3465.561, "update_time_ms": 6.756, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1827.0889892578125, "policy_loss": -0.018221762031316757, "vf_loss": 1827.10693359375, "vf_explained_var": -5.473896003138634e-09, "kl": 0.023775257170200348, "entropy": 8.519438743591309, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2469600, "episodes_total": 6174, "training_iteration": 98, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_06-40-53", "timestamp": 1606785053, "time_this_iter_s": 192.8379340171814, "time_total_s": 19225.415950775146, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19225.415950775146, "timesteps_since_restore": 2469600, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 65.80727272727273, "ram_util_percent": 71.12727272727273}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -301.80004253856356, "episode_reward_min": -359.8775656918344, "episode_reward_mean": -324.98451846955885, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.34240086096644, "mean_processing_ms": 3.493024608626548, "mean_inference_ms": 1.5918977360159723}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2483712, "num_steps_sampled": 2494800, "sample_time_ms": 189488.36, "load_time_ms": 107.26, "grad_time_ms": 3390.063, "update_time_ms": 6.571, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1739.939697265625, "policy_loss": -0.016691552475094795, "vf_loss": 1739.9560546875, "vf_explained_var": -1.5813476750281552e-08, "kl": 0.02159351296722889, "entropy": 8.885604858398438, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2494800, "episodes_total": 6235, "training_iteration": 99, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_06-44-06", "timestamp": 1606785246, "time_this_iter_s": 193.34067249298096, "time_total_s": 19418.756623268127, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19418.756623268127, "timesteps_since_restore": 2494800, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 66.21781818181819, "ram_util_percent": 71.29381818181817}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -294.90524182652496, "episode_reward_min": -358.5745486310766, "episode_reward_mean": -325.6551527951618, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.34023426382633, "mean_processing_ms": 3.4929973906612077, "mean_inference_ms": 1.591622186177231}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2508800, "num_steps_sampled": 2520000, "sample_time_ms": 189418.511, "load_time_ms": 101.726, "grad_time_ms": 3365.462, "update_time_ms": 6.186, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1845.0579833984375, "policy_loss": -0.0158720500767231, "vf_loss": 1845.073974609375, "vf_explained_var": -1.0035475561664953e-08, "kl": 0.0262985248118639, "entropy": 8.725358009338379, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2520000, "episodes_total": 6300, "training_iteration": 100, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_06-47-19", "timestamp": 1606785439, "time_this_iter_s": 193.00111365318298, "time_total_s": 19611.75773692131, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19611.75773692131, "timesteps_since_restore": 2520000, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 67.0572463768116, "ram_util_percent": 71.55144927536232}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -300.3948621822997, "episode_reward_min": -353.7629556407736, "episode_reward_mean": -326.0414834928645, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.34251060218729, "mean_processing_ms": 3.49225986333259, "mean_inference_ms": 1.5917855179789149}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2533888, "num_steps_sampled": 2545200, "sample_time_ms": 189553.318, "load_time_ms": 105.63, "grad_time_ms": 3392.604, "update_time_ms": 6.327, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1752.1119384765625, "policy_loss": -0.016808073967695236, "vf_loss": 1752.1285400390625, "vf_explained_var": -1.5813476750281552e-08, "kl": 0.02002641372382641, "entropy": 8.677024841308594, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2545200, "episodes_total": 6361, "training_iteration": 101, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_06-50-33", "timestamp": 1606785633, "time_this_iter_s": 194.31190276145935, "time_total_s": 19806.06963968277, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19806.06963968277, "timesteps_since_restore": 2545200, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 65.7826714801444, "ram_util_percent": 71.66425992779783}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -303.1185659725374, "episode_reward_min": -365.55791958117993, "episode_reward_mean": -325.2411628187629, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.33384862244848, "mean_processing_ms": 3.49283770332941, "mean_inference_ms": 1.5912049700371476}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2558976, "num_steps_sampled": 2570400, "sample_time_ms": 189598.682, "load_time_ms": 105.15, "grad_time_ms": 3288.253, "update_time_ms": 6.321, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1837.2977294921875, "policy_loss": -0.01906442828476429, "vf_loss": 1837.316650390625, "vf_explained_var": -3.953369187570388e-09, "kl": 0.025345105677843094, "entropy": 8.418506622314453, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2570400, "episodes_total": 6426, "training_iteration": 102, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_06-53-46", "timestamp": 1606785826, "time_this_iter_s": 192.64039254188538, "time_total_s": 19998.710032224655, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19998.710032224655, "timesteps_since_restore": 2570400, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 66.10618181818181, "ram_util_percent": 71.77381818181819}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -300.08344682982755, "episode_reward_min": -371.2223128180439, "episode_reward_mean": -326.4479693247973, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.333400868069354, "mean_processing_ms": 3.4922206253951846, "mean_inference_ms": 1.5910113690651506}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2584064, "num_steps_sampled": 2595600, "sample_time_ms": 189845.546, "load_time_ms": 101.418, "grad_time_ms": 3274.698, "update_time_ms": 6.53, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1753.083251953125, "policy_loss": -0.01787448301911354, "vf_loss": 1753.1007080078125, "vf_explained_var": -3.953369187570388e-09, "kl": 0.021856633946299553, "entropy": 8.538406372070312, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2595600, "episodes_total": 6487, "training_iteration": 103, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_06-57-01", "timestamp": 1606786021, "time_this_iter_s": 194.41273951530457, "time_total_s": 20193.12277173996, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 20193.12277173996, "timesteps_since_restore": 2595600, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 66.12635379061372, "ram_util_percent": 71.87436823104692}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -300.08344682982755, "episode_reward_min": -371.2223128180439, "episode_reward_mean": -326.03561087939494, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.329373638622904, "mean_processing_ms": 3.492317843966737, "mean_inference_ms": 1.5907415853558629}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2609152, "num_steps_sampled": 2620800, "sample_time_ms": 189820.193, "load_time_ms": 106.305, "grad_time_ms": 3420.272, "update_time_ms": 6.788, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1848.0286865234375, "policy_loss": -0.016764698550105095, "vf_loss": 1848.045654296875, "vf_explained_var": -3.953369187570388e-09, "kl": 0.019713250920176506, "entropy": 8.135446548461914, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2620800, "episodes_total": 6552, "training_iteration": 104, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_07-00-14", "timestamp": 1606786214, "time_this_iter_s": 193.1315634250641, "time_total_s": 20386.254335165024, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 20386.254335165024, "timesteps_since_restore": 2620800, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 66.13927272727274, "ram_util_percent": 72.26472727272727}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -283.8662742224855, "episode_reward_min": -353.93620261227915, "episode_reward_mean": -322.91018921539785, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.32966244393844, "mean_processing_ms": 3.4916564314184093, "mean_inference_ms": 1.5907109162907298}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2634240, "num_steps_sampled": 2646000, "sample_time_ms": 189606.724, "load_time_ms": 106.653, "grad_time_ms": 3458.21, "update_time_ms": 6.256, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1748.561279296875, "policy_loss": -0.019931768998503685, "vf_loss": 1748.5810546875, "vf_explained_var": -8.210843560618741e-09, "kl": 0.026389271020889282, "entropy": 7.957690238952637, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2646000, "episodes_total": 6613, "training_iteration": 105, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_07-03-24", "timestamp": 1606786404, "time_this_iter_s": 190.5202968120575, "time_total_s": 20576.77463197708, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 20576.77463197708, "timesteps_since_restore": 2646000, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 66.18713235294118, "ram_util_percent": 72.41617647058823}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -283.8662742224855, "episode_reward_min": -351.26087786375166, "episode_reward_mean": -321.67718186727564, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.320845540068504, "mean_processing_ms": 3.492262529908615, "mean_inference_ms": 1.5901985015063105}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2659328, "num_steps_sampled": 2671200, "sample_time_ms": 189824.34, "load_time_ms": 100.453, "grad_time_ms": 3258.633, "update_time_ms": 6.627, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1833.1802978515625, "policy_loss": -0.014847425743937492, "vf_loss": 1833.1951904296875, "vf_explained_var": -8.514949634275126e-09, "kl": 0.022403312847018242, "entropy": 7.69742488861084, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2671200, "episodes_total": 6678, "training_iteration": 106, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_07-06-38", "timestamp": 1606786598, "time_this_iter_s": 193.96483540534973, "time_total_s": 20770.73946738243, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 20770.73946738243, "timesteps_since_restore": 2671200, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 66.07617328519856, "ram_util_percent": 72.58916967509026}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -293.8040113987683, "episode_reward_min": -351.93889391068325, "episode_reward_mean": -323.96550982999014, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.32183971025906, "mean_processing_ms": 3.491470022482497, "mean_inference_ms": 1.5904034906260012}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2684416, "num_steps_sampled": 2696400, "sample_time_ms": 189875.75, "load_time_ms": 96.188, "grad_time_ms": 3365.544, "update_time_ms": 7.059, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1744.01806640625, "policy_loss": -0.016869908198714256, "vf_loss": 1744.0345458984375, "vf_explained_var": -2.736948001569317e-09, "kl": 0.02551227994263172, "entropy": 8.11587142944336, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2696400, "episodes_total": 6739, "training_iteration": 107, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_07-09-54", "timestamp": 1606786794, "time_this_iter_s": 195.44010186195374, "time_total_s": 20966.179569244385, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 20966.179569244385, "timesteps_since_restore": 2696400, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 65.66559139784947, "ram_util_percent": 72.79498207885304}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -291.54267966035525, "episode_reward_min": -351.93889391068325, "episode_reward_mean": -322.68425290258546, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.3140106817802, "mean_processing_ms": 3.4919223739996954, "mean_inference_ms": 1.5899013941110252}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2709504, "num_steps_sampled": 2721600, "sample_time_ms": 189951.585, "load_time_ms": 96.129, "grad_time_ms": 3288.319, "update_time_ms": 7.316, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1839.779296875, "policy_loss": -0.017820056527853012, "vf_loss": 1839.7972412109375, "vf_explained_var": -1.1251897191755234e-08, "kl": 0.023759454488754272, "entropy": 7.840878009796143, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2721600, "episodes_total": 6804, "training_iteration": 108, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_07-13-07", "timestamp": 1606786987, "time_this_iter_s": 192.83256912231445, "time_total_s": 21159.0121383667, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21159.0121383667, "timesteps_since_restore": 2721600, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 66.02181818181818, "ram_util_percent": 72.95381818181818}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -291.54267966035525, "episode_reward_min": -355.14931542912035, "episode_reward_mean": -322.00906815086904, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.31413853640613, "mean_processing_ms": 3.4911316733901403, "mean_inference_ms": 1.5899165014365964}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2734592, "num_steps_sampled": 2746800, "sample_time_ms": 189770.211, "load_time_ms": 96.659, "grad_time_ms": 3303.342, "update_time_ms": 7.58, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1752.2581787109375, "policy_loss": -0.017562221735715866, "vf_loss": 1752.2755126953125, "vf_explained_var": 1.2164212970233734e-09, "kl": 0.023418299853801727, "entropy": 8.152790069580078, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2746800, "episodes_total": 6865, "training_iteration": 109, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_07-16-18", "timestamp": 1606787178, "time_this_iter_s": 191.67729091644287, "time_total_s": 21350.689429283142, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21350.689429283142, "timesteps_since_restore": 2746800, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 66.44908424908424, "ram_util_percent": 73.08021978021979}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -293.78705709764085, "episode_reward_min": -361.5001662042954, "episode_reward_mean": -323.89177657896164, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.305314970381374, "mean_processing_ms": 3.4915536215927996, "mean_inference_ms": 1.5893964771965567}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2759680, "num_steps_sampled": 2772000, "sample_time_ms": 189765.869, "load_time_ms": 101.485, "grad_time_ms": 3326.387, "update_time_ms": 7.534, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1840.5164794921875, "policy_loss": -0.019065508618950844, "vf_loss": 1840.5352783203125, "vf_explained_var": 6.99442281870688e-09, "kl": 0.025434531271457672, "entropy": 7.954558849334717, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2772000, "episodes_total": 6930, "training_iteration": 110, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_07-19-32", "timestamp": 1606787372, "time_this_iter_s": 193.23630452156067, "time_total_s": 21543.925733804703, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21543.925733804703, "timesteps_since_restore": 2772000, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 65.85942028985507, "ram_util_percent": 73.28804347826087}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -293.78705709764085, "episode_reward_min": -361.5001662042954, "episode_reward_mean": -325.8360630263797, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.306626117557975, "mean_processing_ms": 3.4905871668328596, "mean_inference_ms": 1.589382697873268}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2784768, "num_steps_sampled": 2797200, "sample_time_ms": 189540.651, "load_time_ms": 101.601, "grad_time_ms": 3343.169, "update_time_ms": 7.068, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1737.8370361328125, "policy_loss": -0.014677569270133972, "vf_loss": 1737.8516845703125, "vf_explained_var": -5.473896003138634e-09, "kl": 0.025053832679986954, "entropy": 8.02490520477295, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2797200, "episodes_total": 6991, "training_iteration": 111, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_07-22-44", "timestamp": 1606787564, "time_this_iter_s": 192.21793341636658, "time_total_s": 21736.14366722107, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21736.14366722107, "timesteps_since_restore": 2797200, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 65.88175182481751, "ram_util_percent": 73.45948905109488}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -296.22886387173656, "episode_reward_min": -361.6444757194145, "episode_reward_mean": -326.36365168073377, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.298902363885915, "mean_processing_ms": 3.490710924078009, "mean_inference_ms": 1.588819330383012}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2809856, "num_steps_sampled": 2822400, "sample_time_ms": 189461.049, "load_time_ms": 103.025, "grad_time_ms": 3535.178, "update_time_ms": 6.702, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1852.5618896484375, "policy_loss": -0.020325694233179092, "vf_loss": 1852.582275390625, "vf_explained_var": -1.0947792006277268e-08, "kl": 0.02953309938311577, "entropy": 7.844801425933838, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2822400, "episodes_total": 7056, "training_iteration": 112, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_07-25-58", "timestamp": 1606787758, "time_this_iter_s": 193.775456905365, "time_total_s": 21929.919124126434, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21929.919124126434, "timesteps_since_restore": 2822400, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 66.31739130434784, "ram_util_percent": 73.65869565217392}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -298.5590665494175, "episode_reward_min": -358.7482988494583, "episode_reward_mean": -326.0303318494239, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.29839840281141, "mean_processing_ms": 3.489851865125078, "mean_inference_ms": 1.5887969049459596}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2834944, "num_steps_sampled": 2847600, "sample_time_ms": 189371.406, "load_time_ms": 102.458, "grad_time_ms": 3408.447, "update_time_ms": 6.502, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1741.550048828125, "policy_loss": -0.0196858961135149, "vf_loss": 1741.5694580078125, "vf_explained_var": 1.2164212970233734e-09, "kl": 0.022054923698306084, "entropy": 8.24948787689209, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2847600, "episodes_total": 7117, "training_iteration": 113, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_07-29-10", "timestamp": 1606787950, "time_this_iter_s": 192.23440265655518, "time_total_s": 22122.15352678299, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 22122.15352678299, "timesteps_since_restore": 2847600, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 65.59054545454546, "ram_util_percent": 73.81927272727272}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -297.6014412250509, "episode_reward_min": -365.6616468852206, "episode_reward_mean": -325.23406968807177, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.28976038174927, "mean_processing_ms": 3.490395391935369, "mean_inference_ms": 1.588259809409747}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2860032, "num_steps_sampled": 2872800, "sample_time_ms": 189427.615, "load_time_ms": 103.858, "grad_time_ms": 3341.665, "update_time_ms": 6.189, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1843.0089111328125, "policy_loss": -0.01869492419064045, "vf_loss": 1843.0274658203125, "vf_explained_var": -1.5813476750281552e-08, "kl": 0.02515716850757599, "entropy": 8.043213844299316, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2872800, "episodes_total": 7182, "training_iteration": 114, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_07-32-23", "timestamp": 1606788143, "time_this_iter_s": 193.03683471679688, "time_total_s": 22315.190361499786, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 22315.190361499786, "timesteps_since_restore": 2872800, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 66.0029090909091, "ram_util_percent": 73.98981818181818}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -297.9636889372796, "episode_reward_min": -350.9051420059565, "episode_reward_mean": -325.8177775097367, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.29069947722916, "mean_processing_ms": 3.4896004577328528, "mean_inference_ms": 1.5882897191638423}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2885120, "num_steps_sampled": 2898000, "sample_time_ms": 189544.729, "load_time_ms": 107.753, "grad_time_ms": 3447.04, "update_time_ms": 6.182, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1753.654296875, "policy_loss": -0.017766600474715233, "vf_loss": 1753.671875, "vf_explained_var": -1.8854530381418044e-08, "kl": 0.02565239928662777, "entropy": 8.482067108154297, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2898000, "episodes_total": 7243, "training_iteration": 115, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_07-35-36", "timestamp": 1606788336, "time_this_iter_s": 192.77791953086853, "time_total_s": 22507.968281030655, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 22507.968281030655, "timesteps_since_restore": 2898000, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 66.32327272727272, "ram_util_percent": 74.32254545454545}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -292.7813155018272, "episode_reward_min": -354.61399478224047, "episode_reward_mean": -325.2749315098086, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.28138913454626, "mean_processing_ms": 3.490127409620294, "mean_inference_ms": 1.5877154761392331}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2910208, "num_steps_sampled": 2923200, "sample_time_ms": 189281.431, "load_time_ms": 112.682, "grad_time_ms": 3593.906, "update_time_ms": 5.821, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1843.933349609375, "policy_loss": -0.016049010679125786, "vf_loss": 1843.948974609375, "vf_explained_var": -4.865685188093494e-09, "kl": 0.025382574647665024, "entropy": 8.14670467376709, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2923200, "episodes_total": 7308, "training_iteration": 116, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_07-38-49", "timestamp": 1606788529, "time_this_iter_s": 192.83785724639893, "time_total_s": 22700.806138277054, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 22700.806138277054, "timesteps_since_restore": 2923200, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 65.86436363636363, "ram_util_percent": 74.4650909090909}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -292.7813155018272, "episode_reward_min": -355.38859279690337, "episode_reward_mean": -324.7617873186929, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.281673677504315, "mean_processing_ms": 3.489527299919552, "mean_inference_ms": 1.5877427434391342}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2935296, "num_steps_sampled": 2948400, "sample_time_ms": 189265.016, "load_time_ms": 112.461, "grad_time_ms": 3448.149, "update_time_ms": 5.409, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1748.9873046875, "policy_loss": -0.01817288249731064, "vf_loss": 1749.0052490234375, "vf_explained_var": -9.731370376186987e-09, "kl": 0.024091687053442, "entropy": 8.521990776062012, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2948400, "episodes_total": 7369, "training_iteration": 117, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_07-42-02", "timestamp": 1606788722, "time_this_iter_s": 193.80458664894104, "time_total_s": 22894.610724925995, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 22894.610724925995, "timesteps_since_restore": 2948400, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 65.56570397111912, "ram_util_percent": 74.65198555956678}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -289.17248018370265, "episode_reward_min": -358.9295153927107, "episode_reward_mean": -325.11088368670556, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.27429517918649, "mean_processing_ms": 3.490084029793767, "mean_inference_ms": 1.5872472196885974}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2960384, "num_steps_sampled": 2973600, "sample_time_ms": 189303.198, "load_time_ms": 112.925, "grad_time_ms": 3433.452, "update_time_ms": 4.831, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1849.4412841796875, "policy_loss": -0.017378272488713264, "vf_loss": 1849.45849609375, "vf_explained_var": 2.1287374085687816e-09, "kl": 0.02852623723447323, "entropy": 8.30738639831543, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2973600, "episodes_total": 7434, "training_iteration": 118, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_07-45-15", "timestamp": 1606788915, "time_this_iter_s": 193.0670986175537, "time_total_s": 23087.67782354355, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23087.67782354355, "timesteps_since_restore": 2973600, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 66.12072727272728, "ram_util_percent": 74.8589090909091}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -273.58552565782065, "episode_reward_min": -358.9295153927107, "episode_reward_mean": -323.64730107585495, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.27517106831262, "mean_processing_ms": 3.489414234122904, "mean_inference_ms": 1.5872832164060775}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2985472, "num_steps_sampled": 2998800, "sample_time_ms": 189488.702, "load_time_ms": 108.336, "grad_time_ms": 3392.746, "update_time_ms": 4.914, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1750.7109375, "policy_loss": -0.01926923170685768, "vf_loss": 1750.7301025390625, "vf_explained_var": -2.1287374085687816e-09, "kl": 0.028033237904310226, "entropy": 8.357657432556152, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 2998800, "episodes_total": 7495, "training_iteration": 119, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_07-48-29", "timestamp": 1606789109, "time_this_iter_s": 193.07994103431702, "time_total_s": 23280.757764577866, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23280.757764577866, "timesteps_since_restore": 2998800, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 65.88727272727273, "ram_util_percent": 74.95781818181818}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -273.58552565782065, "episode_reward_min": -359.0556311544341, "episode_reward_mean": -324.2350326279868, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.267204753427684, "mean_processing_ms": 3.489866726691601, "mean_inference_ms": 1.5867847988675678}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3010560, "num_steps_sampled": 3024000, "sample_time_ms": 189507.253, "load_time_ms": 105.179, "grad_time_ms": 3378.008, "update_time_ms": 4.577, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1840.6348876953125, "policy_loss": -0.01709478162229061, "vf_loss": 1840.6517333984375, "vf_explained_var": -4.257474817137563e-09, "kl": 0.02632189355790615, "entropy": 8.374777793884277, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3024000, "episodes_total": 7560, "training_iteration": 120, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_07-51-42", "timestamp": 1606789302, "time_this_iter_s": 193.23918771743774, "time_total_s": 23473.996952295303, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23473.996952295303, "timesteps_since_restore": 3024000, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 65.7858695652174, "ram_util_percent": 73.75797101449275}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -292.6017238440931, "episode_reward_min": -356.2744352842541, "episode_reward_mean": -324.2703145854298, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.26783063767186, "mean_processing_ms": 3.489144418431333, "mean_inference_ms": 1.586723071122511}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3035648, "num_steps_sampled": 3049200, "sample_time_ms": 189615.482, "load_time_ms": 105.985, "grad_time_ms": 3364.641, "update_time_ms": 4.978, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1755.903076171875, "policy_loss": -0.016234293580055237, "vf_loss": 1755.9193115234375, "vf_explained_var": -6.0821068181837745e-09, "kl": 0.026233483105897903, "entropy": 8.655766487121582, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3049200, "episodes_total": 7621, "training_iteration": 121, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_07-54-55", "timestamp": 1606789495, "time_this_iter_s": 193.18364787101746, "time_total_s": 23667.18060016632, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23667.18060016632, "timesteps_since_restore": 3049200, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 65.50289855072465, "ram_util_percent": 73.94384057971014}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -293.29812079791867, "episode_reward_min": -368.90766337625604, "episode_reward_mean": -325.97045355555963, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.26065300539092, "mean_processing_ms": 3.4894393965322843, "mean_inference_ms": 1.5862893974859265}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3060736, "num_steps_sampled": 3074400, "sample_time_ms": 189705.828, "load_time_ms": 100.642, "grad_time_ms": 3112.481, "update_time_ms": 5.293, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1851.859375, "policy_loss": -0.01687025837600231, "vf_loss": 1851.8759765625, "vf_explained_var": -3.0410534090918873e-09, "kl": 0.02577565237879753, "entropy": 8.285122871398926, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3074400, "episodes_total": 7686, "training_iteration": 122, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_07-58-07", "timestamp": 1606789687, "time_this_iter_s": 192.10580730438232, "time_total_s": 23859.286407470703, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23859.286407470703, "timesteps_since_restore": 3074400, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 66.09014598540148, "ram_util_percent": 74.1248175182482}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -298.54857740076, "episode_reward_min": -361.5204929805845, "episode_reward_mean": -325.80344115833316, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.25776206734285, "mean_processing_ms": 3.4890484742416157, "mean_inference_ms": 1.5861074448159738}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3085824, "num_steps_sampled": 3099600, "sample_time_ms": 189441.381, "load_time_ms": 106.62, "grad_time_ms": 3406.308, "update_time_ms": 5.27, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1748.7161865234375, "policy_loss": -0.01366110984236002, "vf_loss": 1748.7298583984375, "vf_explained_var": -9.427265190709022e-09, "kl": 0.02656272053718567, "entropy": 8.71066951751709, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3099600, "episodes_total": 7747, "training_iteration": 123, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_08-01-20", "timestamp": 1606789880, "time_this_iter_s": 192.5952661037445, "time_total_s": 24051.881673574448, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24051.881673574448, "timesteps_since_restore": 3099600, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 66.06350364963504, "ram_util_percent": 74.33576642335765}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -287.6990812521337, "episode_reward_min": -360.5096283031806, "episode_reward_mean": -326.9577575453436, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.25163969587712, "mean_processing_ms": 3.48889529206629, "mean_inference_ms": 1.585657904155925}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3110912, "num_steps_sampled": 3124800, "sample_time_ms": 189093.352, "load_time_ms": 106.383, "grad_time_ms": 3618.887, "update_time_ms": 5.665, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1860.85693359375, "policy_loss": -0.017952142283320427, "vf_loss": 1860.875, "vf_explained_var": -1.8246320010462114e-09, "kl": 0.027772175148129463, "entropy": 8.46329402923584, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3124800, "episodes_total": 7812, "training_iteration": 124, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_08-04-32", "timestamp": 1606790072, "time_this_iter_s": 191.69106316566467, "time_total_s": 24243.572736740112, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24243.572736740112, "timesteps_since_restore": 3124800, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 65.78649635036497, "ram_util_percent": 74.57773722627736}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -287.6990812521337, "episode_reward_min": -363.5079951074069, "episode_reward_mean": -327.038518006886, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.24579294025394, "mean_processing_ms": 3.488477653486038, "mean_inference_ms": 1.5853108373310842}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3136000, "num_steps_sampled": 3150000, "sample_time_ms": 188886.992, "load_time_ms": 101.076, "grad_time_ms": 3528.3, "update_time_ms": 6.062, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1762.97705078125, "policy_loss": -0.016510475426912308, "vf_loss": 1762.99365234375, "vf_explained_var": 2.432842594046747e-09, "kl": 0.028599871322512627, "entropy": 8.740434646606445, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3150000, "episodes_total": 7873, "training_iteration": 125, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_08-07-41", "timestamp": 1606790261, "time_this_iter_s": 189.76472282409668, "time_total_s": 24433.33745956421, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24433.33745956421, "timesteps_since_restore": 3150000, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 65.72140221402213, "ram_util_percent": 74.70848708487085}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -274.59766161155676, "episode_reward_min": -365.3937706635816, "episode_reward_mean": -329.15735909170434, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.23877346616459, "mean_processing_ms": 3.488546104382491, "mean_inference_ms": 1.5849008126838549}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3161088, "num_steps_sampled": 3175200, "sample_time_ms": 188714.42, "load_time_ms": 99.627, "grad_time_ms": 3652.661, "update_time_ms": 6.33, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1866.4339599609375, "policy_loss": -0.019003571942448616, "vf_loss": 1866.4527587890625, "vf_explained_var": -1.2468318821845514e-08, "kl": 0.02966386452317238, "entropy": 8.507301330566406, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3175200, "episodes_total": 7938, "training_iteration": 126, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_08-10-54", "timestamp": 1606790454, "time_this_iter_s": 192.35146808624268, "time_total_s": 24625.68892765045, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24625.68892765045, "timesteps_since_restore": 3175200, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 65.80729927007299, "ram_util_percent": 74.83211678832117}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -274.59766161155676, "episode_reward_min": -365.3937706635816, "episode_reward_mean": -326.86520951412473, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.2360888596468, "mean_processing_ms": 3.4880603027506494, "mean_inference_ms": 1.5849401216738732}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3186176, "num_steps_sampled": 3200400, "sample_time_ms": 188296.016, "load_time_ms": 100.013, "grad_time_ms": 3669.839, "update_time_ms": 6.672, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1767.5255126953125, "policy_loss": -0.017931152135133743, "vf_loss": 1767.5433349609375, "vf_explained_var": -1.0035475561664953e-08, "kl": 0.030321365222334862, "entropy": 8.685824394226074, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3200400, "episodes_total": 7999, "training_iteration": 127, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_08-14-04", "timestamp": 1606790644, "time_this_iter_s": 189.8064730167389, "time_total_s": 24815.49540066719, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24815.49540066719, "timesteps_since_restore": 3200400, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 66.08671586715867, "ram_util_percent": 75.00442804428044}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -288.23662538801705, "episode_reward_min": -359.8838320154411, "episode_reward_mean": -326.4495556321919, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.226846465827975, "mean_processing_ms": 3.488600451655369, "mean_inference_ms": 1.5844128330977885}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3211264, "num_steps_sampled": 3225600, "sample_time_ms": 188202.501, "load_time_ms": 100.275, "grad_time_ms": 3646.367, "update_time_ms": 6.989, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1856.4588623046875, "policy_loss": -0.018004465848207474, "vf_loss": 1856.47705078125, "vf_explained_var": -5.473896003138634e-09, "kl": 0.02606874145567417, "entropy": 8.171346664428711, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3225600, "episodes_total": 8064, "training_iteration": 128, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_08-17-15", "timestamp": 1606790835, "time_this_iter_s": 191.8955099582672, "time_total_s": 25007.390910625458, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25007.390910625458, "timesteps_since_restore": 3225600, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 66.26373626373626, "ram_util_percent": 75.17802197802197}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -288.23662538801705, "episode_reward_min": -371.6563059440443, "episode_reward_mean": -326.46214632233944, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.22500744859845, "mean_processing_ms": 3.4881705897377593, "mean_inference_ms": 1.5841515235734294}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3236352, "num_steps_sampled": 3250800, "sample_time_ms": 187870.102, "load_time_ms": 100.298, "grad_time_ms": 3647.5, "update_time_ms": 6.526, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1771.9697265625, "policy_loss": -0.01873706839978695, "vf_loss": 1771.9884033203125, "vf_explained_var": 3.3451585945698525e-09, "kl": 0.027259841561317444, "entropy": 8.21539306640625, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3250800, "episodes_total": 8125, "training_iteration": 129, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_08-20-25", "timestamp": 1606791025, "time_this_iter_s": 189.77122735977173, "time_total_s": 25197.16213798523, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25197.16213798523, "timesteps_since_restore": 3250800, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 66.26752767527675, "ram_util_percent": 75.22656826568264}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -292.4734665047523, "episode_reward_min": -370.55748284143624, "episode_reward_mean": -326.6103010397142, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.221223561834535, "mean_processing_ms": 3.488188171597186, "mean_inference_ms": 1.583841405982206}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3261440, "num_steps_sampled": 3276000, "sample_time_ms": 187608.652, "load_time_ms": 98.456, "grad_time_ms": 3711.749, "update_time_ms": 7.027, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1867.688720703125, "policy_loss": -0.01773454062640667, "vf_loss": 1867.7064208984375, "vf_explained_var": -1.5205267045459436e-09, "kl": 0.02529442496597767, "entropy": 8.216230392456055, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3276000, "episodes_total": 8190, "training_iteration": 130, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_08-23-37", "timestamp": 1606791217, "time_this_iter_s": 191.25309109687805, "time_total_s": 25388.415229082108, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25388.415229082108, "timesteps_since_restore": 3276000, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 66.57142857142857, "ram_util_percent": 75.21831501831501}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -292.4734665047523, "episode_reward_min": -372.71086056401697, "episode_reward_mean": -323.9555250314092, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.221209828143415, "mean_processing_ms": 3.4875893585024667, "mean_inference_ms": 1.5839054124205694}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3286528, "num_steps_sampled": 3301200, "sample_time_ms": 187471.414, "load_time_ms": 98.409, "grad_time_ms": 3746.74, "update_time_ms": 7.003, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1765.5474853515625, "policy_loss": -0.016093429177999496, "vf_loss": 1765.5634765625, "vf_explained_var": -3.3451585945698525e-09, "kl": 0.028680603951215744, "entropy": 8.312569618225098, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3301200, "episodes_total": 8251, "training_iteration": 131, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_08-26-49", "timestamp": 1606791409, "time_this_iter_s": 192.1549141407013, "time_total_s": 25580.57014322281, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25580.57014322281, "timesteps_since_restore": 3301200, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 65.61605839416059, "ram_util_percent": 75.3463503649635}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -296.3796585782581, "episode_reward_min": -372.71086056401697, "episode_reward_mean": -325.04116635941585, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.21164911094709, "mean_processing_ms": 3.487966864775998, "mean_inference_ms": 1.5833388005166429}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3311616, "num_steps_sampled": 3326400, "sample_time_ms": 187217.685, "load_time_ms": 102.845, "grad_time_ms": 4045.478, "update_time_ms": 6.753, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1868.737548828125, "policy_loss": -0.018911249935626984, "vf_loss": 1868.756103515625, "vf_explained_var": -6.690317189139705e-09, "kl": 0.030218519270420074, "entropy": 8.000269889831543, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3326400, "episodes_total": 8316, "training_iteration": 132, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_08-30-01", "timestamp": 1606791601, "time_this_iter_s": 192.59870195388794, "time_total_s": 25773.168845176697, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25773.168845176697, "timesteps_since_restore": 3326400, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 65.9, "ram_util_percent": 75.56545454545454}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -292.6470080161617, "episode_reward_min": -371.2839382630051, "episode_reward_mean": -325.59570138920793, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.210940567689086, "mean_processing_ms": 3.487247851026913, "mean_inference_ms": 1.5831749125774985}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3336704, "num_steps_sampled": 3351600, "sample_time_ms": 187273.755, "load_time_ms": 102.988, "grad_time_ms": 3976.163, "update_time_ms": 6.913, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1767.9639892578125, "policy_loss": -0.01962544023990631, "vf_loss": 1767.9833984375, "vf_explained_var": -7.60263318966281e-09, "kl": 0.02703906036913395, "entropy": 7.897956848144531, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3351600, "episodes_total": 8377, "training_iteration": 133, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_08-33-14", "timestamp": 1606791794, "time_this_iter_s": 192.45935106277466, "time_total_s": 25965.62819623947, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25965.62819623947, "timesteps_since_restore": 3351600, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 65.66569343065694, "ram_util_percent": 75.72810218978103}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -288.40691848452445, "episode_reward_min": -371.2839382630051, "episode_reward_mean": -324.4643810927851, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.201403682342885, "mean_processing_ms": 3.4874617578464027, "mean_inference_ms": 1.5826029281322829}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3361792, "num_steps_sampled": 3376800, "sample_time_ms": 187256.256, "load_time_ms": 96.989, "grad_time_ms": 3863.547, "update_time_ms": 6.529, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1861.7352294921875, "policy_loss": -0.016715068370103836, "vf_loss": 1861.751953125, "vf_explained_var": 4.865685188093494e-09, "kl": 0.027316702529788017, "entropy": 7.59818172454834, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3376800, "episodes_total": 8442, "training_iteration": 134, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_08-36-24", "timestamp": 1606791984, "time_this_iter_s": 190.32662630081177, "time_total_s": 26155.954822540283, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 26155.954822540283, "timesteps_since_restore": 3376800, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 65.92058823529412, "ram_util_percent": 75.81691176470588}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -288.40691848452445, "episode_reward_min": -351.89255419304254, "episode_reward_mean": -324.3158247195496, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.19987840076216, "mean_processing_ms": 3.4869377903525502, "mean_inference_ms": 1.5826383949744107}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3386880, "num_steps_sampled": 3402000, "sample_time_ms": 187413.839, "load_time_ms": 101.757, "grad_time_ms": 3846.043, "update_time_ms": 6.61, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1759.8739013671875, "policy_loss": -0.016226748004555702, "vf_loss": 1759.8900146484375, "vf_explained_var": -8.210843560618741e-09, "kl": 0.03167184442281723, "entropy": 7.884617328643799, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3402000, "episodes_total": 8503, "training_iteration": 135, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_08-39-36", "timestamp": 1606792176, "time_this_iter_s": 191.21744441986084, "time_total_s": 26347.172266960144, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 26347.172266960144, "timesteps_since_restore": 3402000, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 65.93772893772893, "ram_util_percent": 75.97069597069597}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -293.65243084054055, "episode_reward_min": -364.58922566341937, "episode_reward_mean": -324.7375265377652, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.18987570474088, "mean_processing_ms": 3.4874194436942183, "mean_inference_ms": 1.5820676200756862}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3411968, "num_steps_sampled": 3427200, "sample_time_ms": 187439.91, "load_time_ms": 101.31, "grad_time_ms": 3804.906, "update_time_ms": 6.901, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1860.530029296875, "policy_loss": -0.01844296045601368, "vf_loss": 1860.548095703125, "vf_explained_var": -3.953369187570388e-09, "kl": 0.026563569903373718, "entropy": 7.561301231384277, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3427200, "episodes_total": 8568, "training_iteration": 136, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_08-42-48", "timestamp": 1606792368, "time_this_iter_s": 192.19214415550232, "time_total_s": 26539.364411115646, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 26539.364411115646, "timesteps_since_restore": 3427200, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 65.86350364963504, "ram_util_percent": 76.12372262773724}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -286.55592268381383, "episode_reward_min": -361.919360292089, "episode_reward_mean": -323.1143164035866, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.18700858524237, "mean_processing_ms": 3.4867735139278535, "mean_inference_ms": 1.5818117301666177}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3437056, "num_steps_sampled": 3452400, "sample_time_ms": 187549.569, "load_time_ms": 106.087, "grad_time_ms": 3903.72, "update_time_ms": 6.531, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1751.1875, "policy_loss": -0.01759837195277214, "vf_loss": 1751.2047119140625, "vf_explained_var": -2.736948001569317e-09, "kl": 0.02923225797712803, "entropy": 7.622020721435547, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3452400, "episodes_total": 8629, "training_iteration": 137, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_08-46-00", "timestamp": 1606792560, "time_this_iter_s": 191.92872977256775, "time_total_s": 26731.293140888214, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 26731.293140888214, "timesteps_since_restore": 3452400, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 65.82627737226278, "ram_util_percent": 76.35182481751824}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -288.3054562964918, "episode_reward_min": -361.919360292089, "episode_reward_mean": -322.0669182016187, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.18196126463352, "mean_processing_ms": 3.486878285394356, "mean_inference_ms": 1.5814960202308044}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3462144, "num_steps_sampled": 3477600, "sample_time_ms": 187314.595, "load_time_ms": 104.392, "grad_time_ms": 4085.788, "update_time_ms": 6.312, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1853.5201416015625, "policy_loss": -0.017221961170434952, "vf_loss": 1853.5369873046875, "vf_explained_var": -1.5205267045459436e-09, "kl": 0.028917400166392326, "entropy": 7.1621270179748535, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3477600, "episodes_total": 8694, "training_iteration": 138, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_08-49-11", "timestamp": 1606792751, "time_this_iter_s": 191.346533536911, "time_total_s": 26922.639674425125, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 26922.639674425125, "timesteps_since_restore": 3477600, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 66.24945054945054, "ram_util_percent": 74.64725274725275}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -288.3054562964918, "episode_reward_min": -348.1859812533491, "episode_reward_mean": -321.45091922199435, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.17887464398589, "mean_processing_ms": 3.486538368514024, "mean_inference_ms": 1.5813301347060615}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3487232, "num_steps_sampled": 3502800, "sample_time_ms": 187215.84, "load_time_ms": 104.078, "grad_time_ms": 4196.389, "update_time_ms": 6.302, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1749.5855712890625, "policy_loss": -0.017564671114087105, "vf_loss": 1749.60302734375, "vf_explained_var": 2.1287374085687816e-09, "kl": 0.028557708486914635, "entropy": 7.514881134033203, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3502800, "episodes_total": 8755, "training_iteration": 139, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_08-52-21", "timestamp": 1606792941, "time_this_iter_s": 189.88195276260376, "time_total_s": 27112.52162718773, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 27112.52162718773, "timesteps_since_restore": 3502800, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 66.30111111111111, "ram_util_percent": 73.89000000000001}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -288.61254918337227, "episode_reward_min": -361.21877617664177, "episode_reward_mean": -320.9215938981531, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.173078584603566, "mean_processing_ms": 3.4865361694630046, "mean_inference_ms": 1.5809814763066539}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3512320, "num_steps_sampled": 3528000, "sample_time_ms": 187147.547, "load_time_ms": 107.433, "grad_time_ms": 4311.99, "update_time_ms": 6.153, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1851.5540771484375, "policy_loss": -0.018290361389517784, "vf_loss": 1851.5723876953125, "vf_explained_var": -9.123160005231057e-09, "kl": 0.030979488044977188, "entropy": 6.864748477935791, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3528000, "episodes_total": 8820, "training_iteration": 140, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_08-55-33", "timestamp": 1606793133, "time_this_iter_s": 191.75182723999023, "time_total_s": 27304.27345442772, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 27304.27345442772, "timesteps_since_restore": 3528000, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 65.83394160583941, "ram_util_percent": 74.02445255474453}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -284.63137366509375, "episode_reward_min": -349.92182301357184, "episode_reward_mean": -320.6427868714674, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.17157427818484, "mean_processing_ms": 3.486086393640229, "mean_inference_ms": 1.5809051362918896}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3537408, "num_steps_sampled": 3553200, "sample_time_ms": 186927.95, "load_time_ms": 101.36, "grad_time_ms": 4290.155, "update_time_ms": 5.82, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1756.4833984375, "policy_loss": -0.01716802828013897, "vf_loss": 1756.50048828125, "vf_explained_var": -1.0035475561664953e-08, "kl": 0.03457486629486084, "entropy": 7.186782360076904, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3553200, "episodes_total": 8881, "training_iteration": 141, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_08-58-42", "timestamp": 1606793322, "time_this_iter_s": 189.6801655292511, "time_total_s": 27493.95361995697, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 27493.95361995697, "timesteps_since_restore": 3553200, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 65.88339483394834, "ram_util_percent": 73.90442804428045}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -284.63137366509375, "episode_reward_min": -368.61543320410084, "episode_reward_mean": -322.84852204195425, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.162625420340696, "mean_processing_ms": 3.486318343574061, "mean_inference_ms": 1.5804040429385995}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3562496, "num_steps_sampled": 3578400, "sample_time_ms": 186826.34, "load_time_ms": 96.303, "grad_time_ms": 4213.942, "update_time_ms": 6.327, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1853.5462646484375, "policy_loss": -0.016958599910140038, "vf_loss": 1853.5631103515625, "vf_explained_var": -8.819054819753092e-09, "kl": 0.03433563932776451, "entropy": 6.863424301147461, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3578400, "episodes_total": 8946, "training_iteration": 142, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_09-01-53", "timestamp": 1606793513, "time_this_iter_s": 190.78133988380432, "time_total_s": 27684.734959840775, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 27684.734959840775, "timesteps_since_restore": 3578400, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 65.95919117647058, "ram_util_percent": 72.99154411764705}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -293.06114559830354, "episode_reward_min": -352.43079130817523, "episode_reward_mean": -322.71367917726786, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.16161163096226, "mean_processing_ms": 3.485618311256522, "mean_inference_ms": 1.5805014594388167}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3587584, "num_steps_sampled": 3603600, "sample_time_ms": 186862.241, "load_time_ms": 94.267, "grad_time_ms": 4110.525, "update_time_ms": 6.657, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1753.2225341796875, "policy_loss": -0.014955730177462101, "vf_loss": 1753.2374267578125, "vf_explained_var": -5.473896003138634e-09, "kl": 0.032259419560432434, "entropy": 7.045562267303467, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3603600, "episodes_total": 9007, "training_iteration": 143, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_09-05-05", "timestamp": 1606793705, "time_this_iter_s": 191.76522707939148, "time_total_s": 27876.500186920166, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 27876.500186920166, "timesteps_since_restore": 3603600, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 65.74322344322343, "ram_util_percent": 73.16996336996337}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -291.31374381268176, "episode_reward_min": -358.9755185424392, "episode_reward_mean": -320.26324788435863, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.152057948764444, "mean_processing_ms": 3.4859189721155253, "mean_inference_ms": 1.57994395222754}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3612672, "num_steps_sampled": 3628800, "sample_time_ms": 187053.408, "load_time_ms": 97.128, "grad_time_ms": 3952.564, "update_time_ms": 6.63, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1841.9561767578125, "policy_loss": -0.016707755625247955, "vf_loss": 1841.9725341796875, "vf_explained_var": -1.0947792006277268e-08, "kl": 0.031158462166786194, "entropy": 6.492990970611572, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3628800, "episodes_total": 9072, "training_iteration": 144, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_09-08-16", "timestamp": 1606793896, "time_this_iter_s": 190.68427395820618, "time_total_s": 28067.184460878372, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 28067.184460878372, "timesteps_since_restore": 3628800, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 65.83125, "ram_util_percent": 73.33308823529411}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -291.31374381268176, "episode_reward_min": -358.9755185424392, "episode_reward_mean": -319.5335348171368, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.152857594167344, "mean_processing_ms": 3.4852152707904565, "mean_inference_ms": 1.5800192674628755}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3637760, "num_steps_sampled": 3654000, "sample_time_ms": 187078.822, "load_time_ms": 91.798, "grad_time_ms": 4019.274, "update_time_ms": 6.703, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1748.0941162109375, "policy_loss": -0.015632368624210358, "vf_loss": 1748.1094970703125, "vf_explained_var": -6.99442281870688e-09, "kl": 0.03151286393404007, "entropy": 7.015405654907227, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3654000, "episodes_total": 9133, "training_iteration": 145, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_09-11-28", "timestamp": 1606794088, "time_this_iter_s": 192.08131408691406, "time_total_s": 28259.265774965286, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 28259.265774965286, "timesteps_since_restore": 3654000, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 65.8624087591241, "ram_util_percent": 73.53795620437957}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -282.90955730404295, "episode_reward_min": -352.9747678958882, "episode_reward_mean": -320.0043813281785, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.142579698225624, "mean_processing_ms": 3.485445694273605, "mean_inference_ms": 1.5794650573304154}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3662848, "num_steps_sampled": 3679200, "sample_time_ms": 186771.768, "load_time_ms": 86.312, "grad_time_ms": 3970.98, "update_time_ms": 6.524, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1830.896484375, "policy_loss": -0.01428359653800726, "vf_loss": 1830.9105224609375, "vf_explained_var": -5.169790817660669e-09, "kl": 0.032097190618515015, "entropy": 6.548581600189209, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3679200, "episodes_total": 9198, "training_iteration": 146, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_09-14-37", "timestamp": 1606794277, "time_this_iter_s": 188.5873007774353, "time_total_s": 28447.85307574272, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 28447.85307574272, "timesteps_since_restore": 3679200, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 66.23680297397769, "ram_util_percent": 73.7278810408922}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -285.54324606758263, "episode_reward_min": -359.4524760467986, "episode_reward_mean": -319.68170965563985, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.1399078348101, "mean_processing_ms": 3.484415873209144, "mean_inference_ms": 1.5792028788939416}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3687936, "num_steps_sampled": 3704400, "sample_time_ms": 186281.858, "load_time_ms": 81.101, "grad_time_ms": 3857.375, "update_time_ms": 6.842, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1734.744873046875, "policy_loss": -0.01632889360189438, "vf_loss": 1734.760986328125, "vf_explained_var": 4.257474817137563e-09, "kl": 0.033404696732759476, "entropy": 6.978673934936523, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3704400, "episodes_total": 9259, "training_iteration": 147, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_09-17-42", "timestamp": 1606794462, "time_this_iter_s": 185.8440432548523, "time_total_s": 28633.697118997574, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 28633.697118997574, "timesteps_since_restore": 3704400, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 66.08415094339624, "ram_util_percent": 73.89169811320754}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -285.54324606758263, "episode_reward_min": -359.4524760467986, "episode_reward_mean": -319.9334559560447, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.1278139985578, "mean_processing_ms": 3.4843931171523947, "mean_inference_ms": 1.578560937763906}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3713024, "num_steps_sampled": 3729600, "sample_time_ms": 185861.142, "load_time_ms": 76.248, "grad_time_ms": 3775.623, "update_time_ms": 6.735, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1824.1597900390625, "policy_loss": -0.014383013360202312, "vf_loss": 1824.174072265625, "vf_explained_var": -7.2985280041848455e-09, "kl": 0.0364866778254509, "entropy": 6.46612548828125, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3729600, "episodes_total": 9324, "training_iteration": 148, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_09-20-49", "timestamp": 1606794649, "time_this_iter_s": 186.2812843322754, "time_total_s": 28819.97840332985, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 28819.97840332985, "timesteps_since_restore": 3729600, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 66.15789473684211, "ram_util_percent": 74.19097744360903}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -287.9757828633128, "episode_reward_min": -355.6896842495768, "episode_reward_mean": -321.9950992854802, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.11941826802228, "mean_processing_ms": 3.4838586129775653, "mean_inference_ms": 1.5781661991348606}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3738112, "num_steps_sampled": 3754800, "sample_time_ms": 185427.564, "load_time_ms": 75.752, "grad_time_ms": 3801.997, "update_time_ms": 7.172, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1734.7735595703125, "policy_loss": -0.014040223322808743, "vf_loss": 1734.787353515625, "vf_explained_var": -7.2985280041848455e-09, "kl": 0.0399736613035202, "entropy": 6.795278072357178, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3754800, "episodes_total": 9385, "training_iteration": 149, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_09-23-55", "timestamp": 1606794835, "time_this_iter_s": 185.81213235855103, "time_total_s": 29005.7905356884, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29005.7905356884, "timesteps_since_restore": 3754800, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 65.4422641509434, "ram_util_percent": 74.4033962264151}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -284.9900872734753, "episode_reward_min": -357.30603329324225, "episode_reward_mean": -321.372535974691, "episode_len_mean": 400.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.110485981560174, "mean_processing_ms": 3.4832204993690015, "mean_inference_ms": 1.5777507204182748}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3763200, "num_steps_sampled": 3780000, "sample_time_ms": 184798.582, "load_time_ms": 73.049, "grad_time_ms": 3746.243, "update_time_ms": 7.251, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1808.800048828125, "policy_loss": -0.01595991477370262, "vf_loss": 1808.8157958984375, "vf_explained_var": -1.5205267045459436e-09, "kl": 0.035392601042985916, "entropy": 6.397404670715332, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3780000, "episodes_total": 9449, "training_iteration": 150, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_09-27-00", "timestamp": 1606795020, "time_this_iter_s": 184.88550877571106, "time_total_s": 29190.67604446411, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29190.67604446411, "timesteps_since_restore": 3780000, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 65.72007575757576, "ram_util_percent": 74.59166666666665}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -278.2759072081844, "episode_reward_min": -355.9149021803619, "episode_reward_mean": -320.5735893976497, "episode_len_mean": 400.0, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.09181656471194, "mean_processing_ms": 3.483630329394141, "mean_inference_ms": 1.5769826256682233}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3788288, "num_steps_sampled": 3805200, "sample_time_ms": 184283.03, "load_time_ms": 76.114, "grad_time_ms": 3737.213, "update_time_ms": 7.83, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1782.472412109375, "policy_loss": -0.014928985387086868, "vf_loss": 1782.4873046875, "vf_explained_var": 6.082106485116867e-10, "kl": 0.03361029177904129, "entropy": 6.531621932983398, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3805200, "episodes_total": 9512, "training_iteration": 151, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_09-30-04", "timestamp": 1606795204, "time_this_iter_s": 184.47271394729614, "time_total_s": 29375.148758411407, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29375.148758411407, "timesteps_since_restore": 3805200, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 64.97034220532319, "ram_util_percent": 74.76996197718631}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -287.6420330346356, "episode_reward_min": -360.0990956848466, "episode_reward_mean": -321.4883094056107, "episode_len_mean": 400.0, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.08505202340593, "mean_processing_ms": 3.4829182132080505, "mean_inference_ms": 1.5765724688755267}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3813376, "num_steps_sampled": 3830400, "sample_time_ms": 183785.709, "load_time_ms": 75.886, "grad_time_ms": 3548.693, "update_time_ms": 7.574, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 1787.6402587890625, "policy_loss": -0.012445259839296341, "vf_loss": 1787.6524658203125, "vf_explained_var": -8.210843560618741e-09, "kl": 0.04094722494482994, "entropy": 6.468534469604492, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3830400, "episodes_total": 9575, "training_iteration": 152, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_09-33-08", "timestamp": 1606795388, "time_this_iter_s": 183.91933131217957, "time_total_s": 29559.068089723587, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29559.068089723587, "timesteps_since_restore": 3830400, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 65.51406844106462, "ram_util_percent": 74.93878326996199}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -290.5439263581174, "episode_reward_min": -372.43267447759075, "episode_reward_mean": -318.6210946072711, "episode_len_mean": 400.0, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.06980145031158, "mean_processing_ms": 3.48301792172099, "mean_inference_ms": 1.5758605047053016}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3838464, "num_steps_sampled": 3855600, "sample_time_ms": 182972.609, "load_time_ms": 72.917, "grad_time_ms": 3442.977, "update_time_ms": 7.515, "learner": {"default_policy": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 1781.1822509765625, "policy_loss": -0.010283256880939007, "vf_loss": 1781.192138671875, "vf_explained_var": -1.8246320010462114e-09, "kl": 0.0375838465988636, "entropy": 6.244023323059082, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3855600, "episodes_total": 9638, "training_iteration": 153, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_09-36-11", "timestamp": 1606795571, "time_this_iter_s": 182.55548191070557, "time_total_s": 29741.623571634293, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29741.623571634293, "timesteps_since_restore": 3855600, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 65.95769230769231, "ram_util_percent": 75.13576923076923}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -287.5282500407038, "episode_reward_min": -358.7563833052693, "episode_reward_mean": -317.9559618322135, "episode_len_mean": 400.0, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.05900885793313, "mean_processing_ms": 3.4827855821167715, "mean_inference_ms": 1.5754053708807758}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3863552, "num_steps_sampled": 3880800, "sample_time_ms": 182400.49, "load_time_ms": 69.705, "grad_time_ms": 3507.456, "update_time_ms": 7.944, "learner": {"default_policy": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 1776.3118896484375, "policy_loss": -0.015378367155790329, "vf_loss": 1776.326904296875, "vf_explained_var": -5.473896003138634e-09, "kl": 0.03602578863501549, "entropy": 6.172635555267334, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3880800, "episodes_total": 9701, "training_iteration": 154, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_09-39-16", "timestamp": 1606795756, "time_this_iter_s": 185.5816731452942, "time_total_s": 29927.205244779587, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29927.205244779587, "timesteps_since_restore": 3880800, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 65.07698113207546, "ram_util_percent": 75.3520754716981}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -284.954903656146, "episode_reward_min": -358.7563833052693, "episode_reward_mean": -316.2173257967351, "episode_len_mean": 400.0, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.0486032677806, "mean_processing_ms": 3.48250303847685, "mean_inference_ms": 1.5749470692835472}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3888640, "num_steps_sampled": 3906000, "sample_time_ms": 181500.683, "load_time_ms": 75.248, "grad_time_ms": 3492.04, "update_time_ms": 7.749, "learner": {"default_policy": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 1746.1015625, "policy_loss": -0.010265430435538292, "vf_loss": 1746.111328125, "vf_explained_var": -8.210843560618741e-09, "kl": 0.04375259205698967, "entropy": 6.114345550537109, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3906000, "episodes_total": 9763, "training_iteration": 155, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_09-42-19", "timestamp": 1606795939, "time_this_iter_s": 182.97750282287598, "time_total_s": 30110.182747602463, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 30110.182747602463, "timesteps_since_restore": 3906000, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 65.35632183908046, "ram_util_percent": 75.48045977011493}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -285.0775773351117, "episode_reward_min": -354.49293161897185, "episode_reward_mean": -317.3659755785691, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.03518182190468, "mean_processing_ms": 3.4830827087618963, "mean_inference_ms": 1.5746046472693704}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3913728, "num_steps_sampled": 3931200, "sample_time_ms": 182031.284, "load_time_ms": 82.076, "grad_time_ms": 3391.27, "update_time_ms": 7.322, "learner": {"default_policy": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 1811.5037841796875, "policy_loss": -0.013604354113340378, "vf_loss": 1811.5167236328125, "vf_explained_var": -3.6492640020924227e-09, "kl": 0.04380692169070244, "entropy": 6.205082893371582, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3931200, "episodes_total": 9828, "training_iteration": 156, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_09-45-32", "timestamp": 1606796132, "time_this_iter_s": 192.98306918144226, "time_total_s": 30303.165816783905, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 30303.165816783905, "timesteps_since_restore": 3931200, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 68.36618181818181, "ram_util_percent": 75.744}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -285.0775773351117, "episode_reward_min": -354.49293161897185, "episode_reward_mean": -319.37790918449673, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.03118627824705, "mean_processing_ms": 3.4825796363799806, "mean_inference_ms": 1.5744980316837822}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3938816, "num_steps_sampled": 3956400, "sample_time_ms": 181746.822, "load_time_ms": 83.525, "grad_time_ms": 3483.34, "update_time_ms": 7.008, "learner": {"default_policy": {"cur_kl_coeff": 0.02109375037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 1727.4964599609375, "policy_loss": -0.009427199140191078, "vf_loss": 1727.5047607421875, "vf_explained_var": -1.7029899268550253e-08, "kl": 0.04627472907304764, "entropy": 6.3729248046875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3956400, "episodes_total": 9889, "training_iteration": 157, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_09-48-36", "timestamp": 1606796316, "time_this_iter_s": 183.9303503036499, "time_total_s": 30487.096167087555, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 30487.096167087555, "timesteps_since_restore": 3956400, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 65.21330798479087, "ram_util_percent": 75.45779467680607}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -285.73109149157614, "episode_reward_min": -373.9192612105188, "episode_reward_mean": -318.8199842893408, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.01368369083411, "mean_processing_ms": 3.4828331816580236, "mean_inference_ms": 1.573617029408038}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3963904, "num_steps_sampled": 3981600, "sample_time_ms": 181339.772, "load_time_ms": 84.691, "grad_time_ms": 3452.849, "update_time_ms": 6.992, "learner": {"default_policy": {"cur_kl_coeff": 0.03164062649011612, "cur_lr": 4.999999873689376e-05, "total_loss": 1815.370849609375, "policy_loss": -0.00921544898301363, "vf_loss": 1815.3785400390625, "vf_explained_var": -7.906738375140776e-09, "kl": 0.04868703335523605, "entropy": 5.997392177581787, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 3981600, "episodes_total": 9954, "training_iteration": 158, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_09-51-38", "timestamp": 1606796498, "time_this_iter_s": 181.90638875961304, "time_total_s": 30669.002555847168, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 30669.002555847168, "timesteps_since_restore": 3981600, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 65.93204633204634, "ram_util_percent": 75.64980694980696}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -290.4176887979102, "episode_reward_min": -373.9192612105188, "episode_reward_mean": -318.2566486146445, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 32.006194336210356, "mean_processing_ms": 3.4820532327501312, "mean_inference_ms": 1.5733478508528724}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3988992, "num_steps_sampled": 4006800, "sample_time_ms": 181214.233, "load_time_ms": 83.37, "grad_time_ms": 3386.985, "update_time_ms": 6.526, "learner": {"default_policy": {"cur_kl_coeff": 0.04746093600988388, "cur_lr": 4.999999873689376e-05, "total_loss": 1712.4600830078125, "policy_loss": -0.010903000831604004, "vf_loss": 1712.4691162109375, "vf_explained_var": -8.210843560618741e-09, "kl": 0.040786683559417725, "entropy": 6.506931304931641, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4006800, "episodes_total": 10015, "training_iteration": 159, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_09-54-42", "timestamp": 1606796682, "time_this_iter_s": 183.87527871131897, "time_total_s": 30852.877834558487, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 30852.877834558487, "timesteps_since_restore": 4006800, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 65.65725190839694, "ram_util_percent": 75.87557251908397}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -287.0122546437804, "episode_reward_min": -353.18105231663185, "episode_reward_mean": -316.48444305961334, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.989198673832355, "mean_processing_ms": 3.482368999113778, "mean_inference_ms": 1.572477447587666}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4014080, "num_steps_sampled": 4032000, "sample_time_ms": 181091.315, "load_time_ms": 81.33, "grad_time_ms": 3421.407, "update_time_ms": 6.548, "learner": {"default_policy": {"cur_kl_coeff": 0.07119140774011612, "cur_lr": 4.999999873689376e-05, "total_loss": 1813.7860107421875, "policy_loss": -0.013535101898014545, "vf_loss": 1813.7972412109375, "vf_explained_var": 5.778001188616599e-09, "kl": 0.03458208218216896, "entropy": 5.9635210037231445, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4032000, "episodes_total": 10080, "training_iteration": 160, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_09-57-46", "timestamp": 1606796866, "time_this_iter_s": 183.9699420928955, "time_total_s": 31036.847776651382, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 31036.847776651382, "timesteps_since_restore": 4032000, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 65.32471482889734, "ram_util_percent": 76.08631178707226}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -287.55196690246026, "episode_reward_min": -357.89217044408434, "episode_reward_mean": -317.31058688772504, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.9800121383176, "mean_processing_ms": 3.4818305107862506, "mean_inference_ms": 1.571904658184405}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4039168, "num_steps_sampled": 4057200, "sample_time_ms": 180912.588, "load_time_ms": 79.871, "grad_time_ms": 3532.041, "update_time_ms": 5.899, "learner": {"default_policy": {"cur_kl_coeff": 0.07119140774011612, "cur_lr": 4.999999873689376e-05, "total_loss": 1712.9056396484375, "policy_loss": 0.005892872344702482, "vf_loss": 1712.890625, "vf_explained_var": -6.38621200366174e-09, "kl": 0.12365452945232391, "entropy": 6.290224075317383, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4057200, "episodes_total": 10141, "training_iteration": 161, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_10-00-50", "timestamp": 1606797050, "time_this_iter_s": 183.76137471199036, "time_total_s": 31220.609151363373, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 31220.609151363373, "timesteps_since_restore": 4057200, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 65.34580152671755, "ram_util_percent": 76.23244274809161}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -287.55196690246026, "episode_reward_min": -357.89217044408434, "episode_reward_mean": -316.9947414999003, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.967281303350997, "mean_processing_ms": 3.4818408506263085, "mean_inference_ms": 1.571279272633352}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4064256, "num_steps_sampled": 4082400, "sample_time_ms": 180859.458, "load_time_ms": 81.156, "grad_time_ms": 3562.855, "update_time_ms": 5.574, "learner": {"default_policy": {"cur_kl_coeff": 0.10678710788488388, "cur_lr": 4.999999873689376e-05, "total_loss": 1806.42333984375, "policy_loss": -0.013105431571602821, "vf_loss": 1806.433349609375, "vf_explained_var": -1.0643686820799303e-08, "kl": 0.030598975718021393, "entropy": 5.808622360229492, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4082400, "episodes_total": 10206, "training_iteration": 162, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_10-03-54", "timestamp": 1606797234, "time_this_iter_s": 183.69646763801575, "time_total_s": 31404.30561900139, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 31404.30561900139, "timesteps_since_restore": 4082400, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 65.84274809160306, "ram_util_percent": 75.90458015267176}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -283.4312056252483, "episode_reward_min": -356.33665348563113, "episode_reward_mean": -315.8878850969921, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.961276499600327, "mean_processing_ms": 3.481208195158425, "mean_inference_ms": 1.5709952846412474}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4089344, "num_steps_sampled": 4107600, "sample_time_ms": 181059.063, "load_time_ms": 81.585, "grad_time_ms": 3633.098, "update_time_ms": 5.25, "learner": {"default_policy": {"cur_kl_coeff": 0.10678710788488388, "cur_lr": 4.999999873689376e-05, "total_loss": 1712.8326416015625, "policy_loss": -0.009573780000209808, "vf_loss": 1712.83837890625, "vf_explained_var": -6.38621200366174e-09, "kl": 0.03675847128033638, "entropy": 6.167224407196045, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4107600, "episodes_total": 10267, "training_iteration": 163, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_10-06-59", "timestamp": 1606797419, "time_this_iter_s": 185.24558925628662, "time_total_s": 31589.551208257675, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 31589.551208257675, "timesteps_since_restore": 4107600, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 65.6034090909091, "ram_util_percent": 75.49962121212121}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -284.39578382918296, "episode_reward_min": -356.33665348563113, "episode_reward_mean": -317.93015138110167, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.948042795721225, "mean_processing_ms": 3.4812904786075283, "mean_inference_ms": 1.5703035533842211}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4114432, "num_steps_sampled": 4132800, "sample_time_ms": 181095.409, "load_time_ms": 82.682, "grad_time_ms": 3596.899, "update_time_ms": 4.81, "learner": {"default_policy": {"cur_kl_coeff": 0.10678710788488388, "cur_lr": 4.999999873689376e-05, "total_loss": 1793.222900390625, "policy_loss": -0.012746752239763737, "vf_loss": 1793.2314453125, "vf_explained_var": 2.1287374085687816e-09, "kl": 0.038692571222782135, "entropy": 5.666123867034912, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4132800, "episodes_total": 10332, "training_iteration": 164, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_10-10-05", "timestamp": 1606797605, "time_this_iter_s": 185.5818476676941, "time_total_s": 31775.13305592537, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 31775.13305592537, "timesteps_since_restore": 4132800, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 65.56452830188678, "ram_util_percent": 75.72452830188679}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -274.93137986206983, "episode_reward_min": -347.72471434453126, "episode_reward_mean": -315.77027095109537, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.943888178232452, "mean_processing_ms": 3.4806624400416295, "mean_inference_ms": 1.570136914606136}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4139520, "num_steps_sampled": 4158000, "sample_time_ms": 181260.752, "load_time_ms": 78.882, "grad_time_ms": 3541.088, "update_time_ms": 4.729, "learner": {"default_policy": {"cur_kl_coeff": 0.10678710788488388, "cur_lr": 4.999999873689376e-05, "total_loss": 1705.908447265625, "policy_loss": -0.014396563172340393, "vf_loss": 1705.9189453125, "vf_explained_var": -1.520526637932562e-08, "kl": 0.03449368104338646, "entropy": 5.957840919494629, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4158000, "episodes_total": 10393, "training_iteration": 165, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_10-13-09", "timestamp": 1606797789, "time_this_iter_s": 184.03660798072815, "time_total_s": 31959.169663906097, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 31959.169663906097, "timesteps_since_restore": 4158000, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 65.65209125475285, "ram_util_percent": 75.79315589353611}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -274.93137986206983, "episode_reward_min": -353.4140991783711, "episode_reward_mean": -314.9232687409908, "episode_len_mean": 400.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.929739499897597, "mean_processing_ms": 3.480848456540895, "mean_inference_ms": 1.5694289596778317}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4164608, "num_steps_sampled": 4183200, "sample_time_ms": 180620.323, "load_time_ms": 71.845, "grad_time_ms": 3470.287, "update_time_ms": 5.099, "learner": {"default_policy": {"cur_kl_coeff": 0.10678710788488388, "cur_lr": 4.999999873689376e-05, "total_loss": 1771.0478515625, "policy_loss": -0.013845253735780716, "vf_loss": 1771.0579833984375, "vf_explained_var": -6.0821068181837745e-09, "kl": 0.033968061208724976, "entropy": 5.572871685028076, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4183200, "episodes_total": 10457, "training_iteration": 166, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_10-16-14", "timestamp": 1606797974, "time_this_iter_s": 185.7694022655487, "time_total_s": 32144.939066171646, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 32144.939066171646, "timesteps_since_restore": 4183200, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 65.78679245283018, "ram_util_percent": 75.89169811320755}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -287.9822955511126, "episode_reward_min": -353.2799123576616, "episode_reward_mean": -317.4218675321484, "episode_len_mean": 400.0, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.921330184512843, "mean_processing_ms": 3.4807335246514253, "mean_inference_ms": 1.569053439123653}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4189696, "num_steps_sampled": 4208400, "sample_time_ms": 180769.677, "load_time_ms": 69.338, "grad_time_ms": 3373.755, "update_time_ms": 5.353, "learner": {"default_policy": {"cur_kl_coeff": 0.10678710788488388, "cur_lr": 4.999999873689376e-05, "total_loss": 1745.84375, "policy_loss": -0.012366839684545994, "vf_loss": 1745.8524169921875, "vf_explained_var": -1.0643686820799303e-08, "kl": 0.03410811722278595, "entropy": 5.644883632659912, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4208400, "episodes_total": 10520, "training_iteration": 167, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_10-19-19", "timestamp": 1606798159, "time_this_iter_s": 184.43491983413696, "time_total_s": 32329.373986005783, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 32329.373986005783, "timesteps_since_restore": 4208400, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 65.70380228136881, "ram_util_percent": 76.11330798479088}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -285.6840272656113, "episode_reward_min": -353.2799123576616, "episode_reward_mean": -315.00939529445134, "episode_len_mean": 400.0, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.91354574346302, "mean_processing_ms": 3.4804867431262365, "mean_inference_ms": 1.5687362776514902}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4214784, "num_steps_sampled": 4233600, "sample_time_ms": 181040.915, "load_time_ms": 66.662, "grad_time_ms": 3375.389, "update_time_ms": 5.791, "learner": {"default_policy": {"cur_kl_coeff": 0.10678710788488388, "cur_lr": 4.999999873689376e-05, "total_loss": 1732.629150390625, "policy_loss": -0.011661505326628685, "vf_loss": 1732.636962890625, "vf_explained_var": -1.1251897191755234e-08, "kl": 0.036604054272174835, "entropy": 5.536890029907227, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4233600, "episodes_total": 10583, "training_iteration": 168, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_10-22-24", "timestamp": 1606798344, "time_this_iter_s": 184.6176474094391, "time_total_s": 32513.991633415222, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 32513.991633415222, "timesteps_since_restore": 4233600, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 65.74410646387831, "ram_util_percent": 76.25475285171103}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -288.142932443404, "episode_reward_min": -344.74597560247, "episode_reward_mean": -314.296980273786, "episode_len_mean": 400.0, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.903064611638293, "mean_processing_ms": 3.480586775153372, "mean_inference_ms": 1.5682342735634678}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4239872, "num_steps_sampled": 4258800, "sample_time_ms": 181055.567, "load_time_ms": 66.508, "grad_time_ms": 3419.02, "update_time_ms": 6.256, "learner": {"default_policy": {"cur_kl_coeff": 0.10678710788488388, "cur_lr": 4.999999873689376e-05, "total_loss": 1738.7117919921875, "policy_loss": -0.015014560893177986, "vf_loss": 1738.7225341796875, "vf_explained_var": -1.0339581635321338e-08, "kl": 0.03853806480765343, "entropy": 5.4643144607543945, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4258800, "episodes_total": 10646, "training_iteration": 169, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_10-25-28", "timestamp": 1606798528, "time_this_iter_s": 184.46188616752625, "time_total_s": 32698.45351958275, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 32698.45351958275, "timesteps_since_restore": 4258800, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 65.72661596958174, "ram_util_percent": 76.47224334600759}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -288.142932443404, "episode_reward_min": -344.74597560247, "episode_reward_mean": -314.8724258110985, "episode_len_mean": 400.0, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.894872816774846, "mean_processing_ms": 3.4802562351740467, "mean_inference_ms": 1.5678905728568509}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4264960, "num_steps_sampled": 4284000, "sample_time_ms": 181166.531, "load_time_ms": 66.635, "grad_time_ms": 3472.945, "update_time_ms": 6.179, "learner": {"default_policy": {"cur_kl_coeff": 0.10678710788488388, "cur_lr": 4.999999873689376e-05, "total_loss": 1730.89208984375, "policy_loss": -0.011714207008481026, "vf_loss": 1730.8992919921875, "vf_explained_var": -2.1287374085687816e-09, "kl": 0.04161255061626434, "entropy": 5.47285795211792, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4284000, "episodes_total": 10709, "training_iteration": 170, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_10-28-34", "timestamp": 1606798714, "time_this_iter_s": 185.6194326877594, "time_total_s": 32884.07295227051, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 32884.07295227051, "timesteps_since_restore": 4284000, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 65.45169811320754, "ram_util_percent": 76.67169811320754}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -279.4269062074639, "episode_reward_min": -348.66065447968674, "episode_reward_mean": -315.0921594983385, "episode_len_mean": 400.0, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.88620148932399, "mean_processing_ms": 3.480097231246225, "mean_inference_ms": 1.5676650089606772}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4290048, "num_steps_sampled": 4309200, "sample_time_ms": 181302.097, "load_time_ms": 66.441, "grad_time_ms": 3423.105, "update_time_ms": 6.132, "learner": {"default_policy": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 4.999999873689376e-05, "total_loss": 1739.769287109375, "policy_loss": -0.013787699863314629, "vf_loss": 1739.778076171875, "vf_explained_var": -3.0410534090918873e-09, "kl": 0.03175630792975426, "entropy": 5.386731147766113, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4309200, "episodes_total": 10772, "training_iteration": 171, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_10-31-38", "timestamp": 1606798898, "time_this_iter_s": 184.61566925048828, "time_total_s": 33068.688621520996, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 33068.688621520996, "timesteps_since_restore": 4309200, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 65.47262357414449, "ram_util_percent": 76.8254752851711}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -279.4269062074639, "episode_reward_min": -342.21947561833935, "episode_reward_mean": -314.17132951150614, "episode_len_mean": 400.0, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.876056185081637, "mean_processing_ms": 3.4799416271199983, "mean_inference_ms": 1.566991615579332}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4315136, "num_steps_sampled": 4334400, "sample_time_ms": 181502.17, "load_time_ms": 63.65, "grad_time_ms": 3355.306, "update_time_ms": 6.142, "learner": {"default_policy": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 4.999999873689376e-05, "total_loss": 1730.849365234375, "policy_loss": -0.01045737974345684, "vf_loss": 1730.853271484375, "vf_explained_var": 6.38621200366174e-09, "kl": 0.03934553638100624, "entropy": 5.353377819061279, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4334400, "episodes_total": 10835, "training_iteration": 172, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_10-34-43", "timestamp": 1606799083, "time_this_iter_s": 184.98960423469543, "time_total_s": 33253.67822575569, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 33253.67822575569, "timesteps_since_restore": 4334400, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 65.70757575757577, "ram_util_percent": 77.02083333333333}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -274.43013878462494, "episode_reward_min": -349.4018876074917, "episode_reward_mean": -313.878315143776, "episode_len_mean": 400.0, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.86967701347613, "mean_processing_ms": 3.4795785911259065, "mean_inference_ms": 1.566733319336343}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4340224, "num_steps_sampled": 4359600, "sample_time_ms": 181589.132, "load_time_ms": 60.368, "grad_time_ms": 3341.462, "update_time_ms": 6.129, "learner": {"default_policy": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 4.999999873689376e-05, "total_loss": 1729.459228515625, "policy_loss": -0.012434561736881733, "vf_loss": 1729.4661865234375, "vf_explained_var": -5.169790817660669e-09, "kl": 0.03368895873427391, "entropy": 5.359256744384766, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4359600, "episodes_total": 10898, "training_iteration": 173, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_10-37-49", "timestamp": 1606799269, "time_this_iter_s": 185.9484624862671, "time_total_s": 33439.62668824196, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 33439.62668824196, "timesteps_since_restore": 4359600, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 65.43308270676691, "ram_util_percent": 77.23796992481203}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -284.8447739610771, "episode_reward_min": -354.85834598396406, "episode_reward_mean": -315.31513069041097, "episode_len_mean": 400.0, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.862662167250342, "mean_processing_ms": 3.479595457546168, "mean_inference_ms": 1.566574543952487}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4365312, "num_steps_sampled": 4384800, "sample_time_ms": 181625.325, "load_time_ms": 57.499, "grad_time_ms": 3468.216, "update_time_ms": 6.661, "learner": {"default_policy": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 4.999999873689376e-05, "total_loss": 1731.470947265625, "policy_loss": -0.012745928019285202, "vf_loss": 1731.4786376953125, "vf_explained_var": -6.690317189139705e-09, "kl": 0.033246759325265884, "entropy": 5.334354400634766, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4384800, "episodes_total": 10961, "training_iteration": 174, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_10-40-57", "timestamp": 1606799457, "time_this_iter_s": 187.1924431324005, "time_total_s": 33626.81913137436, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 33626.81913137436, "timesteps_since_restore": 4384800, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 65.36254681647941, "ram_util_percent": 77.48501872659176}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -280.03324090225203, "episode_reward_min": -350.0329676981106, "episode_reward_mean": -313.08970173058714, "episode_len_mean": 400.0, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.85135904885604, "mean_processing_ms": 3.4796707437994088, "mean_inference_ms": 1.5660226135950126}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4390400, "num_steps_sampled": 4410000, "sample_time_ms": 181653.102, "load_time_ms": 58.848, "grad_time_ms": 3471.227, "update_time_ms": 6.453, "learner": {"default_policy": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 4.999999873689376e-05, "total_loss": 1722.837646484375, "policy_loss": -0.01353079080581665, "vf_loss": 1722.8458251953125, "vf_explained_var": -4.5615800026155284e-09, "kl": 0.03478088602423668, "entropy": 5.2234978675842285, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4410000, "episodes_total": 11024, "training_iteration": 175, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_10-44-01", "timestamp": 1606799641, "time_this_iter_s": 184.3571126461029, "time_total_s": 33811.17624402046, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 33811.17624402046, "timesteps_since_restore": 4410000, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 65.50152091254753, "ram_util_percent": 77.53041825095058}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -271.1658947779662, "episode_reward_min": -356.4895186046018, "episode_reward_mean": -314.39857750052613, "episode_len_mean": 400.0, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.84381076808579, "mean_processing_ms": 3.4795091907847304, "mean_inference_ms": 1.5655020003385312}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4415488, "num_steps_sampled": 4435200, "sample_time_ms": 181533.648, "load_time_ms": 58.548, "grad_time_ms": 3632.995, "update_time_ms": 7.012, "learner": {"default_policy": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 4.999999873689376e-05, "total_loss": 1718.0029296875, "policy_loss": -0.012386730872094631, "vf_loss": 1718.01025390625, "vf_explained_var": -7.2985280041848455e-09, "kl": 0.03201645612716675, "entropy": 5.241774082183838, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4435200, "episodes_total": 11087, "training_iteration": 176, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_10-47-07", "timestamp": 1606799827, "time_this_iter_s": 186.19597172737122, "time_total_s": 33997.37221574783, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 33997.37221574783, "timesteps_since_restore": 4435200, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 65.93056603773584, "ram_util_percent": 77.58075471698113}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -286.2160316561702, "episode_reward_min": -348.61299555079296, "episode_reward_mean": -313.9092905065782, "episode_len_mean": 400.0, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.839329857904403, "mean_processing_ms": 3.479206381910781, "mean_inference_ms": 1.565460383324253}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4440576, "num_steps_sampled": 4460400, "sample_time_ms": 181555.968, "load_time_ms": 59.027, "grad_time_ms": 3745.377, "update_time_ms": 7.062, "learner": {"default_policy": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 4.999999873689376e-05, "total_loss": 1723.442626953125, "policy_loss": -0.011197182349860668, "vf_loss": 1723.4486083984375, "vf_explained_var": -7.906738375140776e-09, "kl": 0.033013004809617996, "entropy": 5.126187801361084, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4460400, "episodes_total": 11150, "training_iteration": 177, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_10-50-13", "timestamp": 1606800013, "time_this_iter_s": 185.79637265205383, "time_total_s": 34183.16858839989, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 34183.16858839989, "timesteps_since_restore": 4460400, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 65.4577358490566, "ram_util_percent": 77.84415094339622}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -284.8207229268097, "episode_reward_min": -347.4704039425023, "episode_reward_mean": -315.4241482727082, "episode_len_mean": 400.0, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.82758272587678, "mean_processing_ms": 3.479309875224061, "mean_inference_ms": 1.564816193677622}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4465664, "num_steps_sampled": 4485600, "sample_time_ms": 181516.023, "load_time_ms": 59.683, "grad_time_ms": 3675.806, "update_time_ms": 7.058, "learner": {"default_policy": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 4.999999873689376e-05, "total_loss": 1691.4615478515625, "policy_loss": -0.012335828505456448, "vf_loss": 1691.4691162109375, "vf_explained_var": -4.865685188093494e-09, "kl": 0.031052900478243828, "entropy": 5.4116082191467285, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4485600, "episodes_total": 11212, "training_iteration": 178, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_10-53-17", "timestamp": 1606800197, "time_this_iter_s": 183.5309624671936, "time_total_s": 34366.69955086708, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 34366.69955086708, "timesteps_since_restore": 4485600, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 65.88167938931298, "ram_util_percent": 77.99160305343513}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -277.4762925473707, "episode_reward_min": -347.4704039425023, "episode_reward_mean": -314.38760041315305, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.821861983091644, "mean_processing_ms": 3.4791430857940964, "mean_inference_ms": 1.564553750528612}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4490752, "num_steps_sampled": 4510800, "sample_time_ms": 181743.469, "load_time_ms": 60.734, "grad_time_ms": 3622.946, "update_time_ms": 6.945, "learner": {"default_policy": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 4.999999873689376e-05, "total_loss": 1758.111328125, "policy_loss": -0.013693304732441902, "vf_loss": 1758.1192626953125, "vf_explained_var": -1.4597056008369691e-08, "kl": 0.03498249500989914, "entropy": 4.740164756774902, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4510800, "episodes_total": 11277, "training_iteration": 179, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_10-56-23", "timestamp": 1606800383, "time_this_iter_s": 186.22008895874023, "time_total_s": 34552.91963982582, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 34552.91963982582, "timesteps_since_restore": 4510800, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 66.30000000000001, "ram_util_percent": 78.17180451127821}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -277.4762925473707, "episode_reward_min": -355.2277680840325, "episode_reward_mean": -314.61861129596576, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.818453511662, "mean_processing_ms": 3.478698072690307, "mean_inference_ms": 1.5644088064393211}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4515840, "num_steps_sampled": 4536000, "sample_time_ms": 182059.13, "load_time_ms": 67.075, "grad_time_ms": 3496.066, "update_time_ms": 6.99, "learner": {"default_policy": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 4.999999873689376e-05, "total_loss": 1684.3890380859375, "policy_loss": -0.01010734774172306, "vf_loss": 1684.393798828125, "vf_explained_var": -1.0643686820799303e-08, "kl": 0.034610815346241, "entropy": 5.3564229011535645, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4536000, "episodes_total": 11338, "training_iteration": 180, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_10-59-30", "timestamp": 1606800570, "time_this_iter_s": 187.57364058494568, "time_total_s": 34740.49328041077, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 34740.49328041077, "timesteps_since_restore": 4536000, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 65.90786516853933, "ram_util_percent": 78.39363295880149}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -273.49693519719585, "episode_reward_min": -355.2277680840325, "episode_reward_mean": -312.53978729736184, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.812139801923784, "mean_processing_ms": 3.4786782776721896, "mean_inference_ms": 1.5640790470634665}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4540928, "num_steps_sampled": 4561200, "sample_time_ms": 182294.257, "load_time_ms": 70.226, "grad_time_ms": 3589.351, "update_time_ms": 6.969, "learner": {"default_policy": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 4.999999873689376e-05, "total_loss": 1763.5120849609375, "policy_loss": -0.003475641133263707, "vf_loss": 1763.5078125, "vf_explained_var": -6.0821068181837745e-09, "kl": 0.049126528203487396, "entropy": 4.430233001708984, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4561200, "episodes_total": 11403, "training_iteration": 181, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_11-02-38", "timestamp": 1606800758, "time_this_iter_s": 187.93378233909607, "time_total_s": 34928.42706274986, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 34928.42706274986, "timesteps_since_restore": 4561200, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 66.02276119402984, "ram_util_percent": 77.69477611940297}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -273.49693519719585, "episode_reward_min": -347.0336427580151, "episode_reward_mean": -313.3365444644302, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.81175148946573, "mean_processing_ms": 3.4781533926294763, "mean_inference_ms": 1.5640663134707342}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4566016, "num_steps_sampled": 4586400, "sample_time_ms": 182646.62, "load_time_ms": 71.657, "grad_time_ms": 3682.774, "update_time_ms": 6.993, "learner": {"default_policy": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 1663.94287109375, "policy_loss": -0.013279463164508343, "vf_loss": 1663.949951171875, "vf_explained_var": -1.277242400732348e-08, "kl": 0.025559090077877045, "entropy": 4.829092025756836, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4586400, "episodes_total": 11464, "training_iteration": 182, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_11-05-48", "timestamp": 1606800948, "time_this_iter_s": 189.46997451782227, "time_total_s": 35117.897037267685, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 35117.897037267685, "timesteps_since_restore": 4586400, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 65.55756457564576, "ram_util_percent": 77.47269372693727}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -284.3470217851531, "episode_reward_min": -354.12267929916663, "episode_reward_mean": -314.07421049048685, "episode_len_mean": 400.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.80478768314062, "mean_processing_ms": 3.4781596731487094, "mean_inference_ms": 1.5637112619005293}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4591104, "num_steps_sampled": 4611600, "sample_time_ms": 182767.101, "load_time_ms": 76.788, "grad_time_ms": 3812.876, "update_time_ms": 7.312, "learner": {"default_policy": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 1740.2353515625, "policy_loss": -0.014262301847338676, "vf_loss": 1740.24169921875, "vf_explained_var": -2.1287374085687816e-09, "kl": 0.032846324145793915, "entropy": 4.534389495849609, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4611600, "episodes_total": 11528, "training_iteration": 183, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_11-08-57", "timestamp": 1606801137, "time_this_iter_s": 188.50579166412354, "time_total_s": 35306.40282893181, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 35306.40282893181, "timesteps_since_restore": 4611600, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 65.78066914498142, "ram_util_percent": 77.69293680297399}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -272.9765027366275, "episode_reward_min": -354.12267929916663, "episode_reward_mean": -311.07205663490527, "episode_len_mean": 400.0, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.79891317512768, "mean_processing_ms": 3.478367485017779, "mean_inference_ms": 1.563389650013644}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4616192, "num_steps_sampled": 4636800, "sample_time_ms": 182761.665, "load_time_ms": 77.639, "grad_time_ms": 3705.975, "update_time_ms": 6.805, "learner": {"default_policy": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 1690.2529296875, "policy_loss": -0.012124815955758095, "vf_loss": 1690.256591796875, "vf_explained_var": -6.690317189139705e-09, "kl": 0.035547275096178055, "entropy": 4.429632663726807, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4636800, "episodes_total": 11590, "training_iteration": 184, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_11-12-03", "timestamp": 1606801323, "time_this_iter_s": 186.07599663734436, "time_total_s": 35492.47882556915, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 35492.47882556915, "timesteps_since_restore": 4636800, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 66.25811320754717, "ram_util_percent": 77.84452830188678}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -272.9765027366275, "episode_reward_min": -348.9122628351852, "episode_reward_mean": -312.55226486416285, "episode_len_mean": 400.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.795564374875, "mean_processing_ms": 3.478364823924536, "mean_inference_ms": 1.5631995359580326}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4641280, "num_steps_sampled": 4662000, "sample_time_ms": 183180.96, "load_time_ms": 79.519, "grad_time_ms": 3701.099, "update_time_ms": 7.287, "learner": {"default_policy": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 1737.4110107421875, "policy_loss": -0.016370827332139015, "vf_loss": 1737.42041015625, "vf_explained_var": -8.514949634275126e-09, "kl": 0.029368096962571144, "entropy": 4.123231410980225, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4662000, "episodes_total": 11655, "training_iteration": 185, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_11-15-11", "timestamp": 1606801511, "time_this_iter_s": 188.52816534042358, "time_total_s": 35681.00699090958, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 35681.00699090958, "timesteps_since_restore": 4662000, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 66.24237918215613, "ram_util_percent": 78.23531598513011}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
{"episode_reward_max": -276.78377178784467, "episode_reward_min": -351.58248030351444, "episode_reward_mean": -313.90240378962557, "episode_len_mean": 400.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 31.79421948790246, "mean_processing_ms": 3.4780219882376486, "mean_inference_ms": 1.5631426730858136}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4666368, "num_steps_sampled": 4687200, "sample_time_ms": 183685.951, "load_time_ms": 85.635, "grad_time_ms": 3593.929, "update_time_ms": 6.8, "learner": {"default_policy": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 1652.45458984375, "policy_loss": -0.007864609360694885, "vf_loss": 1652.453125, "vf_explained_var": -3.3451585945698525e-09, "kl": 0.03818592056632042, "entropy": 4.471731185913086, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25200, "done": false, "timesteps_total": 4687200, "episodes_total": 11716, "training_iteration": 186, "experiment_id": "774b24d199954f7685399f3f1314ee19", "date": "2020-12-01_11-18-21", "timestamp": 1606801701, "time_this_iter_s": 190.22573232650757, "time_total_s": 35871.232723236084, "pid": 9587, "hostname": "Rambo", "node_ip": "192.168.1.15", "config": {"num_workers": 5, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 25200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 50,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.traffic_light_grid.TrafficLightGridPOEnv\",\n    \"exp_tag\": \"traffic_light_grid_mark3\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 20,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 15,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 15,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 12,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        }\n    ]\n}", "run": "PPO"}, "env": "TrafficLightGridPOEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 35871.232723236084, "timesteps_since_restore": 4687200, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 65.49963099630996, "ram_util_percent": 78.43210332103321}, "num_healthy_workers": 5, "trial_id": "42ffd60e", "experiment_tag": "0"}
